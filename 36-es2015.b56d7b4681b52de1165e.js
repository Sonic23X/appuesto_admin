(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"8NaG":function(e,t,n){"use strict";class s{constructor(e,t,n,s,a){this.types=e,this.zones=t,this.extras=n,this.parkings=s,this.paymentMethods=a}toJson(){return{types:this.types,zones:this.zones,extras:this.getExtras(),parkings:this.parkings,payment_methods:this.paymentMethods}}getExtras(){return this.extras.map(e=>e.id?{id:e.id,active:e.active}:{name:e.name,active:e.active})}}class a{constructor(e){this.businessForm=e}toJson(){const e=this.businessForm.value;return{id:e.id||null,name:e.name||null,price_range:e.price_range,style:e.style}}}class r{constructor(e){this.newRestaurantForm=e}toJson(e){const t=this.newRestaurantForm,n={name:t.get("name").value,description:t.get("description").value,coordinates:this.concatCoordinates(),address:t.get("address").value,phone:this.getPhone(),email:t.get("email").value,invoice_email:"",invoice_url:"",manager:!t.get("manager").value&&0!==t.get("manager").value||e?void 0:t.get("manager").value};return"0"===t.value.billingOption?(n.invoice_email=t.value.emailBilling,delete n.invoice_url):(n.invoice_url=t.value.websiteBilling,delete n.invoice_email),n}getPhone(){return`+${this.newRestaurantForm.get("dialCode").value}${this.newRestaurantForm.get("phone").value}`}concatCoordinates(){const e=[];return e.push(parseFloat(this.newRestaurantForm.get("latitude").value)),e.push(parseFloat(this.newRestaurantForm.get("longitude").value)),e}}class i{constructor(e){this.appDataForm=e}toJson(){return{max_offered_seats:this.appDataForm.get("max_offered_seats").value,max_people_per_order:this.appDataForm.get("max_people_per_order").value,max_cancel_limit_minutes:this.getTotalMinutes(),reservation_time_minutes:this.appDataForm.get("reservation_time_minutes").value}}getTotalMinutes(){return 60*this.appDataForm.get("max_cancel_limit_hours").value+ +this.appDataForm.get("max_cancel_limit_minutes").value}}class o{constructor(e){this.restaurantDetailForm=e}toJson(){return{name:this.restaurantDetailForm.get("name").value,description:this.restaurantDetailForm.get("description").value,coordinates:this.getCoordinatesArray(),address:this.restaurantDetailForm.get("address").value,address_extra:this.restaurantDetailForm.get("address_extra").value,phone:this.getParsedPhone(),email:this.restaurantDetailForm.get("email").value}}getCoordinatesArray(){return[parseFloat(this.restaurantDetailForm.get("lat").value),parseFloat(this.restaurantDetailForm.get("long").value)]}getParsedPhone(){const e=this.restaurantDetailForm;return`+${e.get("countryCode").value} ${e.get("phone").value.trim()}`}}class l{constructor(e){this.extrasForm=e}toJson(){return{extras:this.getExtras()}}getExtras(){return this.extrasForm.getRawValue().extras.map(e=>e.id?{id:e.id,active:e.active}:{name:e.name,active:e.active})}}class u{constructor(e){this.parkingForm=e}toJson(){return{parkings:this.parkingForm.get("parking").value||[]}}}class c{constructor(e){this.imagesForm=e}toFormData(){const e=new FormData;e.append("cover",this.imagesForm.get("coverImage").value);const t=this.imagesForm.get("galleryImages");return t.controls.forEach((n,s)=>{n.get("id")||e.append("gallery["+s+"]",t.controls[s].get("fileValue").value)}),this.imagesForm.get("imageLink").value&&e.append("matterport",this.imagesForm.get("imageLink").value),e}}class m{constructor(e){this.paymentMethodsForm=e}toJson(){return{payment_methods:this.paymentMethodsForm.get("paymentMethods").value||[]}}}class h{constructor(e){this.workingHoursForm=e}fixedHoursJson(){return{working_hours:this.getFixedHours()}}mixedHoursJson(){return{working_hours:this.getMixedHours()}}getMixedHours(){const e=this.workingHoursForm.get("mixedHours"),t=[];return e.controls.forEach((e,n)=>{if(!0===e.get("isSelected").value){const s={week_day:n+1,opens_at:e.get("opening").value,closes_at:e.get("closing").value};t.push(s)}}),t}getFixedHours(){const e=[];return Object.keys(this.workingHoursForm.value.fixedHours.weekdays).forEach(t=>{const n=this.workingHoursForm.get("fixedHours");if(n.get("weekdays").get(t).value){const s={week_day:parseInt(t,10),opens_at:n.get("opening").value,closes_at:n.get("closing").value};e.push(s)}}),e}}class g{constructor(e){this.reservationZonesForm=e}toJson(){return{zones:this.reservationZonesForm.get("zones").value||[]}}}class d{constructor(e){this.serviceTypeForm=e}toJson(){return{types:this.serviceTypeForm.get("type").value||[]}}}n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"j",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"l",(function(){return d}))},MsEx:function(e,t,n){"use strict";n.r(t);var s=n("8Y7J");class a{}var r=n("pMnS"),i=n("y3B+"),o=n("s7LF"),l=n("pMoy"),u=n("YEUz"),c=n("omvX"),m=n("SVse"),h=n("quSY"),g=n("8NaG"),d=n("TwVa"),p=n("5+tZ"),b=n("lJxs");class v{constructor(e,t,n){this.fb=e,this.restaurantService=t,this.snackBar=n,this.reservationZonesForm=this.fb.group({zones:new o.h([])}),this.reservationZones=[],this.restaurantId=parseInt(localStorage.getItem("restaurantId"),10),this.restaurantSubscription=h.a.EMPTY,this.amenitiesSubscription=h.a.EMPTY}ngOnInit(){this.restaurantSubscription=this.getRestaurantDetails(this.restaurantId).pipe(Object(p.a)(e=>(this.currentReservationZones=e.restaurant.zones.filter(e=>!0===e.active).map(e=>e.id),this.reservationZonesForm.patchValue({zones:this.currentReservationZones}),this.getReservationZones()))).subscribe(e=>{this.createZonesObjects(e)})}ngOnDestroy(){this.restaurantSubscription.unsubscribe(),this.amenitiesSubscription.unsubscribe()}onSubmit(){const e=new g.k(this.reservationZonesForm);this.amenitiesSubscription=this.restaurantService.setRestaurantAmenities(e.toJson(),this.restaurantId).subscribe(()=>this.openSnackBar("Cambios guardados","Entendido"))}onZoneCheck(e){e.active=!e.active;let t=this.reservationZonesForm.get("zones").value;t=this.onZoneSelection(e,t),this.reservationZonesForm.patchValue({zones:t})}onZoneSelection(e,t){if(t.includes(e.id)){const n=t.indexOf(e.id);t.splice(n,1)}else t.push(e.id);return t}createZonesObjects(e){e.forEach(e=>{const t={name:e.name,id:e.id,active:!1};this.currentReservationZones.find(t=>t===e.id)&&(t.active=!0),this.reservationZones.push(t)})}getRestaurantDetails(e){return this.restaurantService.getRestaurantDetail(e)}getReservationZones(){return this.restaurantService.getAmenities().pipe(Object(b.a)(e=>e.zones.map(e=>new d.g(e))))}openSnackBar(e,t){this.snackBar.open(e,t,{duration:2e3})}}var F=n("xv9W"),f=n("zHaW"),_=s.xb({encapsulation:0,styles:[[""]],data:{}});function x(e){return s.ac(0,[(e()(),s.zb(0,0,null,null,3,"mat-checkbox",[["class","mat-checkbox"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checkbox-indeterminate",null],[2,"mat-checkbox-checked",null],[2,"mat-checkbox-disabled",null],[2,"mat-checkbox-label-before",null],[2,"_mat-animation-noopable",null]],[[null,"change"]],(function(e,t,n){var s=!0;return"change"===t&&(s=!1!==e.component.onZoneCheck(e.context.$implicit,n)&&s),s}),i.b,i.a)),s.Sb(5120,null,o.q,(function(e){return[e]}),[l.c]),s.yb(2,12763136,null,0,l.c,[s.l,s.h,u.g,s.A,[8,null],[2,l.a],[2,c.a],[2,l.b]],{checked:[0,"checked"]},{change:"change"}),(e()(),s.Xb(3,0,["",""]))],(function(e,t){e(t,2,0,t.context.$implicit.active)}),(function(e,t){e(t,0,0,s.Ob(t,2).id,null,s.Ob(t,2).indeterminate,s.Ob(t,2).checked,s.Ob(t,2).disabled,"before"==s.Ob(t,2).labelPosition,"NoopAnimations"===s.Ob(t,2)._animationMode),e(t,3,0,t.context.$implicit.name)}))}function y(e){return s.ac(0,[(e()(),s.zb(0,0,null,null,10,"form",[["class","dark"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(e,t,n){var a=!0,r=e.component;return"submit"===t&&(a=!1!==s.Ob(e,2).onSubmit(n)&&a),"reset"===t&&(a=!1!==s.Ob(e,2).onReset()&&a),"ngSubmit"===t&&(a=!1!==r.onSubmit()&&a),a}),null,null)),s.yb(1,16384,null,0,o.B,[],null,null),s.yb(2,540672,null,0,o.l,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),s.Sb(2048,null,o.c,null,[o.l]),s.yb(4,16384,null,0,o.t,[[4,o.c]],null,null),(e()(),s.zb(5,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),s.jb(16777216,null,null,1,null,x)),s.yb(7,278528,null,0,m.l,[s.R,s.N,s.t],{ngForOf:[0,"ngForOf"]},null),(e()(),s.zb(8,0,null,null,2,"button",[["class","btns"],["type","submit"]],null,null,null,null,null)),(e()(),s.zb(9,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),s.Xb(-1,null,["Guardar"]))],(function(e,t){var n=t.component;e(t,2,0,n.reservationZonesForm),e(t,7,0,n.reservationZones)}),(function(e,t){e(t,0,0,s.Ob(t,4).ngClassUntouched,s.Ob(t,4).ngClassTouched,s.Ob(t,4).ngClassPristine,s.Ob(t,4).ngClassDirty,s.Ob(t,4).ngClassValid,s.Ob(t,4).ngClassInvalid,s.Ob(t,4).ngClassPending)}))}function k(e){return s.ac(0,[(e()(),s.zb(0,0,null,null,1,"app-reservation-zones",[],null,null,null,y,_)),s.yb(1,245760,null,0,v,[o.g,F.a,f.b],null,null)],(function(e,t){e(t,1,0)}),null)}var M=s.vb("app-reservation-zones",v,k,{},{},[]),w=n("9b/N"),S=n("iInd");class O{}var Z=n("9gLZ"),z=n("UhP/"),D=n("SCoL");n.d(t,"ReservationZonesModuleNgFactory",(function(){return R}));var R=s.wb(a,[],(function(e){return s.Lb([s.Mb(512,s.j,s.bb,[[8,[r.a,M]],[3,s.j],s.y]),s.Mb(4608,m.o,m.n,[s.v]),s.Mb(4608,w.c,w.c,[]),s.Mb(4608,o.z,o.z,[]),s.Mb(4608,o.g,o.g,[]),s.Mb(1073742336,m.b,m.b,[]),s.Mb(1073742336,S.p,S.p,[[2,S.u],[2,S.l]]),s.Mb(1073742336,O,O,[]),s.Mb(1073742336,Z.a,Z.a,[]),s.Mb(1073742336,z.j,z.j,[u.i,[2,z.c]]),s.Mb(1073742336,D.b,D.b,[]),s.Mb(1073742336,z.s,z.s,[]),s.Mb(1073742336,w.d,w.d,[]),s.Mb(1073742336,l.e,l.e,[]),s.Mb(1073742336,l.d,l.d,[]),s.Mb(1073742336,o.y,o.y,[]),s.Mb(1073742336,o.n,o.n,[]),s.Mb(1073742336,o.w,o.w,[]),s.Mb(1073742336,a,a,[]),s.Mb(1024,S.j,(function(){return[[{path:"",component:v}]]}),[])])}))}}]);
//# sourceMappingURL=36-es2015.b56d7b4681b52de1165e.js.map