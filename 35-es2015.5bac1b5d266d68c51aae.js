(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"8NaG":function(t,e,n){"use strict";class a{constructor(t,e,n,a,s){this.types=t,this.zones=e,this.extras=n,this.parkings=a,this.paymentMethods=s}toJson(){return{types:this.types,zones:this.zones,extras:this.getExtras(),parkings:this.parkings,payment_methods:this.paymentMethods}}getExtras(){return this.extras.map(t=>t.id?{id:t.id,active:t.active}:{name:t.name,active:t.active})}}class s{constructor(t){this.businessForm=t}toJson(){const t=this.businessForm.value;return{id:t.id||null,name:t.name||null,price_range:t.price_range,style:t.style}}}class r{constructor(t){this.newRestaurantForm=t}toJson(t){const e=this.newRestaurantForm,n={name:e.get("name").value,description:e.get("description").value,coordinates:this.concatCoordinates(),address:e.get("address").value,phone:this.getPhone(),email:e.get("email").value,invoice_email:"",invoice_url:"",manager:!e.get("manager").value&&0!==e.get("manager").value||t?void 0:e.get("manager").value};return"0"===e.value.billingOption?(n.invoice_email=e.value.emailBilling,delete n.invoice_url):(n.invoice_url=e.value.websiteBilling,delete n.invoice_email),n}getPhone(){return`+${this.newRestaurantForm.get("dialCode").value}${this.newRestaurantForm.get("phone").value}`}concatCoordinates(){const t=[];return t.push(parseFloat(this.newRestaurantForm.get("latitude").value)),t.push(parseFloat(this.newRestaurantForm.get("longitude").value)),t}}class i{constructor(t){this.appDataForm=t}toJson(){return{max_offered_seats:this.appDataForm.get("max_offered_seats").value,max_people_per_order:this.appDataForm.get("max_people_per_order").value,max_cancel_limit_minutes:this.getTotalMinutes(),reservation_time_minutes:this.appDataForm.get("reservation_time_minutes").value}}getTotalMinutes(){return 60*this.appDataForm.get("max_cancel_limit_hours").value+ +this.appDataForm.get("max_cancel_limit_minutes").value}}class o{constructor(t){this.restaurantDetailForm=t}toJson(){return{name:this.restaurantDetailForm.get("name").value,description:this.restaurantDetailForm.get("description").value,coordinates:this.getCoordinatesArray(),address:this.restaurantDetailForm.get("address").value,address_extra:this.restaurantDetailForm.get("address_extra").value,phone:this.getParsedPhone(),email:this.restaurantDetailForm.get("email").value}}getCoordinatesArray(){return[parseFloat(this.restaurantDetailForm.get("lat").value),parseFloat(this.restaurantDetailForm.get("long").value)]}getParsedPhone(){const t=this.restaurantDetailForm;return`+${t.get("countryCode").value} ${t.get("phone").value.trim()}`}}class l{constructor(t){this.extrasForm=t}toJson(){return{extras:this.getExtras()}}getExtras(){return this.extrasForm.getRawValue().extras.map(t=>t.id?{id:t.id,active:t.active}:{name:t.name,active:t.active})}}class u{constructor(t){this.parkingForm=t}toJson(){return{parkings:this.parkingForm.get("parking").value||[]}}}class c{constructor(t){this.imagesForm=t}toFormData(){const t=new FormData;t.append("cover",this.imagesForm.get("coverImage").value);const e=this.imagesForm.get("galleryImages");return e.controls.forEach((n,a)=>{n.get("id")||t.append("gallery["+a+"]",e.controls[a].get("fileValue").value)}),this.imagesForm.get("imageLink").value&&t.append("matterport",this.imagesForm.get("imageLink").value),t}}class m{constructor(t){this.paymentMethodsForm=t}toJson(){return{payment_methods:this.paymentMethodsForm.get("paymentMethods").value||[]}}}class h{constructor(t){this.workingHoursForm=t}fixedHoursJson(){return{working_hours:this.getFixedHours()}}mixedHoursJson(){return{working_hours:this.getMixedHours()}}getMixedHours(){const t=this.workingHoursForm.get("mixedHours"),e=[];return t.controls.forEach((t,n)=>{if(!0===t.get("isSelected").value){const a={week_day:n+1,opens_at:t.get("opening").value,closes_at:t.get("closing").value};e.push(a)}}),e}getFixedHours(){const t=[];return Object.keys(this.workingHoursForm.value.fixedHours.weekdays).forEach(e=>{const n=this.workingHoursForm.get("fixedHours");if(n.get("weekdays").get(e).value){const a={week_day:parseInt(e,10),opens_at:n.get("opening").value,closes_at:n.get("closing").value};t.push(a)}}),t}}class d{constructor(t){this.reservationZonesForm=t}toJson(){return{zones:this.reservationZonesForm.get("zones").value||[]}}}class g{constructor(t){this.serviceTypeForm=t}toJson(){return{types:this.serviceTypeForm.get("type").value||[]}}}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"h",(function(){return l})),n.d(e,"i",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"j",(function(){return m})),n.d(e,"g",(function(){return h})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return g}))},mZFg:function(t,e,n){"use strict";n.r(e);var a=n("8Y7J");class s{}var r=n("pMnS"),i=n("y3B+"),o=n("s7LF"),l=n("pMoy"),u=n("YEUz"),c=n("omvX"),m=n("SVse"),h=n("quSY"),d=n("8NaG"),g=n("TwVa"),p=n("5+tZ"),b=n("lJxs");class v{constructor(t,e,n){this.fb=t,this.restaurantService=e,this.snackBar=n,this.paymentMethodsForm=this.fb.group({paymentMethods:new o.h([])}),this.paymentMethods=[],this.restaurantId=parseInt(localStorage.getItem("restaurantId"),10),this.restaurantSubscription=h.a.EMPTY,this.paymentMethodsSubscription=h.a.EMPTY}ngOnInit(){this.restaurantSubscription=this.getRestaurantDetails(this.restaurantId).pipe(Object(p.a)(t=>(this.currentPaymentMethods=t.restaurant.payment_methods.filter(t=>!0===t.active).map(t=>t.id),this.paymentMethodsForm.patchValue({paymentMethods:this.currentPaymentMethods}),this.getPaymentMethods()))).subscribe(t=>{this.createPaymentMethodsObjects(t)})}ngOnDestroy(){this.restaurantSubscription.unsubscribe(),this.paymentMethodsSubscription.unsubscribe()}onPaymentMethodCheck(t){t.active=!t.active;let e=this.paymentMethodsForm.get("paymentMethods").value;e=this.onPaymentMethodSelection(t,e),this.paymentMethodsForm.patchValue({paymentMethods:e})}onSubmit(){const t=new d.j(this.paymentMethodsForm);this.paymentMethodsSubscription=this.restaurantService.setRestaurantAmenities(t.toJson(),this.restaurantId).subscribe(()=>this.openSnackBar("Cambios guardados","Entendido"))}createPaymentMethodsObjects(t){t.forEach(t=>{const e={name:t.name,id:t.id,active:!1};this.currentPaymentMethods.find(e=>e===t.id)&&(e.active=!0),this.paymentMethods.push(e)})}getPaymentMethods(){return this.restaurantService.getAmenities().pipe(Object(b.a)(t=>t.payment_methods.map(t=>new g.e(t))))}getRestaurantDetails(t){return this.restaurantService.getRestaurantDetail(t)}onPaymentMethodSelection(t,e){if(e.includes(t.id)){const n=e.indexOf(t.id);e.splice(n,1)}else e.push(t.id);return e}openSnackBar(t,e){this.snackBar.open(t,e,{duration:2e3})}}var y=n("xv9W"),M=n("zHaW"),F=a.xb({encapsulation:0,styles:[[""]],data:{}});function f(t){return a.ac(0,[(t()(),a.zb(0,0,null,null,3,"mat-checkbox",[["class","mat-checkbox"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checkbox-indeterminate",null],[2,"mat-checkbox-checked",null],[2,"mat-checkbox-disabled",null],[2,"mat-checkbox-label-before",null],[2,"_mat-animation-noopable",null]],[[null,"change"]],(function(t,e,n){var a=!0;return"change"===e&&(a=!1!==t.component.onPaymentMethodCheck(t.context.$implicit,n)&&a),a}),i.b,i.a)),a.Sb(5120,null,o.q,(function(t){return[t]}),[l.c]),a.yb(2,12763136,null,0,l.c,[a.l,a.h,u.g,a.A,[8,null],[2,l.a],[2,c.a],[2,l.b]],{checked:[0,"checked"]},{change:"change"}),(t()(),a.Xb(3,0,["",""]))],(function(t,e){t(e,2,0,e.context.$implicit.active)}),(function(t,e){t(e,0,0,a.Ob(e,2).id,null,a.Ob(e,2).indeterminate,a.Ob(e,2).checked,a.Ob(e,2).disabled,"before"==a.Ob(e,2).labelPosition,"NoopAnimations"===a.Ob(e,2)._animationMode),t(e,3,0,e.context.$implicit.name)}))}function _(t){return a.ac(0,[(t()(),a.zb(0,0,null,null,10,"form",[["class","dark"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(t,e,n){var s=!0,r=t.component;return"submit"===e&&(s=!1!==a.Ob(t,2).onSubmit(n)&&s),"reset"===e&&(s=!1!==a.Ob(t,2).onReset()&&s),"ngSubmit"===e&&(s=!1!==r.onSubmit()&&s),s}),null,null)),a.yb(1,16384,null,0,o.B,[],null,null),a.yb(2,540672,null,0,o.l,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),a.Sb(2048,null,o.c,null,[o.l]),a.yb(4,16384,null,0,o.t,[[4,o.c]],null,null),(t()(),a.zb(5,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),a.jb(16777216,null,null,1,null,f)),a.yb(7,278528,null,0,m.l,[a.R,a.N,a.t],{ngForOf:[0,"ngForOf"]},null),(t()(),a.zb(8,0,null,null,2,"button",[["class","btns"],["type","submit"]],null,null,null,null,null)),(t()(),a.zb(9,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),a.Xb(-1,null,["Guardar"]))],(function(t,e){var n=e.component;t(e,2,0,n.paymentMethodsForm),t(e,7,0,n.paymentMethods)}),(function(t,e){t(e,0,0,a.Ob(e,4).ngClassUntouched,a.Ob(e,4).ngClassTouched,a.Ob(e,4).ngClassPristine,a.Ob(e,4).ngClassDirty,a.Ob(e,4).ngClassValid,a.Ob(e,4).ngClassInvalid,a.Ob(e,4).ngClassPending)}))}function x(t){return a.ac(0,[(t()(),a.zb(0,0,null,null,1,"app-payment-methods",[],null,null,null,_,F)),a.yb(1,245760,null,0,v,[o.g,y.a,M.b],null,null)],(function(t,e){t(e,1,0)}),null)}var k=a.vb("app-payment-methods",v,x,{},{},[]),w=n("9b/N"),S=n("9gLZ"),O=n("UhP/"),P=n("SCoL"),D=n("iInd");class C{}n.d(e,"PaymentMethodsModuleNgFactory",(function(){return J}));var J=a.wb(s,[],(function(t){return a.Lb([a.Mb(512,a.j,a.bb,[[8,[r.a,k]],[3,a.j],a.y]),a.Mb(4608,m.o,m.n,[a.v]),a.Mb(4608,o.z,o.z,[]),a.Mb(4608,w.c,w.c,[]),a.Mb(4608,o.g,o.g,[]),a.Mb(1073742336,m.b,m.b,[]),a.Mb(1073742336,o.y,o.y,[]),a.Mb(1073742336,o.n,o.n,[]),a.Mb(1073742336,S.a,S.a,[]),a.Mb(1073742336,O.j,O.j,[u.i,[2,O.c]]),a.Mb(1073742336,P.b,P.b,[]),a.Mb(1073742336,O.s,O.s,[]),a.Mb(1073742336,w.d,w.d,[]),a.Mb(1073742336,l.e,l.e,[]),a.Mb(1073742336,l.d,l.d,[]),a.Mb(1073742336,D.p,D.p,[[2,D.u],[2,D.l]]),a.Mb(1073742336,C,C,[]),a.Mb(1073742336,o.w,o.w,[]),a.Mb(1073742336,s,s,[]),a.Mb(1024,D.j,(function(){return[[{path:"",component:v}]]}),[])])}))}}]);
//# sourceMappingURL=35-es2015.5bac1b5d266d68c51aae.js.map