(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+JPL":function(e,t,n){e.exports={default:n("gRli"),__esModule:!0}},"+RHZ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkService=void 0;const i=n("EcEN"),s=n("PyJ+"),r=n("PalJ"),o=n("vSOj"),a=n("kUwj");function l(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function c(e){return e.body?e.body.code:0}function u(e){return 409===e.status?new s.SyncNetworkError(l(e),e.status,c(e),e.body):e.status?new s.SyncError(l(e),e.status,c(e)):e instanceof a.TransportUnavailableError?e:new s.SyncError(e.message,0,0)}t.NetworkService=class{constructor(e,t,n){this.clientInfo=e,this.config=t,this.transport=n}createHeaders(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+i.v4().replace(/-/g,"")}}backoffConfig(){return Object.assign({min:4e3,max:6e4,maxAttemptsTime:9e4,randomness:.2},this.config.backoffConfig)}executeWithRetry(e,t=!0){return new Promise((n,i)=>{let s=[502,503,504];t&&s.push(429);let r=new o.Retrier(this.backoffConfig());r.on("attempt",()=>{e().then(e=>r.succeeded(e)).catch(e=>{if(s.includes(e.status)){let t=parseInt(e.headers?e.headers["Retry-After"]:null);r.failed(u(e),isNaN(t)?null:1e3*t)}else"Twilsock disconnected"===e.message?r.failed(u(e)):(r.removeAllListeners(),r.cancel(),i(u(e)))})}),r.on("succeeded",e=>{n(e)}),r.on("cancelled",e=>i(u(e))),r.on("failed",e=>i(u(e))),r.start()})}get(e){let t=this.createHeaders();return r.default.debug("GET",e,"ID:",t["Twilio-Request-Id"]),this.executeWithRetry(()=>this.transport.get(e,t,this.config.productId),!0)}post(e,t,n,i=!1){let s=this.createHeaders();return null!=n&&(s["If-Match"]=n),r.default.debug("POST",e,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(()=>this.transport.post(e,s,t,this.config.productId),i)}put(e,t,n){let i=this.createHeaders();return null!=n&&(i["If-Match"]=n),r.default.debug("PUT",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(()=>this.transport.put(e,i,t,this.config.productId),!1)}delete(e){let t=this.createHeaders();return r.default.debug("DELETE",e,"ID:",t["Twilio-Request-Id"]),this.executeWithRetry(()=>this.transport.delete(e,t,this.config.productId),!1)}}},"+WSI":function(e,t,n){var i=n("/r8T");e.exports=function(e,t){return new(i(e))(t)}},"+cvY":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=class{constructor(){this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}get promise(){return this._promise}update(e){this._resolve(e)}set(e){this.current=e,this._resolve(e)}fail(e){this._reject(e)}}},"+fG6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Twilsock=t.TwilsockClient=t.TelemetryEvents=void 0;const i=n("+qE3"),s=n("MZ0W"),r=n("iL38"),o=n("V6L8"),a=n("aLZZ"),l=n("vywL"),c=n("0KeW"),u=n("qFAj"),d=n("+cvY"),h=n("arZA"),p=n("BLvK"),f=n("gy0F"),g=n("y/1M");class m{}t.TelemetryEvents=m,m.TWILSOCK_CONNECT="twilsock.sdk.connect",m.TWILSOCK_INIT="twilsock.sdk.init";class v extends i.EventEmitter{constructor(e,t,n={}){super(),this.offlineStorageDeferred=new d.Deferred,n.continuationToken=n.continuationToken?n.continuationToken:f.TokenStorage.getStoredToken(t);let i=this.config=new r.Configuration(e,t,n);s.log.setLevel(i.logLevel);let p=new l.WebSocketChannel(i.url),v=n.transport?n.transport:new a.PacketInterface(p,i);this.channel=n.channel?n.channel:new o.TwilsockImpl(p,v,i),this.registrations=n.registrations?n.registrations:new c.Registrations(v),this.upstream=new u.Upstream(v,this.channel,i),this.telemetryTracker=new g.TelemetryTracker(i,v),this.channel.on("initialized",()=>this.telemetryTracker.canSendTelemetry=!0),p.on("disconnected",()=>this.telemetryTracker.canSendTelemetry=!1),this.registrations.on("registered",e=>this.emit("registered",e)),this.channel.on("message",(e,t)=>setTimeout(()=>this.emit("message",e,t),0)),this.channel.on("stateChanged",e=>setTimeout(()=>this.emit("stateChanged",e),0)),this.channel.on("connectionError",e=>setTimeout(()=>this.emit("connectionError",e),0)),this.channel.on("tokenAboutToExpire",()=>setTimeout(()=>this.emit("tokenAboutToExpire"),0)),this.channel.on("tokenExpired",()=>setTimeout(()=>this.emit("tokenExpired"),0)),this.channel.on("connected",()=>this.registrations.updateRegistrations()),this.channel.on("connected",()=>this.upstream.sendPendingMessages()),this.channel.on("connected",()=>setTimeout(()=>this.emit("connected"),0)),this.channel.on("beforeConnect",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Establish WebSocket connection","",new Date),m.TWILSOCK_CONNECT,g.TelemetryPoint.Start)),this.channel.on("connected",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Establish WebSocket connection","",new Date,new Date),m.TWILSOCK_CONNECT,g.TelemetryPoint.End)),this.channel.on("beforeSendInit",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","",new Date),m.TWILSOCK_INIT,g.TelemetryPoint.Start)),this.channel.on("initialized",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","Succeeded",new Date,new Date),m.TWILSOCK_INIT,g.TelemetryPoint.End)),this.channel.on("sendInitFailed",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","Failed",new Date,new Date),m.TWILSOCK_INIT,g.TelemetryPoint.End)),this.channel.on("initialized",e=>{this.handleStorageId(t,e),f.TokenStorage.storeToken(e.continuationToken,t),setTimeout(()=>this.emit("initialized",e),0)}),this.channel.on("disconnected",()=>setTimeout(()=>this.emit("disconnected"),0)),this.channel.on("disconnected",()=>this.upstream.rejectPendingMessages()),this.channel.on("disconnected",()=>this.offlineStorageDeferred.fail(new h.TwilsockError("Client disconnected"))),this.offlineStorageDeferred.promise.catch(()=>{})}emit(e,...t){return s.log.debug(`Emitting ${e.toString()}(${t.map(e=>JSON.stringify(e)).join(", ")})`),super.emit(e,...t)}handleStorageId(e,t){if(t.offlineStorage)if(t.offlineStorage.hasOwnProperty(e))try{this.offlineStorageDeferred.set(p.OfflineProductStorage.create(t.offlineStorage[e])),s.log.debug(`Offline storage for '${e}' product: ${JSON.stringify(t.offlineStorage[e])}.`)}catch(n){this.offlineStorageDeferred.fail(new h.TwilsockError(`Failed to parse offline storage for ${e} ${JSON.stringify(t.offlineStorage[e])}. ${n}.`))}else this.offlineStorageDeferred.fail(new h.TwilsockError(`No offline storage id for '${e}' product: ${JSON.stringify(t.offlineStorage)}`));else this.offlineStorageDeferred.fail(new h.TwilsockError("No offline storage id"))}storageId(){return this.offlineStorageDeferred.promise}get isConnected(){return this.channel.isConnected}get state(){return this.channel.state}async updateToken(e){if(s.log.trace(`updating token '${e}'`),this.config.token!==e)return this.config.updateToken(e),this.channel.updateToken(e)}setNotificationsContext(e,t){this.registrations.setNotificationsContext(e,t)}removeNotificationsContext(e){this.registrations.removeNotificationsContext(e)}connect(){return this.channel.connect()}disconnect(){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEventsIncludingUnfinished),this.channel.disconnect()}get(e,t,n){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("GET",e,t,void 0,n)}post(e,t,n,i){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("POST",e,t,n,i)}put(e,t,n,i){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("PUT",e,t,n,i)}delete(e,t,n){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("DELETE",e,t,void 0,n)}addTelemetryEvent(e){this.telemetryTracker.addTelemetryEvent(e),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}addPartialTelemetryEvent(e,t,n){this.telemetryTracker.addPartialEvent(e,t,n),n===g.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}t.TwilsockClient=v,t.Twilsock=v},"+qE3":function(e,t,n){"use strict";var i,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var s,r,o;if(c(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),o=r[t]),void 0===o)o=r[t]=n,++e._eventsCount;else if("function"==typeof o?o=r[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(s=u(e))>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn&&console.warn(a)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=h.bind(i);return s.listener=n,i.wrapFn=s,s}function f(e,t,n){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):m(s,s.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=m(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var n,i,s,r,o;if(c(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){o=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(s=r[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},"+qwt":function(e,t,n){(function(e){var i;(function(){"use strict";var s={function:!0,object:!0},r=s[typeof window]&&window||this,o=s[typeof t]&&t&&s[typeof e]&&e&&!e.nodeType&&e&&"object"==typeof global&&global;!o||o.global!==o&&o.window!==o&&o.self!==o||(r=o);var a=Math.pow(2,53)-1,l=/\bOpera/,c=Object.prototype,u=c.hasOwnProperty,d=c.toString;function h(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function p(e){return e=b(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:h(e)}function f(e,t){for(var n in e)u.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?h(e):d.call(e).slice(8,-1)}function m(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function v(e,t){var n=null;return function(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=a)for(;++n<i;)t(e[n],n);else f(e,t)}(e,(function(i,s){n=t(n,i,s,e)})),n}function b(e){return String(e).replace(/^ +| +$/g,"")}var y=function e(t){var n=r,i=t&&"object"==typeof t&&"String"!=g(t);i&&(n=t,t=null);var s=n.navigator||{},o=s.userAgent||"";t||(t=o);var a,c,u,h,y=i?!!s.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(d.toString()),_=i?"Object":"ScriptBridgingProxyObject",C=i?"Object":"Environment",w=i&&n.java?"JavaPackage":g(n.java),k=i?"Object":"RuntimeObject",x=/\bJava/.test(w)&&n.java,O=x&&g(n.environment)==C,S=x?"a":"\u03b1",M=x?"b":"\u03b2",P=n.document||{},T=n.operamini||n.opera,E=l.test(E=i&&T?T["[[Class]]"]:g(T))?E:T=null,I=t,R=[],j=null,N=t==o,U=N&&T&&"function"==typeof T.version&&T.version(),A=v([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||m(n))+"\\b","i").exec(t)&&(n.label||n)})),D=v(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(e,n){return e||RegExp("\\b"+(n.pattern||m(n))+"\\b","i").exec(t)&&(n.label||n)})),L=q([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),F=v({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(e,n,i){return e||(n[L]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(L)]||RegExp("\\b"+m(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i})),z=v(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(e,n){var i=n.pattern||m(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),p(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,i,n.label||n)),e}));function q(e){return v(e,(function(e,n){var i=n.pattern||m(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=p(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function B(e){return v(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(A&&(A=[A]),/\bAndroid\b/.test(z)&&!L&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(L=b(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),F&&!L?L=q([F]):F&&L&&(L=L.replace(RegExp("^("+m(F)+")[-_.\\s]","i"),F+" ").replace(RegExp("^("+m(F)+")[-_.]?(\\w)","i"),F+" $2")),(a=/\bGoogle TV\b/.exec(L))&&(L=a[0]),/\bSimulator\b/i.test(t)&&(L=(L?L+" ":"")+"Simulator"),"Opera Mini"==D&&/\bOPiOS\b/.test(t)&&R.push("running in Turbo/Uncompressed mode"),"IE"==D&&/\blike iPhone OS\b/.test(t)?(F=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,L=a.product):/^iP/.test(L)?(D||(D="Safari"),z="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==D&&/^Linux\b/i.test(z)?z="Kubuntu":F&&"Google"!=F&&(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(L))||/\bAndroid\b/.test(z)&&/^Chrome/.test(D)&&/\bVersion\//i.test(t)?(D="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):"Silk"==D?(/\bMobi/i.test(t)||(z="Android",R.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&R.unshift("accelerated")):"UC Browser"==D&&/\bUCWEB\b/.test(t)?R.push("speed mode"):"PaleMoon"==D&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?R.push("identifying as Firefox "+a[1]):"Firefox"==D&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(z||(z="Firefox OS"),L||(L=a[1])):!D||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!L&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(D=null),(a=L||F||z)&&(L||F||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:a)+" Browser")):"Electron"==D&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&R.push("Chromium "+a),U||(U=B(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",m(D),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==A&&parseFloat(U)>3?"WebKit":/\bOpera\b/.test(D)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(A)&&"WebKit"||!A&&/\bMSIE\b/i.test(t)&&("Mac OS"==z?"Tasman":"Trident")||"WebKit"==A&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")&&(A=[a]),"IE"==D&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(D+=" Mobile",z="Windows Phone "+(/\+$/.test(a)?a:a+".x"),R.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(D="IE Mobile",z="Windows Phone 8.x",R.unshift("desktop mode"),U||(U=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=D&&"Trident"==A&&(a=/\brv:([\d.]+)/.exec(t))&&(D&&R.push("identifying as "+D+(U?" "+U:"")),D="IE",U=a[1]),N){if(/^(?:boolean|number|string|undefined)$/.test(h=null!=(u=n)?typeof u.global:"number")||"object"==h&&!u.global)g(a=n.runtime)==_?(D="Adobe AIR",z=a.flash.system.Capabilities.os):g(a=n.phantom)==k?(D="PhantomJS",U=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof P.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?((a=+a[1]+4)!=(U=[U,P.documentMode])[1]&&(R.push("IE "+U[1]+" mode"),A&&(A[1]=""),U[1]=a),U="IE"==D?String(U[1].toFixed(1)):U[0]):"number"==typeof P.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(R.push("masking as "+D+" "+U),D="IE",U="11.0",A=["Trident"],z="Windows");else if(x&&(I=(a=x.lang.System).getProperty("os.arch"),z=z||a.getProperty("os.name")+" "+a.getProperty("os.version")),O){try{U=n.require("ringo/engine").version.join("."),D="RingoJS"}catch($){(a=n.system)&&a.global.system==n.system&&(D="Narwhal",z||(z=a[0].os||null))}D||(D="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(R.push("Node "+a.versions.node),D="Electron",U=a.versions.electron):"string"==typeof a.versions.nw&&(R.push("Chromium "+U,"Node "+a.versions.node),D="NW.js",U=a.versions.nw)),D||(D="Node.js",I=a.arch,z=a.platform,U=(U=/[\d.]+/.exec(a.version))?U[0]:null));z=z&&p(z)}if(U&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(U)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(N&&s.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(j=/b/i.test(a)?"beta":"alpha",U=U.replace(RegExp(a+"\\+?$"),"")+("beta"==j?M:S)+(/\d+\+?/.exec(a)||"")),"Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(z))D="Firefox Mobile";else if("Maxthon"==D&&U)U=U.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(L))"Xbox 360"==L&&(z=null),"Xbox 360"==L&&/\bIEMobile\b/.test(t)&&R.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(D)&&(!D||L||/Browser|Mobi/.test(D))||"Windows CE"!=z&&!/Mobi/i.test(t))if("IE"==D&&N)try{null===n.external&&R.unshift("platform preview")}catch($){R.unshift("embedded")}else(/\bBlackBerry\b/.test(L)||/\bBB10\b/.test(t))&&(a=(RegExp(L.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||U)?(z=((a=[a,/BB10/.test(t)])[1]?(L=null,F="BlackBerry"):"Device Software")+" "+a[0],U=null):this!=f&&"Wii"!=L&&(N&&T||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(z)||"IE"==D&&(z&&!/^Win/.test(z)&&U>5.5||/\bWindows XP\b/.test(z)&&U>8||8==U&&!/\bTrident\b/.test(t)))&&!l.test(a=e.call(f,t.replace(l,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),l.test(D)?(/\bIE\b/.test(a)&&"Mac OS"==z&&(z=null),a="identify"+a):(a="mask"+a,D=E?p(E.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(z=null),N||(U=null)),A=["Presto"],R.push(a));else D+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==D&&"+"==a[1].slice(-1)?(D="WebKit Nightly",j="alpha",U=a[1].slice(0,-1)):U!=a[1]&&U!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(U=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==A&&(A=["Blink"]),N&&(y||a[1])?(A&&(A[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=A?"27":"28")):(A&&(A[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),A&&(A[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==D&&(!U||parseInt(U)>45)?U=a:"Chrome"==D&&/\bHeadlessChrome/i.test(t)&&R.unshift("headless")),"Opera"==D&&(a=/\bzbov|zvav$/.exec(z))?(D+=" ",R.unshift("desktop mode"),"zvav"==a?(D+="Mini",U=null):D+="Mobile",z=z.replace(RegExp(" *"+a+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(A&&A[1])?(R.unshift("desktop mode"),D="Chrome Mobile",U=null,/\bOS X\b/.test(z)?(F="Apple",z="iOS 4.3+"):z=null):/\bSRWare Iron\b/.test(D)&&!U&&(U=B("Chrome")),U&&0==U.indexOf(a=/[\d.]+$/.exec(z))&&t.indexOf("/"+a+"-")>-1&&(z=b(z.replace(a,""))),z&&-1!=z.indexOf(D)&&!RegExp(D+" OS").test(z)&&(z=z.replace(RegExp(" *"+m(D)+" *"),"")),A&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(z)&&/\bSafari\b/.test(A[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(D)&&A[1])&&(a=A[A.length-1])&&R.push(a),R.length&&(R=["("+R.join("; ")+")"]),F&&L&&L.indexOf(F)<0&&R.push("on "+F),L&&R.push((/^on /.test(R[R.length-1])?"":"on ")+L),z&&(a=/ ([\d.+]+)$/.exec(z),c=a&&"/"==z.charAt(z.length-a[0].length-1),z={architecture:32,family:a&&!c?z.replace(a[0],""):z,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(I))&&!/\bi686\b/i.test(I)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+a),"")),D&&(/\bWOW64\b/i.test(t)||N&&/\w(?:86|32)$/.test(s.cpuClass||s.platform)&&!/\bWin64; x64\b/i.test(t))&&R.unshift("32-bit")):z&&/^OS X/.test(z.family)&&"Chrome"==D&&parseFloat(U)>=39&&(z.architecture=64),t||(t=null);var W={};return W.description=t,W.layout=A&&A[0],W.manufacturer=F,W.name=D,W.prerelease=j,W.product=L,W.ua=t,W.version=D&&U,W.os=z||{architecture:null,family:null,version:null,toString:function(){return"null"}},W.parse=e,W.toString=function(){return this.description||""},W.version&&R.unshift(U),W.name&&R.unshift(D),z&&D&&(z!=String(z).split(" ")[0]||z!=D.split(" ")[0]&&!L)&&R.push(L?"("+z+")":"on "+z),R.length&&(W.description=R.join(" ")),W}();r.platform=y,void 0===(i=(function(){return y}).call(t,n,t,e))||(e.exports=i)}).call(this)}).call(this,n("YuTi")(e))},"+vXQ":function(e,t,n){e.exports=!n("C61u")&&!n("S4vA")((function(){return 7!=Object.defineProperty(n("BfU5")("div"),"a",{get:function(){return 7}}).a}))},"/2MY":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paginator=void 0,t.Paginator=class{constructor(e,t,n,i){this.prevToken=n,this.nextToken=i,this.items=e,this.source=t}get hasNextPage(){return!!this.nextToken}get hasPrevPage(){return!!this.prevToken}async nextPage(){if(!this.hasNextPage)throw new Error("No next page");return this.source(this.nextToken)}async prevPage(){if(!this.hasPrevPage)throw new Error("No previous page");return this.source(this.prevToken)}}},"/F7N":function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},"/LtL":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Notifications=void 0;const i=n("mB9D");Object.defineProperty(t,"Notifications",{enumerable:!0,get:function(){return i.Client}})},"/NTb":function(e,t,n){t.f=n("zBWt")},"/S/1":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineProductStorage=void 0;const i=n("7FP+");class s{constructor(e){this.id=e}static create(e){if(e instanceof Object&&"storage_id"in e)return new s(e.storage_id);throw new i.TwilsockError('Field "storage_id" is missing')}}t.OfflineProductStorage=s},"/r8T":function(e,t,n){var i=n("ekG2"),s=n("Trx6"),r=n("zBWt")("species");e.exports=function(e){var t;return s(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!s(t.prototype)||(t=void 0),i(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},"/tXR":function(e,t){t.f=Object.getOwnPropertySymbols},"0KeW":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registrations=void 0;const i=n("MZ0W"),s=n("+qE3"),r=n("EcEN"),o=n("arZA");t.Registrations=class extends s.EventEmitter{constructor(e){super(),this.transport=e,this.registrations=new Map,this.registrationsInProgress=new Map}async putNotificationContext(e,t){const n={method:"put_notification_ctx",notification_ctx_id:e};await this.transport.sendWithReply(n,t)}async deleteNotificationContext(e){let t={method:"delete_notification_ctx",notification_ctx_id:e};await this.transport.sendWithReply(t)}async updateRegistration(e,t){i.log.debug("update registration for context",e);let n=this.registrationsInProgress.get(e);n||(n=new Set,this.registrationsInProgress.set(e,n));const s=r.v4();n.add(s);try{await this.putNotificationContext(e,t),i.log.debug("registration attempt succeeded for context",t),n.delete(s),0===n.size&&(this.registrationsInProgress.delete(e),this.emit("registered",e))}catch(o){i.log.warn("registration attempt failed for context",t),i.log.debug(o),n.delete(s),0===n.size&&(this.registrationsInProgress.delete(e),this.emit("registrationFailed",e,o))}}updateRegistrations(){i.log.trace(`refreshing ${this.registrations.size} registrations`),this.registrations.forEach((e,t)=>{this.updateRegistration(t,e)})}setNotificationsContext(e,t){if(!e||!t)throw new o.TwilsockError("Invalid arguments provided");this.registrations.set(e,t),this.transport.isConnected&&this.updateRegistration(e,t)}async removeNotificationsContext(e){this.registrations.has(e)&&(await this.deleteNotificationContext(e),this.transport.isConnected&&this.registrations.delete(e))}}},"0KpA":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketChannel=void 0;const i=n("+qE3"),s=n("uShU");t.WebSocketChannel=class extends i.EventEmitter{constructor(e){super(),this.url=e,this.WebSocket=global.WebSocket||global.MozWebSocket||n(6)}get isConnected(){return this.socket&&1===this.socket.readyState}connect(){s.log.trace("connecting to socket");let e=new this.WebSocket(this.url);e.binaryType="arraybuffer",e.onopen=()=>{s.log.debug(`socket opened ${this.url}`),this.emit("connected")},e.onclose=e=>{s.log.debug("socket closed",e),this.emit("disconnected",e)},e.onerror=e=>{s.log.debug("error:",e),this.emit("socketError",e)},e.onmessage=e=>{this.emit("message",e.data)},this.socket=e}send(e){this.socket.send(e)}close(){if(s.log.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}},"0WpP":function(e,t,n){var i=n("/F7N"),s=Math.min;e.exports=function(e){return e>0?s(i(e),9007199254740991):0}},"0YXi":function(e,t,n){"use strict";var i=a(n("14Xm")),s=a(n("D3Ub")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncList=void 0;var l=n("iqZd"),c=n("IMt4"),u=n("3m9+"),d=function(){function e(t){(0,r.default)(this,e),this.services=t}var t;return(0,o.default)(e,[{key:"getPage",value:(t=(0,s.default)(i.default.mark((function e(t){var n,s,r=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},e.next=3,this.services.session.getSessionLinks();case 3:return n=new l.UriBuilder(e.sent.syncListUrl).arg("PageToken",t.pageToken).build(),e.next=7,this.services.network.get(n);case 7:return e.abrupt("return",new c.RestPaginator((s=e.sent).body.channels.map((function(e){return new u.SyncListDescriptor(e)})),(function(e){return r.getPage({pageToken:e})}),s.body.meta.previous_token,s.body.meta.next_token));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.SyncList=d},"0s00":function(e){e.exports=JSON.parse('{"_args":[["twilio-chat@4.1.0","D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin"]],"_from":"twilio-chat@4.1.0","_id":"twilio-chat@4.1.0","_inBundle":false,"_integrity":"sha512-oK/Req0KMBedZox3lciBEKmAiMe6L/6z8fGlx+4YKRjEX3J4Abag0TkMwAxPizB32ILKQKV2WBi/+Hqwi808RA==","_location":"/twilio-chat","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"twilio-chat@4.1.0","name":"twilio-chat","escapedName":"twilio-chat","rawSpec":"4.1.0","saveSpec":null,"fetchSpec":"4.1.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/twilio-chat/-/twilio-chat-4.1.0.tgz","_spec":"4.1.0","_where":"D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin","author":{"name":"Twilio"},"browser":"browser/index.js","browserslist":["IE 11","last 3 Chrome versions","last 3 Firefox versions","last 3 Safari versions","last 3 Edge versions","last 2 iOS version","last 2 ChromeAndroid version","last 2 FirefoxAndroid version","last 2 Samsung versions","last 2 UCAndroid versions"],"dependencies":{"babel-runtime":"^6.26.0","iso8601-duration":"^1.2.0","loglevel":"^1.6.6","operation-retrier":"^3.0.0","platform":"^1.3.6","rfc6902":"^3.0.2","twilio-mcs-client":"^0.3.3","twilio-notifications":"^0.5.9","twilio-sync":"^0.13.0","twilsock":"^0.6.1","uuid":"^3.3.2"},"description":"Twilio Chat service client library","devDependencies":{"@types/chai":"^4.2.5","@types/chai-as-promised":"^7.1.2","@types/chai-string":"^1.4.1","@types/core-js":"^2.5.0","@types/mocha":"^5.2.7","@types/node":"^12.12.12","@types/sinon":"^7.5.1","@types/sinon-chai":"^3.2.2","async":"^3.0.1","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babelify":"^8.0.0","backoff":"^2.5.0","browserify":"^16.2.3","browserify-replace":"^1.0.0","browserslist":"^4.13.0","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.0","del":"^5.1.0","fancy-log":"^1.3.3","fs":"0.0.2","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^2.0.2","gulp-insert":"^0.5.0","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^1.0.1","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.4","ink-docstrap":"^1.3.2","isomorphic-form-data":"^2.0.0","jsdoc":"~3.5.5","jsdoc-strip-async-await":"^0.1.0","mocha":"^6.2.2","mocha.parallel":"^0.15.6","node-fetch":"^2.6.0","nyc":"^14.1.1","path":"^0.12.7","sinon":"^7.5.0","sinon-chai":"^3.3.0","source-map-explorer":"^2.1.1","ts-node":"^8.5.2","tslint":"^5.20.1","twilio":"^3.37.1","typescript":"^3.7.2","uglify-save-license":"^0.4.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},"engines":{"node":">=6"},"license":"MIT","main":"lib/index.js","name":"twilio-chat","types":"./lib/client.d.ts","version":"4.1.0"}')},"14Xm":function(e,t,n){e.exports=n("cSMa")},"174E":function(e,t,n){"use strict";var i=p(n("4d7F")),s=p(n("gDS+")),r=p(n("14Xm")),o=p(n("D3Ub")),a=p(n("ODRq")),l=p(n("Yz+Y")),c=p(n("iCc5")),u=p(n("V7oC")),d=p(n("FYw3")),h=p(n("mRg0"));function p(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0;var f=n("+qE3"),g=n("yC9A"),m=n("wv9B"),v=g.Logger.scope("Messages"),b=function(e){function t(e,n){(0,c.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this));return i.channel=e,i.services=n,i.messagesByIndex=new a.default,i.messagesListPromise=null,i}var n,p,f;return(0,h.default)(t,e),(0,u.default)(t,[{key:"subscribe",value:function(e){var t=this;return this.messagesListPromise=this.messagesListPromise||this.services.syncClient.list({id:e,mode:"open_existing"}).then((function(e){return e.on("itemAdded",(function(e){v.debug(t.channel.sid+" itemAdded: "+e.item.index);var n=new m.Message(t.channel,t.services,e.item.index,e.item.value);t.messagesByIndex.has(n.index)?v.debug("Message arrived, but already known and ignored",t.channel.sid,n.index):(t.messagesByIndex.set(n.index,n),n.on("updated",(function(e){return t.emit("messageUpdated",e)})),t.emit("messageAdded",n))})),e.on("itemRemoved",(function(e){v.debug(t.channel.sid+" itemRemoved: "+e.index);var n=e.index;if(t.messagesByIndex.has(n)){var i=t.messagesByIndex.get(n);t.messagesByIndex.delete(i.index),i.removeAllListeners("updated"),t.emit("messageRemoved",i)}})),e.on("itemUpdated",(function(e){v.debug(t.channel.sid+" itemUpdated: "+e.item.index);var n=t.messagesByIndex.get(e.item.index);n&&n._update(e.item.value)})),e})).catch((function(e){throw t.messagesListPromise=null,"disconnected"!=t.services.syncClient.connectionState&&v.error("Failed to get messages object for channel",t.channel.sid,e),v.debug("ERROR: Failed to get messages object for channel",t.channel.sid,e),e}))}},{key:"unsubscribe",value:(f=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.messagesListPromise){e.next=6;break}return e.next=3,this.messagesListPromise;case 3:e.sent.close(),this.messagesListPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"send",value:(p=(0,o.default)(r.default.mark((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.debug("Sending text message",t,n),e.abrupt("return",this.services.session.addCommand("sendMessage",{channelSid:this.channel.sid,text:t,attributes:(0,s.default)(n)}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"sendMedia",value:(n=(0,o.default)(r.default.mark((function e(t){var n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.debug("Sending media message",t,o),n=void 0,!("undefined"!=typeof FormData&&t instanceof FormData)){e.next=9;break}return v.debug("Sending media message as FormData",t,o),e.next=6,this.services.mcsClient.postFormData(t);case 6:n=e.sent,e.next=16;break;case 9:if(v.debug("Sending media message as SendMediaOptions",t,o),(i=t).contentType&&i.media){e.next=13;break}throw new Error("Media content <Channel#SendMediaOptions> must contain non-empty contentType and media");case 13:return e.next=15,this.services.mcsClient.post(i.contentType,i.media);case 15:n=e.sent;case 16:return e.abrupt("return",this.services.session.addCommand("sendMediaMessage",{channelSid:this.channel.sid,mediaSid:n.sid,attributes:(0,s.default)(o)}));case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getMessages",value:function(e,t,n){return this._getMessages(e,t=void 0!==t?t:"end",n=n||"backwards")}},{key:"wrapPaginator",value:function(e,t,n){var i=this,s="desc"===e,r=function(){return t.nextPage().then((function(t){return i.wrapPaginator(e,t,n)}))},o=function(){return t.prevPage().then((function(t){return i.wrapPaginator(e,t,n)}))};return n(t.items).then((function(e){return{items:e.sort((function(e,t){return e.index-t.index})),hasPrevPage:s?t.hasNextPage:t.hasPrevPage,hasNextPage:s?t.hasPrevPage:t.hasNextPage,prevPage:s?r:o,nextPage:s?o:r}}))}},{key:"_upsertMessage",value:function(e,t){var n=this,i=this.messagesByIndex.get(e);if(i)return i;var s=new m.Message(this.channel,this.services,e,t);return this.messagesByIndex.set(s.index,s),s.on("updated",(function(e){return n.emit("messageUpdated",e)})),s}},{key:"_getMessages",value:function(e,t,n){var s=this;t=void 0!==t?t:"end",e=e||30;var r="backwards"===n?"desc":"asc";return this.messagesListPromise.then((function(n){return n.getItems({from:"end"!==t?t:void 0,pageSize:e,order:r})})).then((function(e){return s.wrapPaginator(r,e,(function(e){return i.default.all(e.map((function(e){return s._upsertMessage(e.index,e.value)})))}))}))}}]),t}(f.EventEmitter);t.Messages=b},"1GvH":function(e,t,n){n("5w6Y"),e.exports=n("VSTI").Object.keys},"1dR4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListItem=void 0;class i{constructor(e){this.data=e}get uri(){return this.data.uri}get revision(){return this.data.revision}get lastEventId(){return this.data.lastEventId}get dateUpdated(){return this.data.dateUpdated}get dateExpires(){return this.data.dateExpires}get index(){return this.data.index}get value(){return this.data.value}update(e,t,n,i){return this.data.lastEventId=e,this.data.revision=t,this.data.value=n,this.data.dateUpdated=i,this}updateDateExpires(e){this.data.dateExpires=e}}t.ListItem=i,t.default=i},"1i29":function(e,t,n){"use strict";var i=n("USwo"),s=n("FgkJ"),r=n("nAx8"),o=n("wlNh");e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,a,l=arguments[1];return s(this),(t=void 0!==l)&&s(l),null==e?new this:(n=[],t?(i=0,a=r(l,arguments[2],2),o(e,!1,(function(e){n.push(a(e,i++))}))):o(e,!1,n.push,n),new this(n))}})}},"2zfi":function(e,t,n){var i=n("d+lc"),s=n("FgkJ"),r=n("zBWt")("species");e.exports=function(e,t){var n,o=i(e).constructor;return void 0===o||null==(n=i(o)[r])?t:s(n)}},"3+Ww":function(e,t){},"32R9":function(e,t,n){n("xKiQ"),e.exports=n("VSTI").Reflect.metadata},"37Ge":function(e,t,n){"use strict";var i=w(n("GQeE")),s=w(n("FyfS")),r=w(n("m1cH")),o=w(n("jWXv")),a=w(n("14Xm")),l=w(n("4d7F")),c=w(n("D3Ub")),u=w(n("ODRq")),d=w(n("gDS+")),h=w(n("ql3t")),p=w(n("Yz+Y")),f=w(n("iCc5")),g=w(n("V7oC")),m=w(n("FYw3")),v=w(n("mRg0")),b=w(n("u8T8")),y=w(n("SEkw")),_=w(n("EJiy")),C=w(n("JO7F"));function w(e){return e&&e.__esModule?e:{default:e}}var k=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=(0,C.default)(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,_.default)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&(0,y.default)(t,n,o),o},x=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,_.default)(Reflect))&&"function"==typeof b.default)return(0,b.default)(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Channel=void 0;var O=n("+qE3"),S=n("yC9A"),M=n("HlZy"),P=n("Eig5"),T=n("174E"),E=n("iqZd"),I=n("C9Jq"),R=S.Logger.scope("Channel"),j={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",type:"type",uniqueName:"uniqueName",state:"state"};function N(e){try{return new Date(e)}catch(t){return null}}var U=function(e){function t(e,n,i){(0,f.default)(this,t);var s=(0,m.default)(this,(t.__proto__||(0,p.default)(t)).call(this)),r=n.attributes||{},o=n.createdBy,a=N(n.dateCreated),l=N(n.dateUpdated),c=n.friendlyName||null,g=(0,h.default)(n.lastConsumedMessageIndex)?n.lastConsumedMessageIndex:null,v=n.uniqueName||null;try{(0,d.default)(r)}catch(b){throw new Error("Attributes must be a valid JSON object.")}return s.services=e,s.sid=i,s.entityName=n.channel,s.channelState={uniqueName:v,status:"notParticipating",type:n.type,attributes:r,createdBy:o,dateCreated:a,dateUpdated:l,friendlyName:c,lastConsumedMessageIndex:g},n.notificationLevel&&(s.channelState.notificationLevel=n.notificationLevel),s.members=new u.default,s.membersEntity=new M.Members(s,s.services,s.members),s.membersEntity.on("memberJoined",s.emit.bind(s,"memberJoined")),s.membersEntity.on("memberLeft",s.emit.bind(s,"memberLeft")),s.membersEntity.on("memberUpdated",(function(e){return s.emit("memberUpdated",e)})),s.messagesEntity=new T.Messages(s,e),s.messagesEntity.on("messageAdded",(function(e){return s._onMessageAdded(e)})),s.messagesEntity.on("messageUpdated",(function(e){return s.emit("messageUpdated",e)})),s.messagesEntity.on("messageRemoved",s.emit.bind(s,"messageRemoved")),s}var n,b,y,_,C,w,k,x,O,S,I,U,A,D,L,F,z,q,B,W,$,G,V,X,J,H,K;return(0,v.default)(t,e),(0,g.default)(t,[{key:"_subscribe",value:function(){var e=this;return this.entityPromise?this.entityPromise:this.entityPromise=this.entityPromise||this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then((function(t){return e.entity=t,e.entity.on("updated",(function(t){e._update(t.value)})),e.entity.on("removed",(function(){return e.emit("removed",e)})),e._update(e.entity.value),t})).catch((function(t){throw e.entity=null,e.entityPromise=null,"disconnected"!=e.services.syncClient.connectionState&&R.error("Failed to get channel object",t),R.debug("ERROR: Failed to get channel object",t),t}))}},{key:"_subscribeStreams",value:(K=(0,c.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._subscribe();case 3:return R.trace("_subscribeStreams, this.entity.value=",this.entity.value),t=this.entity.value.messages,n=this.entity.value.roster,e.next=8,l.default.all([this.messagesEntity.subscribe(t),this.membersEntity.subscribe(n)]);case 8:e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(0),"disconnected"!==this.services.syncClient.connectionState&&R.error("Failed to subscribe on channel objects",this.sid,e.t0),R.debug("ERROR: Failed to subscribe on channel objects",this.sid,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return K.apply(this,arguments)})},{key:"_unsubscribe",value:(H=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrivate||!this.entity){e.next=5;break}return e.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return e.abrupt("return",l.default.all([this.membersEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"_setStatus",value:function(e,t){var n=this;this.statusSource=t,this.channelState.status!==e&&(this.channelState.status=e,"joined"===e?this._subscribeStreams().catch((function(t){if(R.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):"invited"===e?this._subscribe().catch((function(t){if(R.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):this.entityPromise&&this._unsubscribe().catch((function(t){if(R.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(e){var n,a,l,c,u;R.trace("_update",e),t.preprocessUpdate(e,this.sid);var d=new o.default,h=!0,p=!1,f=void 0;try{for(var g,m=(0,s.default)((0,i.default)(e));!(h=(g=m.next()).done);h=!0){var v=g.value,b=j[v];if(b)switch(b){case j.status:if(!e.status||"unknown"===e.status||this.channelState.status===e.status)break;this.channelState.status=e.status,d.add(b);break;case j.attributes:if(E.isDeepEqual(this.channelState.attributes,e.attributes))break;this.channelState.attributes=e.attributes,d.add(b);break;case j.lastConsumedMessageIndex:if(void 0===e.lastConsumedMessageIndex||e.lastConsumedMessageIndex===this.channelState.lastConsumedMessageIndex)break;this.channelState.lastConsumedMessageIndex=e.lastConsumedMessageIndex,d.add(b);break;case j.lastMessage:if(this.channelState.lastMessage&&!e.lastMessage){delete this.channelState.lastMessage,d.add(b);break}this.channelState.lastMessage=this.channelState.lastMessage||{},void 0!==(null===(n=e.lastMessage)||void 0===n?void 0:n.index)&&e.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=e.lastMessage.index,d.add(b)),void 0!==(null===(a=e.lastMessage)||void 0===a?void 0:a.timestamp)&&(null===(c=null===(l=this.channelState.lastMessage)||void 0===l?void 0:l.dateCreated)||void 0===c?void 0:c.getTime())!==e.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=e.lastMessage.timestamp,d.add(b)),E.isDeepEqual(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case j.state:var y=e.state||void 0;if(void 0!==y&&(y.dateUpdated=new Date(y.dateUpdated)),E.isDeepEqual(this.channelState.state,y))break;this.channelState.state=y,d.add(b);break;default:var _=e[v]instanceof Date;if(_&&(null===(u=this.channelState[b])||void 0===u?void 0:u.getTime())===e[v].getTime()||!_&&this[b]===e[v])break;this.channelState[b]=e[v],d.add(b)}}}catch(C){p=!0,f=C}finally{try{!h&&m.return&&m.return()}finally{if(p)throw f}}d.size>0&&this.emit("updated",{channel:this,updateReasons:[].concat((0,r.default)(d))})}},{key:"_onMessageAdded",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=(0,s.default)(this.members.values());!(t=(r=o.next()).done);t=!0){var a=r.value;if(a.identity===e.author){a._endTyping();break}}}catch(l){n=!0,i=l}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}this.emit("messageAdded",e)}},{key:"add",value:(J=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.membersEntity.add(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return J.apply(this,arguments)})},{key:"advanceLastConsumedMessageIndex",value:(X=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.services.consumptionHorizon.advanceLastConsumedMessageIndexForChannel(this.sid,t,this.lastConsumedMessageIndex));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return X.apply(this,arguments)})},{key:"decline",value:(V=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("declineInvitation",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"delete",value:(G=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("destroyChannel",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"getAttributes",value:($=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribe();case 2:return e.abrupt("return",this.attributes);case 3:case"end":return e.stop()}}),e,this)}))),function(){return $.apply(this,arguments)})},{key:"getMessages",value:(W=(0,c.default)(a.default.mark((function e(t,n,i){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.messagesEntity.getMessages(t,n,i));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return W.apply(this,arguments)})},{key:"getMembers",value:(B=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.membersEntity.getMembers());case 3:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"getMembersCount",value:(q=(0,c.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new E.UriBuilder(e.sent.publicChannelsUrl).path(this.sid).build(),e.next=6,this.services.network.get(t);case 6:return e.abrupt("return",e.sent.body.members_count);case 8:case"end":return e.stop()}}),e,this)}))),function(){return q.apply(this,arguments)})},{key:"getMemberBySid",value:(z=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.membersEntity.getMemberBySid(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return z.apply(this,arguments)})},{key:"getMemberByIdentity",value:(F=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.membersEntity.getMemberByIdentity(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"getMessagesCount",value:(L=(0,c.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new E.UriBuilder(e.sent.publicChannelsUrl).path(this.sid).build(),e.next=6,this.services.network.get(t);case 6:return e.abrupt("return",e.sent.body.messages_count);case 8:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"getUnconsumedMessagesCount",value:(D=(0,c.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new E.UriBuilder(e.sent.myChannelsUrl).arg("ChannelSid",this.sid).build(),e.next=6,this.services.network.get(t);case 6:if(!(n=e.sent).body.channels.length||n.body.channels[0].channel_sid!=this.sid){e.next=11;break}if(void 0===n.body.channels[0].unread_messages_count||null==n.body.channels[0].unread_messages_count){e.next=10;break}return e.abrupt("return",n.body.channels[0].unread_messages_count);case 10:return e.abrupt("return",null);case 11:throw new Error("Channel is not in user channels list");case 12:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"invite",value:(A=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.membersEntity.invite(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"join",value:(U=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("joinChannelV2",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return U.apply(this,arguments)})},{key:"leave",value:(I=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"!==this.channelState.status){e.next=3;break}return e.next=3,this.services.session.addCommand("leaveChannel",{channelSid:this.sid});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"removeMember",value:(S=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof P.Member)){e.next=4;break}return e.next=3,this.membersEntity.removeBySid(t.sid);case 3:return e.abrupt("return");case 4:return e.next=6,this.membersEntity.removeByIdentity(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"sendMessage",value:(O=(0,c.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t&&null!==t){e.next=5;break}return e.next=3,this.messagesEntity.send(t,n);case 3:return e.abrupt("return",E.parseToNumber(e.sent.messageId));case 5:return e.next=7,this.messagesEntity.sendMedia(t,n);case 7:return e.abrupt("return",E.parseToNumber(e.sent.messageId));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"setAllMessagesConsumed",value:(x=(0,c.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this.getMessages(1);case 4:if(!((t=e.sent).items.length>0)){e.next=7;break}return e.abrupt("return",this.advanceLastConsumedMessageIndex(t.items[0].index));case 7:return e.abrupt("return",l.default.resolve(0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"setNoMessagesConsumed",value:(k=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.services.consumptionHorizon.updateLastConsumedMessageIndexForChannel(this.sid,null));case 3:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"setUserNotificationLevel",value:(w=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("editNotificationLevel",{channelSid:this.sid,notificationLevel:t});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:(C=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("editAttributes",{channelSid:this.sid,attributes:(0,d.default)(t)});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"updateFriendlyName",value:(_=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.friendlyName===t){e.next=3;break}return e.next=3,this.services.session.addCommand("editFriendlyName",{channelSid:this.sid,friendlyName:t});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"updateLastConsumedMessageIndex",value:(y=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.services.consumptionHorizon.updateLastConsumedMessageIndexForChannel(this.sid,t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"updateUniqueName",value:(b=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.uniqueName===t){e.next=4;break}return t||(t=""),e.next=4,this.services.session.addCommand("editUniqueName",{channelSid:this.sid,uniqueName:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"getUserDescriptors",value:(n=(0,c.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getChannelUserDescriptors(this.sid));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"status",get:function(){return this.channelState.status}},{key:"type",get:function(){return this.channelState.type}},{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"isPrivate",get:function(){return"private"===this.channelState.type}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){return this.channelState.createdBy}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastConsumedMessageIndex",get:function(){return this.channelState.lastConsumedMessageIndex}},{key:"lastMessage",get:function(){return this.channelState.lastMessage}},{key:"notificationLevel",get:function(){return this.channelState.notificationLevel}},{key:"state",get:function(){return this.channelState.state}}],[{key:"preprocessUpdate",value:function(e,t){try{"string"==typeof e.attributes?e.attributes=JSON.parse(e.attributes):e.attributes&&(0,d.default)(e.attributes)}catch(n){R.warn("Retrieved malformed attributes from the server for channel: "+t),e.attributes={}}try{e.dateCreated&&(e.dateCreated=new Date(e.dateCreated))}catch(n){R.warn("Retrieved malformed dateCreated from the server for channel: "+t),delete e.dateCreated}try{e.dateUpdated&&(e.dateUpdated=new Date(e.dateUpdated))}catch(n){R.warn("Retrieved malformed dateUpdated from the server for channel: "+t),delete e.dateUpdated}try{e.lastMessage&&e.lastMessage.timestamp&&(e.lastMessage.timestamp=new Date(e.lastMessage.timestamp))}catch(n){R.warn("Retrieved malformed lastMessage.timestamp from the server for channel: "+t),delete e.lastMessage.timestamp}}}]),t}(O.EventEmitter);k([I.asyncTypeCheck(I.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"add",null),k([I.asyncTypeCheck(I.nonNegativeInteger),x("design:type",Function),x("design:paramtypes",[Number]),x("design:returntype",l.default)],U.prototype,"advanceLastConsumedMessageIndex",null),k([I.asyncTypeCheck(["undefined",I.nonNegativeInteger],["undefined",I.nonNegativeInteger],["undefined",I.literal("backwards","forward")]),x("design:type",Function),x("design:paramtypes",[Number,Number,String]),x("design:returntype",l.default)],U.prototype,"getMessages",null),k([I.asyncTypeCheck(I.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"getMemberBySid",null),k([I.asyncTypeCheck(I.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"getMemberByIdentity",null),k([I.asyncTypeCheck(I.nonEmptyString),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"invite",null),k([I.asyncTypeCheck([I.nonEmptyString,P.Member]),x("design:type",Function),x("design:paramtypes",[Object]),x("design:returntype",l.default)],U.prototype,"removeMember",null),k([I.asyncTypeCheck(["string",I.literal(null),I.custom((function(e){return[e instanceof FormData,"an instance of FormData"]})),I.custom((function(e){if("object"!==(void 0===e?"undefined":(0,_.default)(e))||null===e||Array.isArray(e))return[!1,"valid media options (should be a pure object)"];if(!("string"==typeof e.contentType&&e.contentType.length>0))return[!1,"valid media options (mediaOptions.contentType should be a non-empty string)","malformed media options (mediaOptions.contentType is "+I.stringifyReceivedType(e.contentType)+")"];var t="string"==typeof e.media&&e.media.length>0||e.media instanceof Uint8Array||e.media instanceof ArrayBuffer;return"function"==typeof Blob&&(t=t||e.media instanceof Blob),t?[!0]:[!1,"valid media options (mediaOptions.media should be a non-empty string, an instance of Buffer or an instance of Blob)","malformed media options (mediaOptions.media is "+I.stringifyReceivedType(e.media)+")"]}))],["undefined","string","number","boolean","object",I.literal(null)]),x("design:type",Function),x("design:paramtypes",[Object,Object]),x("design:returntype",l.default)],U.prototype,"sendMessage",null),k([I.asyncTypeCheck(I.literal("default","muted")),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"setUserNotificationLevel",null),k([I.asyncTypeCheck(["string","number","boolean","object",I.literal(null)]),x("design:type",Function),x("design:paramtypes",[Object]),x("design:returntype",l.default)],U.prototype,"updateAttributes",null),k([I.asyncTypeCheck(["string",I.literal(null)]),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"updateFriendlyName",null),k([I.asyncTypeCheck([I.literal(null),I.nonNegativeInteger]),x("design:type",Function),x("design:paramtypes",[Number]),x("design:returntype",l.default)],U.prototype,"updateLastConsumedMessageIndex",null),k([I.asyncTypeCheck(["string",I.literal(null)]),x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",l.default)],U.prototype,"updateUniqueName",null),t.Channel=U},"3Lba":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connector=t.RegistrationState=void 0;const i=n("+qE3"),s=n("Q3x1");class r{constructor(e="",t="",n=new Set){this.token=e,this.notificationId=t,this.messageTypes=n}clone(){return new r(this.token,this.notificationId,new Set(this.messageTypes))}}t.RegistrationState=r,t.Connector=class extends i.EventEmitter{constructor(e){super(),this.config=e,this.desiredState=new r,this.currentState=new r,this.hasActiveAttempt=!1}async subscribe(e){this.desiredState.messageTypes.has(e)?s.log.debug("message type already registered ",e):(this.desiredState.messageTypes.add(e),await this.persistRegistration())}async unsubscribe(e){this.desiredState.messageTypes.has(e)&&(this.desiredState.messageTypes.delete(e),await this.persistRegistration())}updateToken(e){this.desiredState.token=e,this.persistRegistration()}async persistRegistration(){if(!this.config.token||0===this.config.token.length)return void s.log.trace("Can't persist registration: token is not set");if(this.hasActiveAttempt)return void s.log.trace("One registration attempt is already in progress");let[e,t]=function(e,t){let n=new Set;return e.notificationId!==t.notificationId&&n.add("notificationId"),e.token!==t.token&&n.add("token"),function(e,t){return[...[...e].filter(e=>!t.has(e)),...[...t].filter(t=>!e.has(t))]}(e.messageTypes,t.messageTypes).length>0&&n.add("messageType"),[n.size>0,n]}(this.desiredState,this.currentState);if(e){this.currentState.notificationId||t.delete("notificationId"),s.log.trace("Persisting registration",t,this.desiredState);try{this.hasActiveAttempt=!0;let e=this.desiredState.clone();if(e.messageTypes.size>0){let n=await this.updateRegistration(e,t);this.currentState.token=n.token,this.currentState.notificationId=n.notificationId,this.currentState.messageTypes=n.messageTypes,this.emit("stateChanged","registered")}else await this.removeRegistration(),this.currentState.token=e.token,this.currentState.notificationId=e.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged","unregistered")}finally{this.hasActiveAttempt=!1,setTimeout(()=>this.persistRegistration(),0)}}}setNotificationId(e){this.desiredState.notificationId=e,this.persistRegistration()}}},"3P3t":function(e,t,n){var i=n("USwo");i(i.P+i.R,"Map",{toJSON:n("KtlF")("Map")})},"3Y8D":function(e,t,n){"use strict";var i=n("WKX2");e.exports=i},"3dc8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("vSOj"),s=n("f9CJ"),r=n("qzTf"),o=s.Logger.scope("Network");t.Network=class{constructor(e,t){this.config=e,this.transport=t}backoffConfig(){return Object.assign(r.Configuration.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){return void 0!==this.config.retryWhenThrottledOverride?this.config.retryWhenThrottledOverride:void 0!==r.Configuration.retryWhenThrottledDefault&&r.Configuration.retryWhenThrottledDefault}executeWithRetry(e,t=!1){return new Promise((n,s)=>{let r=[502,503,504];t&&r.push(429);let o=new i.Retrier(this.backoffConfig());o.on("attempt",()=>{e().then(e=>o.succeeded(e)).catch(e=>{r.indexOf(e.status)>-1?o.failed(e):"Twilsock disconnected"===e.message?o.failed(e):(o.removeAllListeners(),o.cancel(),s(e))})}),o.on("succeeded",e=>{n(e)}),o.on("cancelled",e=>s(e)),o.on("failed",e=>s(e)),o.start()})}async get(e){const t={"X-Twilio-Token":this.config.token};o.trace("sending GET request to ",e," headers ",t);let n=await this.executeWithRetry(()=>this.transport.get(e,t),this.retryWhenThrottled());return o.trace("response",n),n}async post(e,t,n){let i,s={"X-Twilio-Token":this.config.token};"undefined"!=typeof FormData&&t instanceof FormData||!n||Object.assign(s,{"Content-Type":n}),o.trace("sending POST request to ",e," headers ",s);try{i=await this.transport.post(e,s,t)}catch(r){throw r instanceof TypeError?(o.trace("got error in post response",r),new TypeError("Posting FormData supported only with browser engine's FormData")):r}return o.trace("response",i),i}}},"3m9+":function(e,t,n){"use strict";var i,s=(i=n("iCc5"))&&i.__esModule?i:{default:i};Object.defineProperty(t,"__esModule",{value:!0}),t.SyncListDescriptor=void 0,t.SyncListDescriptor=function e(t){(0,s.default)(this,e),this.descriptor=t,this.channel_sid=t.channel_sid,this.status=t.status,this.channel=t.channel,this.messages=t.messages,this.roster=t.roster,this.lastConsumedMessageIndex=t.last_consumed_message_index,this.notificationLevel=t.notification_level,this.status=t.status}},"40XN":function(e,t,n){"use strict";var i=n("8Y7J"),s=n("SVse"),r=n("y3B+"),o=n("pMoy"),a=n("YEUz"),l=n("omvX"),c=n("s7LF"),u=n("3HBE"),d=n("zQhy"),h=n("CtHx"),p=n("H3DK"),f=n("Q2Ze"),g=n("UhP/"),m=n("9gLZ"),v=n("SCoL"),b=n("e6WT"),y=n("8sFK"),_=n("kMt3"),C=n("iELJ"),w=n("6fQM"),k=n("xv9W"),x=n("zHaW");n.d(t,"a",(function(){return U}));var O=i.xb({encapsulation:0,styles:[["section[_ngcontent-%COMP%]{padding:24px 0 0 24px;height:800px}section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-weight:700;color:#3c3c3c}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:-webkit-box;display:flex;height:calc(100% - 22px)}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]{width:244px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding-right:24px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]   .found-elements-container[_ngcontent-%COMP%]{margin-top:20px;padding-right:24px;height:calc(100% - 100px);overflow:auto}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]   .found-elements-container[_ngcontent-%COMP%]   .found-element[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border-bottom:1px solid #f2f2f2;padding-left:24px;height:40px;font-size:14px;line-height:1;color:#3c3c3c;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]   .found-elements-container[_ngcontent-%COMP%]   .found-element.selected[_ngcontent-%COMP%], section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .finder-container[_ngcontent-%COMP%]   .found-elements-container[_ngcontent-%COMP%]   .found-element[_ngcontent-%COMP%]:hover{background-color:#f2f2f2}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]{border-radius:8px 0 0 8px;width:calc(100% - 244px);box-shadow:0 0 8px 0 rgba(0,0,0,.04)}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]{border-top:1px solid #f2f2f2;border-bottom:1px solid #f2f2f2;height:420px;overflow:auto}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]{padding:16px 24px 24px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #f2f2f2}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:13px;font-weight:700;line-height:1;color:#3c3c3c}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .is-required[_ngcontent-%COMP%]{font-size:12px;font-weight:200;color:#f2a412}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .choose-amount[_ngcontent-%COMP%]{line-height:1;font-size:12px;color:#a8a8a8}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .options-container[_ngcontent-%COMP%]{margin-top:12px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .options-container[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .options-container[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:12px;color:#a8a8a8}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .dishes[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:10px;color:#f44336}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]{padding:16px 24px 0}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .comments[_ngcontent-%COMP%]{width:100%}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .comments[_ngcontent-%COMP%]   text-area[_ngcontent-%COMP%]{height:100px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .amount-container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:start;align-items:flex-start;margin-top:20px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .amount-container[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{padding-top:4px;line-height:1;font-size:14px;color:#3c3c3c}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .amount-container[_ngcontent-%COMP%]   .amount-selector[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:start;align-items:flex-start;margin-left:48px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .amount-container[_ngcontent-%COMP%]   .amount-selector[_ngcontent-%COMP%]   .operator[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;width:20px;height:20px;line-height:1;font-size:20px;color:#f2a412;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .amount-container[_ngcontent-%COMP%]   .amount-selector[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;margin:0 5px;border-bottom:1px solid #f2f2f2;padding-bottom:16px;width:42px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center;margin-top:40px}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:pointer}section[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dishes-selection-container[_ngcontent-%COMP%]   .extra-info[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{margin-left:24px}"]],data:{}});function S(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,3,"div",[["class","found-element"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.getDishDetails(e.context.$implicit.id)&&i),i}),null,null)),i.yb(1,278528,null,0,s.k,[i.t,i.u,i.l,i.F],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(2,{selected:0}),(e()(),i.Xb(3,null,[" "," "]))],(function(e,t){var n=e(t,2,0,t.context.$implicit.id===t.component.selectedDishId);e(t,1,0,"found-element",n)}),(function(e,t){e(t,3,0,t.context.$implicit.name)}))}function M(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,10,"div",[["class","option"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,6,"mat-checkbox",[["class","mat-checkbox"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checkbox-indeterminate",null],[2,"mat-checkbox-checked",null],[2,"mat-checkbox-disabled",null],[2,"mat-checkbox-label-before",null],[2,"_mat-animation-noopable",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,r.b,r.a)),i.yb(2,12763136,null,0,o.c,[i.l,i.h,a.g,i.A,[8,null],[2,o.a],[2,l.a],[2,o.b]],{value:[0,"value"]},null),i.Sb(1024,null,c.q,(function(e){return[e]}),[o.c]),i.yb(4,671744,null,0,c.j,[[3,c.c],[8,null],[8,null],[6,c.q],[2,c.A]],{name:[0,"name"]},null),i.Sb(2048,null,c.r,null,[c.j]),i.yb(6,16384,null,0,c.s,[[4,c.r]],null,null),(e()(),i.Xb(7,0,[" "," "])),(e()(),i.zb(8,0,null,null,2,"p",[["class","price"]],null,null,null,null,null)),(e()(),i.Xb(9,null,[" +$"," "])),i.Rb(10,2)],(function(e,t){e(t,2,0,t.context.$implicit.id),e(t,4,0,"check-"+t.context.$implicit.id)}),(function(e,t){e(t,1,1,[i.Ob(t,2).id,null,i.Ob(t,2).indeterminate,i.Ob(t,2).checked,i.Ob(t,2).disabled,"before"==i.Ob(t,2).labelPosition,"NoopAnimations"===i.Ob(t,2)._animationMode,i.Ob(t,6).ngClassUntouched,i.Ob(t,6).ngClassTouched,i.Ob(t,6).ngClassPristine,i.Ob(t,6).ngClassDirty,i.Ob(t,6).ngClassValid,i.Ob(t,6).ngClassInvalid,i.Ob(t,6).ngClassPending]),e(t,7,0,t.context.$implicit.name);var n=i.Yb(t,9,0,e(t,10,0,i.Ob(t.parent.parent.parent,0),t.context.$implicit.price_in_cents/100,"1.2"));e(t,9,0,n)}))}function P(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,M)),i.yb(2,278528,null,0,s.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.jb(0,null,null,0))],(function(e,t){e(t,2,0,t.parent.context.$implicit.modifiers)}),null)}function T(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,6,"div",[["class","option"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"mat-radio-button",[["class","mat-radio-button"]],[[2,"mat-radio-checked",null],[2,"mat-radio-disabled",null],[2,"_mat-animation-noopable",null],[2,"mat-primary",null],[2,"mat-accent",null],[2,"mat-warn",null],[1,"tabindex",0],[1,"id",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-describedby",0]],[[null,"focus"]],(function(e,t,n){var s=!0;return"focus"===t&&(s=!1!==i.Ob(e,2)._inputElement.nativeElement.focus()&&s),s}),u.b,u.a)),i.yb(2,4440064,[[10,4]],0,d.b,[[2,d.c],i.l,i.h,a.g,h.d,[2,l.a],[2,d.a]],{value:[0,"value"]},null),(e()(),i.Xb(3,0,["",""])),(e()(),i.zb(4,0,null,null,2,"p",[["class","price"]],null,null,null,null,null)),(e()(),i.Xb(5,null,[" +$"," "])),i.Rb(6,2)],(function(e,t){e(t,2,0,t.context.$implicit.id)}),(function(e,t){e(t,1,1,[i.Ob(t,2).checked,i.Ob(t,2).disabled,"NoopAnimations"===i.Ob(t,2)._animationMode,"primary"===i.Ob(t,2).color,"accent"===i.Ob(t,2).color,"warn"===i.Ob(t,2).color,-1,i.Ob(t,2).id,null,null,null]),e(t,3,0,t.context.$implicit.name);var n=i.Yb(t,5,0,e(t,6,0,i.Ob(t.parent.parent.parent,0),t.context.$implicit.price_in_cents/100,"1.2"));e(t,5,0,n)}))}function E(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,8,"mat-radio-group",[["class","mat-radio-group"],["role","radiogroup"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,null,null)),i.yb(2,1064960,null,1,d.c,[i.h],null,null),i.Tb(603979776,10,{_radios:1}),i.Sb(1024,null,c.q,(function(e){return[e]}),[d.c]),i.yb(5,671744,null,0,c.j,[[3,c.c],[8,null],[8,null],[6,c.q],[2,c.A]],{name:[0,"name"]},null),i.Sb(2048,null,c.r,null,[c.j]),i.yb(7,16384,null,0,c.s,[[4,c.r]],null,null),(e()(),i.jb(16777216,null,null,1,null,T)),i.yb(9,278528,null,0,s.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,5,0,"radio-"+t.parent.context.$implicit.id),e(t,9,0,t.parent.context.$implicit.modifiers)}),(function(e,t){e(t,1,0,i.Ob(t,7).ngClassUntouched,i.Ob(t,7).ngClassTouched,i.Ob(t,7).ngClassPristine,i.Ob(t,7).ngClassDirty,i.Ob(t,7).ngClassValid,i.Ob(t,7).ngClassInvalid,i.Ob(t,7).ngClassPending)}))}function I(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[["class","error-message"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,[" No se han elegido correctamente las opciones "]))],null,null)}function R(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,14,"div",[["class","dish"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","header"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"p",[["class","name"]],null,null,null,null,null)),(e()(),i.Xb(3,null,["",""])),(e()(),i.zb(4,0,null,null,1,"p",[["class","is-required"]],null,null,null,null,null)),(e()(),i.Xb(5,null,[" "," "])),(e()(),i.zb(6,0,null,null,1,"p",[["class","choose-amount"]],null,null,null,null,null)),(e()(),i.Xb(7,null,[" (Elige ",") "])),(e()(),i.zb(8,0,null,null,4,"div",[["class","options-container"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,P)),i.yb(10,16384,null,0,s.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,E)),i.yb(12,16384,null,0,s.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,I)),i.yb(14,16384,null,0,s.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,10,0,t.context.$implicit.multiple_option),e(t,12,0,!t.context.$implicit.multiple_option),e(t,14,0,n.submitted&&!n.isGroupCorrect(t.context.$implicit))}),(function(e,t){e(t,3,0,t.context.$implicit.name),e(t,5,0,t.context.$implicit.optional_ask?"Opcional":"Obligatorio"),e(t,7,0,t.context.$implicit.min_options_per_user===t.context.$implicit.max_options_per_user?t.context.$implicit.min_options_per_user:"entre "+t.context.$implicit.min_options_per_user+" y "+t.context.$implicit.max_options_per_user)}))}function j(e){return i.ac(0,[i.Pb(0,s.f,[i.v]),(e()(),i.zb(1,0,null,null,80,"section",[],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"p",[["class","section-title"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,["AGREGAR PLATILLO"])),(e()(),i.zb(4,0,null,null,77,"form",[["class","content"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(e,t,n){var s=!0,r=e.component;return"submit"===t&&(s=!1!==i.Ob(e,6).onSubmit(n)&&s),"reset"===t&&(s=!1!==i.Ob(e,6).onReset()&&s),"ngSubmit"===t&&(s=!1!==r.submit()&&s),s}),null,null)),i.yb(5,16384,null,0,c.B,[],null,null),i.yb(6,540672,null,0,c.l,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),i.Sb(2048,null,c.c,null,[c.l]),i.yb(8,16384,null,0,c.t,[[4,c.c]],null,null),(e()(),i.zb(9,0,null,null,25,"div",[["class","finder-container"]],null,null,null,null,null)),(e()(),i.zb(10,0,null,null,21,"mat-form-field",[["class","mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,p.b,p.a)),i.yb(11,7520256,null,9,f.c,[i.l,i.h,[2,g.f],[2,m.b],[2,f.a],v.a,i.A,[2,l.a]],null,null),i.Tb(603979776,1,{_controlNonStatic:0}),i.Tb(335544320,2,{_controlStatic:0}),i.Tb(603979776,3,{_labelChildNonStatic:0}),i.Tb(335544320,4,{_labelChildStatic:0}),i.Tb(603979776,5,{_placeholderChild:0}),i.Tb(603979776,6,{_errorChildren:1}),i.Tb(603979776,7,{_hintChildren:1}),i.Tb(603979776,8,{_prefixChildren:1}),i.Tb(603979776,9,{_suffixChildren:1}),(e()(),i.zb(21,0,null,3,2,"mat-label",[],null,null,null,null,null)),i.yb(22,16384,[[3,4],[4,4]],0,f.f,[],null,null),(e()(),i.Xb(-1,null,["Buscar platillo..."])),(e()(),i.zb(24,0,null,1,7,"input",[["class","mat-input-element mat-form-field-autofill-control"],["formControlName","search"],["matInput",""]],[[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"focus"]],(function(e,t,n){var s=!0;return"input"===t&&(s=!1!==i.Ob(e,25)._handleInput(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,25).onTouched()&&s),"compositionstart"===t&&(s=!1!==i.Ob(e,25)._compositionStart()&&s),"compositionend"===t&&(s=!1!==i.Ob(e,25)._compositionEnd(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,29)._focusChanged(!1)&&s),"focus"===t&&(s=!1!==i.Ob(e,29)._focusChanged(!0)&&s),"input"===t&&(s=!1!==i.Ob(e,29)._onInput()&&s),s}),null,null)),i.yb(25,16384,null,0,c.d,[i.F,i.l,[2,c.a]],null,null),i.Sb(1024,null,c.q,(function(e){return[e]}),[c.d]),i.yb(27,671744,null,0,c.j,[[3,c.c],[8,null],[8,null],[6,c.q],[2,c.A]],{name:[0,"name"]},null),i.Sb(2048,null,c.r,null,[c.j]),i.yb(29,999424,null,0,b.b,[i.l,v.a,[6,c.r],[2,c.u],[2,c.l],g.b,[8,null],y.a,i.A],null,null),i.yb(30,16384,null,0,c.s,[[4,c.r]],null,null),i.Sb(2048,[[1,4],[2,4]],f.d,null,[b.b]),(e()(),i.zb(32,0,null,null,2,"div",[["class","found-elements-container"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,S)),i.yb(34,278528,null,0,s.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.zb(35,0,null,null,46,"div",[["class","dishes-selection-container"]],null,null,null,null,null)),(e()(),i.zb(36,0,null,null,2,"div",[["class","dishes"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,R)),i.yb(38,278528,null,0,s.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.zb(39,0,null,null,42,"div",[["class","extra-info"]],null,null,null,null,null)),(e()(),i.zb(40,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Comentarios"])),(e()(),i.zb(42,0,null,null,23,"mat-form-field",[["class","comments mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,p.b,p.a)),i.yb(43,7520256,null,9,f.c,[i.l,i.h,[2,g.f],[2,m.b],[2,f.a],v.a,i.A,[2,l.a]],null,null),i.Tb(603979776,11,{_controlNonStatic:0}),i.Tb(335544320,12,{_controlStatic:0}),i.Tb(603979776,13,{_labelChildNonStatic:0}),i.Tb(335544320,14,{_labelChildStatic:0}),i.Tb(603979776,15,{_placeholderChild:0}),i.Tb(603979776,16,{_errorChildren:1}),i.Tb(603979776,17,{_hintChildren:1}),i.Tb(603979776,18,{_prefixChildren:1}),i.Tb(603979776,19,{_suffixChildren:1}),(e()(),i.zb(53,0,null,3,2,"mat-label",[],null,null,null,null,null)),i.yb(54,16384,[[13,4],[14,4]],0,f.f,[],null,null),(e()(),i.Xb(-1,null,["\xbfAlguna petici\xf3n especial?"])),(e()(),i.zb(56,0,null,1,9,"textarea",[["class","mat-input-element mat-form-field-autofill-control"],["formControlName","comments"],["matInput",""],["maxlength","500"]],[[1,"maxlength",0],[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"focus"]],(function(e,t,n){var s=!0;return"input"===t&&(s=!1!==i.Ob(e,59)._handleInput(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,59).onTouched()&&s),"compositionstart"===t&&(s=!1!==i.Ob(e,59)._compositionStart()&&s),"compositionend"===t&&(s=!1!==i.Ob(e,59)._compositionEnd(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,63)._focusChanged(!1)&&s),"focus"===t&&(s=!1!==i.Ob(e,63)._focusChanged(!0)&&s),"input"===t&&(s=!1!==i.Ob(e,63)._onInput()&&s),s}),null,null)),i.yb(57,540672,null,0,c.o,[],{maxlength:[0,"maxlength"]},null),i.Sb(1024,null,c.p,(function(e){return[e]}),[c.o]),i.yb(59,16384,null,0,c.d,[i.F,i.l,[2,c.a]],null,null),i.Sb(1024,null,c.q,(function(e){return[e]}),[c.d]),i.yb(61,671744,null,0,c.j,[[3,c.c],[6,c.p],[8,null],[6,c.q],[2,c.A]],{name:[0,"name"]},null),i.Sb(2048,null,c.r,null,[c.j]),i.yb(63,999424,null,0,b.b,[i.l,v.a,[6,c.r],[2,c.u],[2,c.l],g.b,[8,null],y.a,i.A],null,null),i.yb(64,16384,null,0,c.s,[[4,c.r]],null,null),i.Sb(2048,[[11,4],[12,4]],f.d,null,[b.b]),(e()(),i.zb(66,0,null,null,9,"div",[["class","amount-container"]],null,null,null,null,null)),(e()(),i.zb(67,0,null,null,1,"p",[["class","quantity"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Cantidad"])),(e()(),i.zb(69,0,null,null,6,"div",[["class","amount-selector"]],null,null,null,null,null)),(e()(),i.zb(70,0,null,null,1,"p",[["class","operator"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.changeAmountByOne("subtract")&&i),i}),null,null)),(e()(),i.Xb(-1,null,["-"])),(e()(),i.zb(72,0,null,null,1,"p",[["class","amount"]],null,null,null,null,null)),(e()(),i.Xb(73,null,["",""])),(e()(),i.zb(74,0,null,null,1,"p",[["class","operator"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.changeAmountByOne("add")&&i),i}),null,null)),(e()(),i.Xb(-1,null,["+"])),(e()(),i.zb(76,0,null,null,5,"div",[["class","controls"]],null,null,null,null,null)),(e()(),i.zb(77,0,null,null,1,"p",[],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeDialog(!1)&&i),i}),null,null)),(e()(),i.Xb(-1,null,["Cancelar"])),(e()(),i.zb(79,0,null,null,2,"button",[["class","btns"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.submit()&&i),i}),null,null)),(e()(),i.zb(80,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Aceptar"]))],(function(e,t){var n=t.component;e(t,6,0,n.form),e(t,27,0,"search"),e(t,29,0),e(t,34,0,n.dishes),e(t,38,0,n.groupModifiers),e(t,57,0,"500"),e(t,61,0,"comments"),e(t,63,0)}),(function(e,t){var n=t.component;e(t,4,0,i.Ob(t,8).ngClassUntouched,i.Ob(t,8).ngClassTouched,i.Ob(t,8).ngClassPristine,i.Ob(t,8).ngClassDirty,i.Ob(t,8).ngClassValid,i.Ob(t,8).ngClassInvalid,i.Ob(t,8).ngClassPending),e(t,10,1,["standard"==i.Ob(t,11).appearance,"fill"==i.Ob(t,11).appearance,"outline"==i.Ob(t,11).appearance,"legacy"==i.Ob(t,11).appearance,i.Ob(t,11)._control.errorState,i.Ob(t,11)._canLabelFloat,i.Ob(t,11)._shouldLabelFloat(),i.Ob(t,11)._hasFloatingLabel(),i.Ob(t,11)._hideControlPlaceholder(),i.Ob(t,11)._control.disabled,i.Ob(t,11)._control.autofilled,i.Ob(t,11)._control.focused,"accent"==i.Ob(t,11).color,"warn"==i.Ob(t,11).color,i.Ob(t,11)._shouldForward("untouched"),i.Ob(t,11)._shouldForward("touched"),i.Ob(t,11)._shouldForward("pristine"),i.Ob(t,11)._shouldForward("dirty"),i.Ob(t,11)._shouldForward("valid"),i.Ob(t,11)._shouldForward("invalid"),i.Ob(t,11)._shouldForward("pending"),!i.Ob(t,11)._animationsEnabled]),e(t,24,1,[i.Ob(t,29)._isServer,i.Ob(t,29).id,i.Ob(t,29).placeholder,i.Ob(t,29).disabled,i.Ob(t,29).required,i.Ob(t,29).readonly&&!i.Ob(t,29)._isNativeSelect||null,i.Ob(t,29)._ariaDescribedby||null,i.Ob(t,29).errorState,i.Ob(t,29).required.toString(),i.Ob(t,30).ngClassUntouched,i.Ob(t,30).ngClassTouched,i.Ob(t,30).ngClassPristine,i.Ob(t,30).ngClassDirty,i.Ob(t,30).ngClassValid,i.Ob(t,30).ngClassInvalid,i.Ob(t,30).ngClassPending]),e(t,42,1,["standard"==i.Ob(t,43).appearance,"fill"==i.Ob(t,43).appearance,"outline"==i.Ob(t,43).appearance,"legacy"==i.Ob(t,43).appearance,i.Ob(t,43)._control.errorState,i.Ob(t,43)._canLabelFloat,i.Ob(t,43)._shouldLabelFloat(),i.Ob(t,43)._hasFloatingLabel(),i.Ob(t,43)._hideControlPlaceholder(),i.Ob(t,43)._control.disabled,i.Ob(t,43)._control.autofilled,i.Ob(t,43)._control.focused,"accent"==i.Ob(t,43).color,"warn"==i.Ob(t,43).color,i.Ob(t,43)._shouldForward("untouched"),i.Ob(t,43)._shouldForward("touched"),i.Ob(t,43)._shouldForward("pristine"),i.Ob(t,43)._shouldForward("dirty"),i.Ob(t,43)._shouldForward("valid"),i.Ob(t,43)._shouldForward("invalid"),i.Ob(t,43)._shouldForward("pending"),!i.Ob(t,43)._animationsEnabled]),e(t,56,1,[i.Ob(t,57).maxlength?i.Ob(t,57).maxlength:null,i.Ob(t,63)._isServer,i.Ob(t,63).id,i.Ob(t,63).placeholder,i.Ob(t,63).disabled,i.Ob(t,63).required,i.Ob(t,63).readonly&&!i.Ob(t,63)._isNativeSelect||null,i.Ob(t,63)._ariaDescribedby||null,i.Ob(t,63).errorState,i.Ob(t,63).required.toString(),i.Ob(t,64).ngClassUntouched,i.Ob(t,64).ngClassTouched,i.Ob(t,64).ngClassPristine,i.Ob(t,64).ngClassDirty,i.Ob(t,64).ngClassValid,i.Ob(t,64).ngClassInvalid,i.Ob(t,64).ngClassPending]),e(t,73,0,n.form.get("amount").value),e(t,79,0,!n.selectedDishId)}))}function N(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-add-dish-to-order",[],null,null,null,j,O)),i.yb(1,114688,null,0,_.a,[C.a,C.j,w.a,k.a,c.g,x.b],null,null)],(function(e,t){e(t,1,0)}),null)}var U=i.vb("app-add-dish-to-order",_.a,N,{},{},[])},"40oJ":function(e,t,n){var i=n("ixoo")("meta"),s=n("ekG2"),r=n("nA4W"),o=n("GhSp").f,a=0,l=Object.isExtensible||function(){return!0},c=!n("S4vA")((function(){return l(Object.preventExtensions({}))})),u=function(e){o(e,i,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,i)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[i].i},getWeak:function(e,t){if(!r(e,i)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[i].w},onFreeze:function(e){return c&&d.NEED&&l(e)&&!r(e,i)&&u(e),e}}},"43rs":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("f9CJ"),s=n("qzTf"),r=n("OnFN");t.Media=r.Media,t.McsMedia=r.Media;const o=n("V86R"),a=n("3dc8"),l=i.Logger.scope(""),c=n("ZdHh").version,u="A valid Twilio token should be provided";class d{constructor(e,t,n={}){if(this.options=n,this.options.logLevel=this.options.logLevel||"silent",this.config=new s.Configuration(e,t,this.options),!e)throw new Error(u);l.setLevel(this.options.logLevel),this.options.transport=this.options.transport||new o.Transport,this.transport=this.options.transport,this.network=new a.Network(this.config,this.transport)}updateToken(e){if(l.info("updateToken"),!e)throw new Error(u);this.config.updateToken(e)}async get(e){let t=await this.network.get(`${this.config.baseUrl}/${e}`);return new r.Media(this.config,this.network,t.body)}async post(e,t){let n=await this.network.post(this.config.baseUrl,t,e);return new r.Media(this.config,this.network,n.body)}async postFormData(e){let t=await this.network.post(this.config.baseUrl,e);return new r.Media(this.config,this.network,t.body)}}t.Client=d,t.McsClient=d,d.version=c,t.default=d},"4Zg2":function(e,t,n){var i=n("7whZ"),s=n("VSTI"),r=n("5ETA"),o=n("/NTb"),a=n("GhSp").f;e.exports=function(e){var t=s.Symbol||(s.Symbol=r?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:o.f(e)})}},"4d7F":function(e,t,n){e.exports={default:n("Ir+t"),__esModule:!0}},"4dLj":function(e,t,n){"use strict";var i=r(n("iCc5")),s=r(n("V7oC"));function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserDescriptor=void 0;var o=n("yC9A"),a=n("iqZd"),l=o.Logger.scope("UserDescriptor"),c=function(){function e(t,n){(0,i.default)(this,e),this.services=t,this.descriptor=n,this.identity=n.identity,this.friendlyName=n.friendly_name,this.attributes=a.parseAttributes(n.attributes,"Failed to parse user attributes",l),this.online=n.is_online,this.notifiable=n.is_notifiable}return(0,s.default)(e,[{key:"subscribe",value:function(){return this.services.users.getUser(this.identity,this.descriptor.sync_unique_name)}},{key:"_getDescriptor",value:function(){return this.descriptor}}]),e}();t.UserDescriptor=c},"4fRq":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},"4xVT":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TreeMap=void 0;class i{constructor(e,t){this.balanceFactor=0,this.key=e,this.value=t,this.parent=null,this.left=null,this.right=null}get isRoot(){return null===this.parent}get isLeaf(){return null===this.left&&null===this.right}get isLeftChild(){return this.parent.left===this}update(e){this.value=e}replace(e,t){e&&(this.left===t?this.left=t:this.right===t&&(this.right=t))}}t.TreeMap=class{constructor(e,t){this.isLessThan=e||((e,t)=>e<t),this.isEqual=t||((e,t)=>e===t),this.root=null,this.count=null}get size(){return this.count}clear(){this.root=null,this.count=0}set(e,t){let n=this.getNode(e);n?n.update(t):this.insert(e,t)}insert(e,t){let n=new i(e,t);if(this.count++,!this.root)return void(this.root=n);let s=this.root;for(;;)if(this.isLessThan(e,s.key)){if(!s.left){s.left=n;break}s=s.left}else{if(!s.right){s.right=n;break}s=s.right}for(n.parent=s,s=n;s.parent;){let e=s.parent,t=e.balanceFactor;if(s.isLeftChild?e.balanceFactor++:e.balanceFactor--,Math.abs(e.balanceFactor)<Math.abs(t))break;if(e.balanceFactor<-1||e.balanceFactor>1){this.rebalance(e);break}s=e}}get(e){let t=this.root;for(;t;){if(this.isEqual(e,t.key))return t.value;t=this.isLessThan(e,t.key)?t.left:t.right}return null}delete(e){let t=this.getNode(e);if(!t||t.key!==e)return null;let n=t.parent,i=t.left,s=t.right;if(!!i!=!!s){let e=i||s;n||e?n&&!e?this.root=e:(n.replace(t,null),this.rebalance(n)):this.root=null}else{let e=t.left;for(;e.right;)e=e.right;if(t.left===e)t.isRoot?(this.root=e,e.parent=null):(t.isLeftChild?t.parent.left=e:t.parent.right=e,e.parent=t.parent),e.right=t.right,e.right.parent=e,e.balanceFactor=t.balanceFactor,t={parent:e,isLeftChild:!0};else{let n=e.parent,i=e.left;n.right=i,i&&(i.parent=n),t.isRoot?(this.root=e,e.parent=null):(t.isLeftChild?t.parent.left=e:t.parent.right=e,e.parent=t.parent),e.right=t.right,e.right.parent=e,e.left=t.left,e.left.parent=e,e.balanceFactor=t.balanceFactor,t={parent:n,isLeftChild:!1}}}for(this.count--;t.parent;){let e=t.parent,n=e.balanceFactor;if(t.isLeftChild?e.balanceFactor-=1:e.balanceFactor+=1,Math.abs(e.balanceFactor)>Math.abs(n)){if(!(e.balanceFactor<-1||e.balanceFactor>1))break;if(this.rebalance(e),0!==e.parent.balanceFactor)break;t=e.parent}else t=e}return null}getNode(e){let t=this.root;for(;t;){if(this.isEqual(e,t.key))return t;t=this.isLessThan(e,t.key)?t.left:t.right}return null}rebalance(e){e.balanceFactor<0?e.right.balanceFactor>0?(this.rotateRight(e.right),this.rotateLeft(e)):this.rotateLeft(e):e.balanceFactor>0&&(e.left.balanceFactor<0?(this.rotateLeft(e.left),this.rotateRight(e)):this.rotateRight(e))}rotateLeft(e){let t=e.right;e.right=t.left,null!==t.left&&(t.left.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.left=e,e.parent=t,e.balanceFactor=e.balanceFactor+1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor+1-Math.max(e.balanceFactor,0)}rotateRight(e){let t=e.left;e.left=t.right,null!==t.right&&(t.right.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.right=e,e.parent=t,e.balanceFactor=e.balanceFactor-1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor-1-Math.max(e.balanceFactor,0)}*[Symbol.iterator](){for(let e of this.getIterator())yield e}*getIterator(e=null){let t=this.root;for(;t&&!this.isEqual(e,t.key)&&(null!==e||t.left);)t=this.isLessThan(e,t.key)||null===e?t.left:t.right;if(!t)return null;let n=!0;for(;;)if(n)if(yield[t.key,t.value],n=!1,t.right){for(t=t.right;t.left;)t=t.left;n=!0}else{if(!t.parent)break;n=t.parent.left===t,t=t.parent}else{if(!t.parent)break;n=t.parent.left===t,t=t.parent}return null}*getReverseIterator(e=null){let t=this.root;for(;t&&!this.isEqual(e,t.key)&&(null!==e||t.right);)t=this.isLessThan(e,t.key)&&null!==e?t.left:t.right;if(!t)return null;let n=!0;for(;;)if(n)if(yield[t.key,t.value],n=!1,t.left){for(t=t.left;t.right;)t=t.right;n=!0}else{if(!t.parent)break;n=t.parent.right===t,t=t.parent}else{if(!t.parent)break;n=t.parent.right===t,t=t.parent}return null}}},5:function(e,t){},"5DEo":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Init=void 0;const i=n("NDb0");t.Init=class extends i.AbstractMessage{constructor(e,t,n,i=null,s=null){super(),this.method="init",this.token=e,this.continuation_token=t,this.metadata=n,this.registrations=i,this.tweaks=s,this.capabilities=["client_update","offline_storage","telemetry.v1"]}}},"5ETA":function(e,t){e.exports=!0},"5K/K":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registrations=void 0;const i=n("uShU"),s=n("+qE3"),r=n("EcEN"),o=n("7FP+");t.Registrations=class extends s.EventEmitter{constructor(e){super(),this.transport=e,this.registrations=new Map,this.registrationsInProgress=new Map}async putNotificationContext(e,t){const n={method:"put_notification_ctx",notification_ctx_id:e};await this.transport.sendWithReply(n,t)}async deleteNotificationContext(e){let t={method:"delete_notification_ctx",notification_ctx_id:e};await this.transport.sendWithReply(t)}async updateRegistration(e,t){i.log.debug("update registration for context",e);let n=this.registrationsInProgress.get(e);n||(n=new Set,this.registrationsInProgress.set(e,n));const s=r.v4();n.add(s);try{await this.putNotificationContext(e,t),i.log.debug("registration attempt succeeded for context",t),n.delete(s),0===n.size&&(this.registrationsInProgress.delete(e),this.emit("registered",e))}catch(o){i.log.warn("registration attempt failed for context",t),i.log.debug(o),n.delete(s),0===n.size&&(this.registrationsInProgress.delete(e),this.emit("registrationFailed",e,o))}}updateRegistrations(){i.log.trace(`refreshing ${this.registrations.size} registrations`),this.registrations.forEach((e,t)=>{this.updateRegistration(t,e)})}setNotificationsContext(e,t){if(!e||!t)throw new o.TwilsockError("Invalid arguments provided");this.registrations.set(e,t),this.transport.isConnected&&this.updateRegistration(e,t)}async removeNotificationsContext(e){this.registrations.has(e)&&(await this.deleteNotificationContext(e),this.transport.isConnected&&this.registrations.delete(e))}}},"5Qd4":function(e,t,n){var i=n("USwo");i(i.S+i.F,"Object",{assign:n("By1P")})},"5m62":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["weeks","years","months","days","hours","minutes","seconds"],s=Object.freeze({years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0}),r=t.pattern=new RegExp("P(?:(\\d+(?:[\\.,]\\d+)?W)|(\\d+(?:[\\.,]\\d+)?Y)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?D)?(?:T(\\d+(?:[\\.,]\\d+)?H)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?S)?)?)"),o=t.parse=function(e){return e.match(r).slice(1).reduce((function(e,t,n){return e[i[n]]=parseFloat(t)||0,e}),{})},a=t.end=function(e,t){e=Object.assign({},s,e);var n=t?t.getTime():Date.now(),i=new Date(n);return i.setFullYear(i.getFullYear()+e.years),i.setMonth(i.getMonth()+e.months),i.setDate(i.getDate()+e.days),i.setHours(i.getHours()+e.hours),i.setMinutes(i.getMinutes()+e.minutes),i.setMilliseconds(i.getMilliseconds()+1e3*e.seconds),i.setDate(i.getDate()+7*e.weeks),i},l=t.toSeconds=function(e,t){e=Object.assign({},s,e);var n=t?t.getTime():Date.now(),i=new Date(n);return(a(e,i).getTime()-i.getTime())/1e3};t.default={end:a,toSeconds:l,pattern:r,parse:o}},"5w6Y":function(e,t,n){var i=n("CYMq"),s=n("mHY4");n("czaS")("keys",(function(){return function(e){return s(i(e))}}))},6:function(e,t){},"6efB":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Twilsock=t.TwilsockClient=t.TelemetryEvents=void 0;const i=n("+qE3"),s=n("uShU"),r=n("Sxqd"),o=n("CFWb"),a=n("OxZ0"),l=n("0KpA"),c=n("5K/K"),u=n("C01u"),d=n("hLxu"),h=n("7FP+"),p=n("/S/1"),f=n("SGKw"),g=n("BPEz");class m{}t.TelemetryEvents=m,m.TWILSOCK_CONNECT="twilsock.sdk.connect",m.TWILSOCK_INIT="twilsock.sdk.init";class v extends i.EventEmitter{constructor(e,t,n={}){super(),this.offlineStorageDeferred=new d.Deferred,n.continuationToken=n.continuationToken?n.continuationToken:f.TokenStorage.getStoredToken(t);let i=this.config=new r.Configuration(e,t,n);s.log.setLevel(i.logLevel);let p=new l.WebSocketChannel(i.url),v=n.transport?n.transport:new a.PacketInterface(p,i);this.channel=n.channel?n.channel:new o.TwilsockImpl(p,v,i),this.registrations=n.registrations?n.registrations:new c.Registrations(v),this.upstream=new u.Upstream(v,this.channel,i),this.telemetryTracker=new g.TelemetryTracker(i,v),this.channel.on("initialized",()=>this.telemetryTracker.canSendTelemetry=!0),p.on("disconnected",()=>this.telemetryTracker.canSendTelemetry=!1),this.registrations.on("registered",e=>this.emit("registered",e)),this.channel.on("message",(e,t)=>setTimeout(()=>this.emit("message",e,t),0)),this.channel.on("stateChanged",e=>setTimeout(()=>this.emit("stateChanged",e),0)),this.channel.on("connectionError",e=>setTimeout(()=>this.emit("connectionError",e),0)),this.channel.on("tokenAboutToExpire",()=>setTimeout(()=>this.emit("tokenAboutToExpire"),0)),this.channel.on("tokenExpired",()=>setTimeout(()=>this.emit("tokenExpired"),0)),this.channel.on("connected",()=>this.registrations.updateRegistrations()),this.channel.on("connected",()=>this.upstream.sendPendingMessages()),this.channel.on("connected",()=>setTimeout(()=>this.emit("connected"),0)),this.channel.on("beforeConnect",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Establish WebSocket connection","",new Date),m.TWILSOCK_CONNECT,g.TelemetryPoint.Start)),this.channel.on("connected",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Establish WebSocket connection","",new Date,new Date),m.TWILSOCK_CONNECT,g.TelemetryPoint.End)),this.channel.on("beforeSendInit",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","",new Date),m.TWILSOCK_INIT,g.TelemetryPoint.Start)),this.channel.on("initialized",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","Succeeded",new Date,new Date),m.TWILSOCK_INIT,g.TelemetryPoint.End)),this.channel.on("sendInitFailed",()=>this.telemetryTracker.addPartialEvent(new g.TelemetryEventDescription("Send Twilsock init","Failed",new Date,new Date),m.TWILSOCK_INIT,g.TelemetryPoint.End)),this.channel.on("initialized",e=>{this.handleStorageId(t,e),f.TokenStorage.storeToken(e.continuationToken,t),setTimeout(()=>this.emit("initialized",e),0)}),this.channel.on("disconnected",()=>setTimeout(()=>this.emit("disconnected"),0)),this.channel.on("disconnected",()=>this.upstream.rejectPendingMessages()),this.channel.on("disconnected",()=>this.offlineStorageDeferred.fail(new h.TwilsockError("Client disconnected"))),this.offlineStorageDeferred.promise.catch(()=>{})}emit(e,...t){return s.log.debug(`Emitting ${e.toString()}(${t.map(e=>JSON.stringify(e)).join(", ")})`),super.emit(e,...t)}handleStorageId(e,t){if(t.offlineStorage)if(t.offlineStorage.hasOwnProperty(e))try{this.offlineStorageDeferred.set(p.OfflineProductStorage.create(t.offlineStorage[e])),s.log.debug(`Offline storage for '${e}' product: ${JSON.stringify(t.offlineStorage[e])}.`)}catch(n){this.offlineStorageDeferred.fail(new h.TwilsockError(`Failed to parse offline storage for ${e} ${JSON.stringify(t.offlineStorage[e])}. ${n}.`))}else this.offlineStorageDeferred.fail(new h.TwilsockError(`No offline storage id for '${e}' product: ${JSON.stringify(t.offlineStorage)}`));else this.offlineStorageDeferred.fail(new h.TwilsockError("No offline storage id"))}storageId(){return this.offlineStorageDeferred.promise}get isConnected(){return this.channel.isConnected}get state(){return this.channel.state}async updateToken(e){if(s.log.trace(`updating token '${e}'`),this.config.token!==e)return this.config.updateToken(e),this.channel.updateToken(e)}setNotificationsContext(e,t){this.registrations.setNotificationsContext(e,t)}removeNotificationsContext(e){this.registrations.removeNotificationsContext(e)}connect(){return this.channel.connect()}disconnect(){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEventsIncludingUnfinished),this.channel.disconnect()}get(e,t){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("GET",e,t)}post(e,t,n){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("POST",e,t,n)}put(e,t,n){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("PUT",e,t,n)}delete(e,t){return this.telemetryTracker.sendTelemetry(g.EventSendingLimitation.AnyEvents),this.upstream.send("DELETE",e,t)}addTelemetryEvent(e){this.telemetryTracker.addTelemetryEvent(e),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}addPartialTelemetryEvent(e,t,n){this.telemetryTracker.addPartialEvent(e,t,n),n===g.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}t.TwilsockClient=v,t.Twilsock=v},"6fQM":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AytR"),s=n("HDdC"),r=n("8Y7J"),o=n("IheW");let a=(()=>{class e{constructor(e){this.http=e}searchDishes(e,t){if(t){const n=i.a.SEARCH_DISHES.replace("{restaurantId}",e.toString()).replace("{search}",t);return this.http.get(n)}return new s.a(e=>{e.next({results:[]}),e.complete()})}getDishDetails(e){const t=i.a.GET_DISH_DETAILS.replace("{dishId}",e.toString());return this.http.get(t)}addProductToOrder(e,t){const n=i.a.ODERS_DISHES.replace("{orderId}",e.toString());return this.http.post(n,t)}removeDishFromOrder(e,t){const n=i.a.ORDERS_DISHES_DETAILS.replace("{orderId}",e.toString()).replace("{dishId}",t);return this.http.delete(n)}closeReservation(e,t){const n=i.a.CLOSE_RESERVATION.replace("{reservationId}",e.toString());return this.http.post(n,t)}}return e.\u0275prov=r.bc({factory:function(){return new e(r.cc(o.c))},token:e,providedIn:"root"}),e})()},"6jRP":function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},"6quN":function(e,t,n){"use strict";var i=a(n("14Xm")),s=a(n("D3Ub")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PublicChannels=void 0;var l=n("iqZd"),c=n("IMt4"),u=n("k1+U"),d=function(){function e(t,n,i){(0,r.default)(this,e),this.client=t,this.services=n,this.url=i}var t,n,a;return(0,o.default)(e,[{key:"getChannels",value:(a=(0,s.default)(i.default.mark((function e(){var t,n,s=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.UriBuilder(this.url).arg("PageToken",r.pageToken).build(),e.next=3,this.services.network.get(t);case 3:return e.abrupt("return",new c.RestPaginator((n=e.sent).body.channels.map((function(e){return new u.ChannelDescriptor(s.client,e)})),(function(e){return s.getChannels({pageToken:e})}),n.body.meta.previous_token,n.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getChannelBySid",value:(n=(0,s.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new u.ChannelDescriptor(this.client,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getChannelByUniqueName",value:(t=(0,s.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new u.ChannelDescriptor(this.client,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.PublicChannels=d},"6r7x":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0,t.Configuration=class{constructor(e={}){const t=e.cdsUri||`https://cds.${e.region||"us1"}.twilio.com`;var n,i;this.settings={subscriptionsUri:t+"/v4/Subscriptions",documentsUri:t+"/v3/Documents",listsUri:t+"/v3/Lists",mapsUri:t+"/v3/Maps",streamsUri:t+"/v3/Streams",insightsUri:t+"/v3/Insights",sessionStorageEnabled:(n=e.Sync,i="enableSessionStorage",!n||void 0===n[i]||n[i]),productId:e.productId}}get subscriptionsUri(){return this.settings.subscriptionsUri}get documentsUri(){return this.settings.documentsUri}get listsUri(){return this.settings.listsUri}get mapsUri(){return this.settings.mapsUri}get streamsUri(){return this.settings.streamsUri}get insightsUri(){return this.settings.insightsUri}get backoffConfig(){return this.settings.backoffConfig||{}}get sessionStorageEnabled(){return this.settings.sessionStorageEnabled}get productId(){return this.settings.productId}}},"6w5q":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Init=void 0;const i=n("PmLG");t.Init=class extends i.AbstractMessage{constructor(e,t,n,i=null,s=null){super(),this.method="init",this.token=e,this.continuation_token=t,this.metadata=n,this.registrations=i,this.tweaks=s,this.capabilities=["client_update","offline_storage","telemetry.v1"]}}},7:function(e,t){},"72j5":function(e,t,n){"use strict";var i,s=(i=n("iCc5"))&&i.__esModule?i:{default:i};Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseCodes=void 0;var r=function e(){(0,s.default)(this,e)};t.ResponseCodes=r,r.HTTP_200_OK=200,r.HTTP_400_BAD_REQUEST=400,r.HTTP_404_NOT_FOUND=404,r.ACCESS_FORBIDDEN_FOR_IDENTITY=54007,r.LIST_NOT_FOUND=54150},"7FP+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockError=void 0;class i extends Error{constructor(e){super(e)}}t.TwilsockError=i},"7whZ":function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"8sL3":function(e,t,n){"use strict";var i=n("FgkJ");function s(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new s(e)}},"9y9p":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;const i=n("4xVT");class s{constructor(e,t){this.value=e,this.revision=t||0}get isValid(){return!0}}class r{constructor(e){this.revision=e}get isValid(){return!1}}class o{constructor(){this.items=new i.TreeMap}store(e,t,n){let i=this.items.get(e);return i&&i.revision>n?i.isValid?i.value:null:(this.items.set(e,new s(t,n)),t)}delete(e,t,n=!1){let i=this.items.get(e);(!i||i.revision<t||i&&!0===n)&&this.items.set(e,new r(t))}isKnown(e,t){let n=this.items.get(e);return n&&n.revision>=t}get(e){let t=this.items.get(e);return t&&t.isValid?t.value:null}has(e){let t=this.items.get(e);return t&&t.isValid}forEach(e){if(this.items)for(let[t,n]of this.items)n.isValid&&e(t,n.value)}}t.Cache=o,t.default=o},A9a0:function(e,t,n){var i=n("nA4W"),s=n("bKEA"),r=n("Oa1h")(!1),o=n("WpRT")("IE_PROTO");e.exports=function(e,t){var n,a=s(e),l=0,c=[];for(n in a)n!=o&&i(a,n)&&c.push(n);for(;t.length>l;)i(a,n=t[l++])&&(~r(c,n)||c.push(n));return c}},ASGO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstantQuery=t.LiveQuery=t.queryItems=t.LiveQueryImpl=t.InsightsItem=void 0;const i=n("v2fs"),s=n("PyJ+"),r=n("PalJ"),o=n("+qE3"),a=n("BUbV"),l=n("PEWQ"),c=n("9y9p");t.InsightsItem=class{};class u extends a.SyncEntity{constructor(e,t,n,i){super(t,n),this.descriptor=e,this.cache=new c.Cache,i&&i.forEach(e=>{this.cache.store(e.key,{key:e.key,value:e.data},e.revision)})}get sid(){return this.descriptor.sid}get uniqueName(){return null}get type(){return u.type}static get type(){return"live_query"}get lastEventId(){return this.descriptor.last_event_id}get indexName(){return this.descriptor.indexName}get queryString(){return this.descriptor.queryExpression}get queryUri(){return this.descriptor.queryUri}get liveQueryDescriptor(){return this.descriptor}onRemoved(){}getItems(){const e={};return this.cache.forEach((t,n)=>{e[t]=n.value}),e}_update(e,t){switch(e.type){case"live_query_item_updated":this.handleItemMutated(e.item_key,e.item_data,e.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(e.item_key,e.item_revision);break;case"live_query_updated":this.handleBatchUpdate(e.items)}t&&this._advanceLastEventId(e.last_event_id)}handleItemMutated(e,t,n){if(this.shouldIgnoreEvent(e,n))r.default.trace(`Item ${e} update skipped, revision: ${n}`);else{const i={key:e,value:t};this.cache.store(e,i,n),this.broadcastEventToListeners("itemUpdated",i)}}handleItemRemoved(e,t){const n=null===t;this.shouldIgnoreEvent(e,t)?r.default.trace(`Item ${e} delete skipped, revision: ${t}`):(this.cache.delete(e,t,n),this.broadcastEventToListeners("itemRemoved",{key:e}))}handleBatchUpdate(e){let t={};null!=e&&e.forEach(e=>{t[e.key]={data:e.data,revision:e.revision}}),this.cache.forEach((e,n)=>{const i=t[e];null!=i?this.handleItemMutated(e,i.data,i.revision):this.handleItemRemoved(e,null),delete t[e]});for(let n in t)this.handleItemMutated(n,t[n].data,t[n].revision)}shouldIgnoreEvent(e,t){return null!=e&&null!=t&&this.cache.isKnown(e,t)}_advanceLastEventId(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e)}}async function d(e){let{network:t,queryString:n,uri:i,type:r}=e;if(null==n)throw new s.SyncError("Invalid query",400,54507);const o={query_string:n};return r===h.type&&(o.type=r),(await t.post(i,o,void 0,!0)).body}t.LiveQueryImpl=u,t.queryItems=d;class h extends l.Closeable{constructor(e){super(),this.liveQueryImpl=e,this.liveQueryImpl.attach(this)}static get type(){return u.type}get type(){return u.type}get lastEventId(){return this.liveQueryImpl.lastEventId}get sid(){return this.liveQueryImpl.sid}close(){super.close(),this.liveQueryImpl.detach(this.listenerUuid)}getItems(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}t.LiveQuery=h;class p extends o.EventEmitter{constructor(e){super(),this.queryExpression=null,this.items={},Object.assign(this,e),this.updateIndexName(e.indexName)}static get type(){return"instant_query"}get type(){return p.type}async search(e){return this.items={},d({network:this.network,uri:this.queryUri,queryString:e}).then(t=>{this.queryExpression=e,t.items&&t.items.forEach(e=>{this.items[e.key]=e.data}),this.emit("searchResult",this.getItems())}).catch(t=>{throw r.default.error(`Error '${t.message}' while executing query '${e}'`),this.queryExpression=null,t})}async subscribe(){return null==this.queryExpression?Promise.reject(new s.SyncError("Invalid query",400,54507)):this.liveQueryCreator(this.indexName,this.queryExpression)}getItems(){return this.items}updateIndexName(e){if(!e||"string"!=typeof e)throw new Error("Index name must contain a non-empty string value");this.indexName=e,this.queryUri=this.generateQueryUri(this.indexName)}generateQueryUri(e){return new i.UriBuilder(this.insightsUri).pathSegment(e).pathSegment("Items").build()}}t.InstantQuery=p,t.default=h},AjXP:function(e,t,n){var i=n("wlNh");e.exports=function(e,t){var n=[];return i(e,!1,n.push,n,t),n}},AqBG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockConnector=void 0;const i=n("EcEN"),s=n("3Lba");t.TwilsockConnector=class extends s.Connector{constructor(e,t,n){super(n),this.twilsock=t,this.context=e,e.id=i.v4(),this.twilsock.on("stateChanged",e=>{"connected"!==e&&this.emit("transportReady",!1)}),this.twilsock.on("registered",n=>{e&&n===e.id&&"connected"===t.state&&this.emit("transportReady",!0)})}setNotificationId(...e){}updateToken(e){}async updateContextRequest(e){let t={product_id:this.context.productId,notification_protocol_version:4,endpoint_platform:this.context.platform,message_types:e};this.emit("transportReady",!1),await this.twilsock.setNotificationsContext(this.context.id,t)}async updateRegistration(e,t){if(t.has("messageType"))return await this.updateContextRequest(Array.from(e.messageTypes)),e}removeRegistration(){return this.twilsock.removeNotificationsContext(this.context.id)}}},AyUB:function(e,t,n){e.exports={default:n("vNbC"),__esModule:!0}},B0QU:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a}));var i=n("8Y7J"),s=n("PqYM");class r{constructor(){this.class="",this.backgroundGradient=!1,this.backgroundColor="transparent",this.backgroundGradientStopColor="transparent",this.backgroundOpacity=1,this.backgroundStroke="transparent",this.backgroundStrokeWidth=0,this.backgroundPadding=5,this.percent=0,this.radius=90,this.space=4,this.toFixed=0,this.maxPercent=1e3,this.renderOnClick=!0,this.units="%",this.unitsFontSize="10",this.unitsFontWeight="normal",this.unitsColor="#444444",this.outerStrokeGradient=!1,this.outerStrokeWidth=8,this.outerStrokeColor="#78C000",this.outerStrokeGradientStopColor="transparent",this.outerStrokeLinecap="round",this.innerStrokeColor="#C7E596",this.innerStrokeWidth=4,this.titleFormat=void 0,this.title="auto",this.titleColor="#444444",this.titleFontSize="20",this.titleFontWeight="normal",this.subtitleFormat=void 0,this.subtitle="progress",this.subtitleColor="#A9A9A9",this.subtitleFontSize="10",this.subtitleFontWeight="normal",this.imageSrc=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.animation=!0,this.animateTitle=!0,this.animateSubtitle=!1,this.animationDuration=500,this.showTitle=!0,this.showSubtitle=!0,this.showUnits=!0,this.showImage=!1,this.showBackground=!0,this.showInnerStroke=!0,this.clockwise=!0,this.responsive=!1,this.startFromZero=!0,this.showZeroOuterStroke=!0,this.lazy=!1}}class o{constructor(e,t,n){this.elRef=t,this.document=n,this.onClick=new i.o,this.svgElement=null,this.isInViewport=!1,this.onViewportChanged=new i.o,this._viewportChangedSubscriber=null,this.options=new r,this.defaultOptions=new r,this._lastPercent=0,this._gradientUUID=null,this.render=()=>{this.applyOptions(),this.options.lazy?(null===this.svgElement&&this.draw(this._lastPercent),this.isInViewport&&(this.options.animation&&this.options.animationDuration>0?this.animate(this._lastPercent,this.options.percent):this.draw(this.options.percent),this._lastPercent=this.options.percent)):(this.options.animation&&this.options.animationDuration>0?this.animate(this._lastPercent,this.options.percent):this.draw(this.options.percent),this._lastPercent=this.options.percent)},this.polarToCartesian=(e,t,n,i)=>{let s=i*Math.PI/180;return{x:e+Math.sin(s)*n,y:t-Math.cos(s)*n}},this.draw=e=>{let t=(e=void 0===e?this.options.percent:Math.abs(e))>100?100:e,n=2*this.options.radius+2*this.options.outerStrokeWidth;this.options.showBackground&&(n+=2*this.options.backgroundStrokeWidth+this.max(0,2*this.options.backgroundPadding));let i,s,r={x:n/2,y:n/2},o=r.x,a=r.y-this.options.radius,l=this.polarToCartesian(r.x,r.y,this.options.radius,360*(this.options.clockwise?t:100-t)/100);100===t&&(l.x=l.x+(this.options.clockwise?-.01:.01)),[i,s]=t>50?this.options.clockwise?[1,1]:[1,0]:this.options.clockwise?[0,1]:[0,0];let c=this.options.animateTitle?e:this.options.percent,u=c>this.options.maxPercent?`${this.options.maxPercent.toFixed(this.options.toFixed)}+`:c.toFixed(this.options.toFixed),d=this.options.animateSubtitle?e:this.options.percent,h={x:r.x,y:r.y,textAnchor:"middle",color:this.options.titleColor,fontSize:this.options.titleFontSize,fontWeight:this.options.titleFontWeight,texts:[],tspans:[]};if(void 0!==this.options.titleFormat&&"Function"===this.options.titleFormat.constructor.name){let e=this.options.titleFormat(c);e instanceof Array?h.texts=[...e]:h.texts.push(e.toString())}else"auto"===this.options.title?h.texts.push(u):this.options.title instanceof Array?h.texts=[...this.options.title]:h.texts.push(this.options.title.toString());let p={x:r.x,y:r.y,textAnchor:"middle",color:this.options.subtitleColor,fontSize:this.options.subtitleFontSize,fontWeight:this.options.subtitleFontWeight,texts:[],tspans:[]};if(void 0!==this.options.subtitleFormat&&"Function"===this.options.subtitleFormat.constructor.name){let e=this.options.subtitleFormat(d);e instanceof Array?p.texts=[...e]:p.texts.push(e.toString())}else this.options.subtitle instanceof Array?p.texts=[...this.options.subtitle]:p.texts.push(this.options.subtitle.toString());let f={text:`${this.options.units}`,fontSize:this.options.unitsFontSize,fontWeight:this.options.unitsFontWeight,color:this.options.unitsColor},g=0,m=1;if(this.options.showTitle&&(g+=h.texts.length),this.options.showSubtitle&&(g+=p.texts.length),this.options.showTitle)for(let v of h.texts)h.tspans.push({span:v,dy:this.getRelativeY(m,g)}),m++;if(this.options.showSubtitle)for(let v of p.texts)p.tspans.push({span:v,dy:this.getRelativeY(m,g)}),m++;null===this._gradientUUID&&(this._gradientUUID=this.uuid()),this.svg={viewBox:`0 0 ${n} ${n}`,width:this.options.responsive?"100%":n,height:this.options.responsive?"100%":n,backgroundCircle:{cx:r.x,cy:r.y,r:this.options.radius+this.options.outerStrokeWidth/2+this.options.backgroundPadding,fill:this.options.backgroundColor,fillOpacity:this.options.backgroundOpacity,stroke:this.options.backgroundStroke,strokeWidth:this.options.backgroundStrokeWidth},path:{d:`M ${o} ${a}\n        A ${this.options.radius} ${this.options.radius} 0 ${i} ${s} ${l.x} ${l.y}`,stroke:this.options.outerStrokeColor,strokeWidth:this.options.outerStrokeWidth,strokeLinecap:this.options.outerStrokeLinecap,fill:"none"},circle:{cx:r.x,cy:r.y,r:this.options.radius-this.options.space-this.options.outerStrokeWidth/2-this.options.innerStrokeWidth/2,fill:"none",stroke:this.options.innerStrokeColor,strokeWidth:this.options.innerStrokeWidth},title:h,units:f,subtitle:p,image:{x:r.x-this.options.imageWidth/2,y:r.y-this.options.imageHeight/2,src:this.options.imageSrc,width:this.options.imageWidth,height:this.options.imageHeight},outerLinearGradient:{id:"outer-linear-"+this._gradientUUID,colorStop1:this.options.outerStrokeColor,colorStop2:"transparent"===this.options.outerStrokeGradientStopColor?"#FFF":this.options.outerStrokeGradientStopColor},radialGradient:{id:"radial-"+this._gradientUUID,colorStop1:this.options.backgroundColor,colorStop2:"transparent"===this.options.backgroundGradientStopColor?"#FFF":this.options.backgroundGradientStopColor}}},this.getAnimationParameters=(e,t)=>{let n,i,s,r=this.options.startFromZero?0:e<0?0:e,o=t<0?0:this.min(t,this.options.maxPercent),a=Math.abs(Math.round(o-r));return a>=100?(n=100,i=this.options.animateTitle||this.options.animateSubtitle?Math.round(a/n):1):(n=a,i=1),s=Math.round(this.options.animationDuration/n),s<10&&(s=10,n=this.options.animationDuration/s,i=!this.options.animateTitle&&!this.options.animateSubtitle&&a>100?Math.round(100/n):Math.round(a/n)),i<1&&(i=1),{times:n,step:i,interval:s}},this.animate=(e,t)=>{this._timerSubscription&&!this._timerSubscription.closed&&this._timerSubscription.unsubscribe();let n=this.options.startFromZero?0:e,i=t,{step:r,interval:o}=this.getAnimationParameters(n,i),a=n;this._timerSubscription=n<i?Object(s.a)(0,o).subscribe(()=>{a+=r,a<=i?!this.options.animateTitle&&!this.options.animateSubtitle&&a>=100?(this.draw(i),this._timerSubscription.unsubscribe()):this.draw(a):(this.draw(i),this._timerSubscription.unsubscribe())}):Object(s.a)(0,o).subscribe(()=>{a-=r,a>=i?!this.options.animateTitle&&!this.options.animateSubtitle&&i>=100?(this.draw(i),this._timerSubscription.unsubscribe()):this.draw(a):(this.draw(i),this._timerSubscription.unsubscribe())})},this.emitClickEvent=e=>{this.options.renderOnClick&&this.animate(0,this.options.percent),this.onClick.emit(e)},this.applyOptions=()=>{for(let e of Object.keys(this.options))this.hasOwnProperty(e)&&void 0!==this[e]?this.options[e]=this[e]:this.templateOptions&&void 0!==this.templateOptions[e]&&(this.options[e]=this.templateOptions[e]);this.options.radius=Math.abs(+this.options.radius),this.options.space=+this.options.space,this.options.percent=+this.options.percent>0?+this.options.percent:0,this.options.maxPercent=Math.abs(+this.options.maxPercent),this.options.animationDuration=Math.abs(this.options.animationDuration),this.options.outerStrokeWidth=Math.abs(+this.options.outerStrokeWidth),this.options.innerStrokeWidth=Math.abs(+this.options.innerStrokeWidth),this.options.backgroundPadding=+this.options.backgroundPadding},this.getRelativeY=(e,t)=>(1*(e-t/2)-.18).toFixed(2)+"em",this.min=(e,t)=>e<t?e:t,this.max=(e,t)=>e>t?e:t,this.uuid=()=>{var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))},this.findSvgElement=function(){if(null===this.svgElement){let e=this.elRef.nativeElement.getElementsByTagName("svg");e.length>0&&(this.svgElement=e[0])}},this.checkViewport=()=>{this.findSvgElement();let e=this.isInViewport;this.isInViewport=this.isElementInViewport(this.svgElement),e!==this.isInViewport&&this.onViewportChanged.emit({oldValue:e,newValue:this.isInViewport})},this.onScroll=e=>{this.checkViewport()},this.loadEventsForLazyMode=()=>{if(this.options.lazy){this.document.addEventListener("scroll",this.onScroll,!0),this.window.addEventListener("resize",this.onScroll,!0),null===this._viewportChangedSubscriber&&(this._viewportChangedSubscriber=this.onViewportChanged.subscribe(({newValue:e})=>{e&&this.render()}));let e=Object(s.a)(0,50).subscribe(()=>{null===this.svgElement?this.checkViewport():e.unsubscribe()})}},this.unloadEventsForLazyMode=()=>{this.document.removeEventListener("scroll",this.onScroll,!0),this.window.removeEventListener("resize",this.onScroll,!0),null!==this._viewportChangedSubscriber&&(this._viewportChangedSubscriber.unsubscribe(),this._viewportChangedSubscriber=null)},this.document=n,this.window=this.document.defaultView,Object.assign(this.options,e),Object.assign(this.defaultOptions,e)}isDrawing(){return this._timerSubscription&&!this._timerSubscription.closed}isElementInViewport(e){if(null==e)return!1;let t,n=e.getBoundingClientRect(),i=e.parentNode;do{if(t=i.getBoundingClientRect(),n.top>=t.bottom)return!1;if(n.bottom<=t.top)return!1;if(n.left>=t.right)return!1;if(n.right<=t.left)return!1;i=i.parentNode}while(i!=this.document.body);return!(n.top>=(this.window.innerHeight||this.document.documentElement.clientHeight)||n.bottom<=0||n.left>=(this.window.innerWidth||this.document.documentElement.clientWidth)||n.right<=0)}ngOnInit(){this.loadEventsForLazyMode()}ngOnDestroy(){this.unloadEventsForLazyMode()}ngOnChanges(e){this.render(),"lazy"in e&&(e.lazy.currentValue?this.loadEventsForLazyMode():this.unloadEventsForLazyMode())}}class a{static forRoot(e={}){return{ngModule:a,providers:[{provide:r,useValue:e}]}}}},BG5D:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;const i=n("+qwt");t.Metadata=class{static getMetadata(e){"undefined"!=typeof navigator&&i.parse(navigator.userAgent);let t=e&&e.clientMetadata?e.clientMetadata:{};const n={env:i.name,envv:i.version,os:i.os.family,osv:i.os.version,osa:i.os.architecture,sdk:"js-default"};let s={};return["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"].filter(e=>e in t||e in n).forEach(e=>s[e]=e in t?t[e]:n[e]),s}}},BLvK:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineProductStorage=void 0;const i=n("arZA");class s{constructor(e){this.id=e}static create(e){if(e instanceof Object&&"storage_id"in e)return new s(e.storage_id);throw new i.TwilsockError('Field "storage_id" is missing')}}t.OfflineProductStorage=s},BPEz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventSendingLimitation=t.TelemetryPoint=t.TelemetryEventDescription=t.TelemetryTracker=void 0;const i=n("KnDq"),s=n("uShU");class r{constructor(e,t,n,i,s,r){this.title=e,this.details=t,this.start=n,this.type=s,this.id=r,this.end=i}toTelemetryEvent(){const e=new Date;let t=this.start,n=this.end?this.end:e;if(n<t){let e=n;n=t,t=e}const s=t.getTime()-e.getTime(),r=n.getTime()-e.getTime();return new i.TelemetryEvent(s,r,this.title,this.details,this.id,this.type)}}var o,a;t.TelemetryEventDescription=r,function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(o||(o={})),t.TelemetryPoint=o,function(e){e[e.MinEventsPortion=0]="MinEventsPortion",e[e.AnyEvents=1]="AnyEvents",e[e.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(a||(a={})),t.EventSendingLimitation=a,t.TelemetryTracker=class{constructor(e,t){this.minEventsPortionToSend=50,this.maxEventsPortionToSend=100,this.pendingEvents=new Map,this.readyEvents=[],this.hasInitializationFinished=!1,this._canSendTelemetry=!1,this.config=e,this.packetInterface=t}get isTelemetryEnabled(){return this.config.confirmedCapabilities.has("telemetry.v1")}get canSendTelemetry(){return this._canSendTelemetry&&this.isTelemetryEnabled}set canSendTelemetry(e){s.log.debug(`TelemetryTracker.canSendTelemetry: ${e} TelemetryTracker.isTelemetryEnabled: ${this.isTelemetryEnabled}`),this._canSendTelemetry&&!e&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=e,e&&this.sendTelemetry(a.AnyEvents),e&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}addTelemetryEvent(e){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(e)}addPartialEvent(e,t,n){s.log.debug(`Adding ${n===o.Start?"starting":"ending"} timepoint for '${t}' event`);let i=this.pendingEvents.has(t);if(n===o.Start)i&&s.log.debug(`Overwriting starting point for '${t}' event`),this.pendingEvents.set(t,e);else{if(!i)return void s.log.error(`Could not find started event for '${t}' event`);this.addTelemetryEvent(this.merge(this.pendingEvents.get(t),e)),this.pendingEvents.delete(t)}}getTelemetryToSend(e){return this.canSendTelemetry&&0!=this.readyEvents.length?e==a.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(e==a.AnyEventsIncludingUnfinished):[]}getTelemetryPortion(e){const t=Math.min(this.readyEvents.length,this.maxEventsPortionToSend);let n=this.readyEvents.splice(0,t);return e&&n.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach((e,t)=>{if(n.length>=this.maxEventsPortionToSend)return;let i=this.pendingEvents.get(t);this.pendingEvents.delete(t),n.push(new r(`[UNFINISHED] ${i.title}`,i.details,i.start,null,i.type,i.id))}),n}merge(e,t){return new r(t.title?t.title:e.title,t.details?t.details:e.details,e.start,t.end,t.type?t.type:e.type,t.id?t.id:e.id)}sendTelemetryIfMinimalPortionCollected(){this.sendTelemetry(a.MinEventsPortion)}sendTelemetry(e){const t=this.getTelemetryToSend(e);if(0!==t.length)try{this.packetInterface.send(new i.Telemetry(t.map(e=>e.toTelemetryEvent())))}catch(n){s.log.debug(`Error while sending ${t.length} telemetry events due to ${n}; they will be resubmitted`),this.readyEvents=this.readyEvents.concat(t)}}}},BRsN:function(e,t,n){var i=n("GhSp"),s=n("ENu8");e.exports=n("C61u")?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},BSbQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("8LU1");class i{}},BUbV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncEntity=void 0;class i{constructor(e,t){this.services=e,this.removalHandler=t,this.subscriptionState="none",this._attachedListeners=new Map}_advanceLastEventId(e,t){}reportFailure(e){404===e.status?this.onRemoved(!1):this.broadcastEventToListeners("failure",e)}_subscribe(){this.services.router.subscribe(this.sid,this)}_unsubscribe(){this.services.router.unsubscribe(this.sid)}_setSubscriptionState(e){this.subscriptionState=e,this.broadcastEventToListeners("_subscriptionStateChanged",e)}close(){this._unsubscribe(),null!=this.removalHandler&&this.removalHandler(this.type,this.sid,this.uniqueName)}attach(e){const t=e.listenerUuid;this._attachedListeners.get(t)||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(t,e))}detach(e){this._attachedListeners.delete(e),this._attachedListeners.size||this.close()}broadcastEventToListeners(e,t){for(let n of this._attachedListeners.values())n.emit(e,t)}}t.SyncEntity=i,t.default=i},BfU5:function(e,t,n){var i=n("ekG2"),s=n("7whZ").document,r=i(s)&&i(s.createElement);e.exports=function(e){return r?s.createElement(e):{}}},By1P:function(e,t,n){"use strict";var i=n("C61u"),s=n("mHY4"),r=n("/tXR"),o=n("GRew"),a=n("CYMq"),l=n("n7vu"),c=Object.assign;e.exports=!c||n("S4vA")((function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=i}))?function(e,t){for(var n=a(e),c=arguments.length,u=1,d=r.f,h=o.f;c>u;)for(var p,f=l(arguments[u++]),g=d?s(f).concat(d(f)):s(f),m=g.length,v=0;m>v;)p=g[v++],i&&!h.call(f,p)||(n[p]=f[p]);return n}:c},"C/FO":function(e,t,n){n("MrV2"),e.exports=n("VSTI").Number.isInteger},C01u:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Upstream=void 0;const i=n("uShU"),s=n("7FP+"),r=n("rifi"),o=n("w7D8"),a=n("o+/m");function l(e,t){const n=function(e){const t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){let e={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],params:null};if(e.search.length>0){let t=e.search.substring(1);e.params=t.split("&").map(e=>e.split("=")).reduce((e,t)=>(e.hasOwnProperty(t[0])?Array.isArray(e[t[0]])?e[t[0]].push(t[1]):e[t[0]]=[e[t[0]],t[1]]:e[t[0]]=t[1],e),{})}return e}throw new s.TwilsockError("Incorrect URI: "+e)}(t);let i={method:e,host:n.host,path:n.pathname};return n.params&&(i.params=n.params),i}t.Upstream=class{constructor(e,t,n){this.config=n,this.transport=e,this.pendingMessages=[],this.twilsock=t}saveMessage(e){return new Promise((t,n)=>{let r={message:e,resolve:t,reject:n,alreadyRejected:!1,timeout:setTimeout(()=>{i.log.debug("request is timed out"),n(new s.TwilsockError("Twilsock: request timeout")),r.alreadyRejected=!0},2e4)};this.pendingMessages.push(r)})}sendPendingMessages(){for(;this.pendingMessages.length;){let t=this.pendingMessages[0];if(!t.alreadyRejected)try{this.actualSend(t.message).then(e=>t.resolve(e)).catch(e=>t.reject(e)),clearTimeout(t.timeout)}catch(e){i.log.debug("Failed to send pending message",e);break}this.pendingMessages.splice(0,1)}}rejectPendingMessages(){this.pendingMessages.forEach(e=>{e.reject(new a.TransportUnavailableError("Unable to connect: "+this.twilsock.getTerminationReason)),clearTimeout(e.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}async actualSend(e){let t=e.to,n=e.headers,i=e.body,s=new o.Message(this.config.activeGrant,n["Content-Type"]||"application/json",{host:t.host,path:t.path,method:t.method,params:t.params,headers:n}),a=await this.transport.sendWithReply(s,i);if((c=a)&&c.header&&c.header.http_status&&!((l=a.header.http_status.code)>=200&&l<300))throw new r.TwilsockUpstreamError(a.header.http_status.code,a.header.http_status.status,a.body);var l,c;return{status:a.header.http_status,headers:a.header.http_headers,body:a.body}}send(e,t,n={},i){if(this.twilsock.isTerminalState)return Promise.reject(new a.TransportUnavailableError("Unable to connect: "+this.twilsock.getTerminationReason));let s=function(e,t,n,i){return{to:l(e,t),headers:n,body:i}}(e,t,n,i);return this.twilsock.isConnected?this.actualSend(s):this.saveMessage(s)}}},C5kU:function(e,t,n){"use strict";var i=n("GfoU")(!0);n("OTpG")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})}))},C61u:function(e,t,n){e.exports=!n("S4vA")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},C9Jq:function(e,t,n){"use strict";var i=a(n("4d7F")),s=a(n("sk9p")),r=a(n("EJiy")),o=a(n("ql3t"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.pureObject=t.nonNegativeInteger=t.nonEmptyString=t.stringifyReceivedType=t.custom=t.literal=t.type=t.asyncTypeCheck=t.typeCheck=t.runtimeTypeCheck=void 0;var l=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{mode:"type",checks:t}};t.type=l,t.literal=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{mode:"literal",checks:t}};var c=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{mode:"custom",checks:t}};t.custom=c;var u=c((function(e){return["string"==typeof e&&e.length>0,"a non-empty string"]}));t.nonEmptyString=u;var d=c((function(e){return[(0,o.default)(e)&&e>=0,"a non-negative integer"]}));t.nonNegativeInteger=d;var h=c((function(e){return["object"===(void 0===e?"undefined":(0,r.default)(e))&&null!==e&&!Array.isArray(e),"a pure object (non-null and non-array)"]}));t.pureObject=h;var p=function(e,t,n){if(t.length>e.length)throw new Error("Expected at most "+e.length+" argument(s), but got "+t.length);for(;t.length<e.length;)t.push(void 0);t.forEach((function(t,i){var o=[],a=void 0,l=!1;if(e[i].forEach((function(e){switch(e.mode){case"type":e.checks.forEach((function(e){if("string"==typeof e)return l=l||(void 0===t?"undefined":(0,r.default)(t))===e,void o.push("of type "+e);l=l||t instanceof e,o.push("an instance of "+e.name)}));break;case"literal":e.checks.forEach((function(e){l=l||t===e,o.push("string"==typeof e?'"'+e+'"':""+e)}));break;case"custom":e.checks.forEach((function(e){var n=e(t),i=(0,s.default)(n,3),r=i[2];l=l||i[0],!a&&r&&(a=r),o.push(i[1])}))}})),!l){var c=a||f(t),u=n?" of "+n:"",d=o.length-1,h=d>0?o.slice(0,d).join(", ")+" or "+o[d]:o.join(", ");throw new Error("Argument "+(i+1)+u+" is expected to be "+h+(d>1?";":",")+" but got "+c)}}))};t.runtimeTypeCheck=p;var f=function(e){var t,n=void 0;["undefined","boolean","number","bigint","string"].includes(void 0===e?"undefined":(0,r.default)(e))&&(n="string"==typeof e?'"'+e+'"':""+e);var i=null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name;return"object"===(void 0===e?"undefined":(0,r.default)(e))&&"Object"!==i&&(n=null===e?"null":"instance of "+i),n||(n=void 0===e?"undefined":(0,r.default)(e)),n};t.stringifyReceivedType=f,t.typeCheck=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=g(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The typeCheck decorator can only be applied to methods");var s=n.value;n.value=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p(i,t,s.name),s.apply(this,arguments)}}},t.asyncTypeCheck=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=g(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The asyncTypeCheck decorator can only be applied to methods");var r=n.value;n.value=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{p(s,t,r.name)}catch(o){return i.default.reject(o)}return r.apply(this,arguments)}}};var g=function(e){var t=[];return e.forEach((function(e){var n=[];(Array.isArray(e)?e:[e]).forEach((function(e){["string","function"].includes(void 0===e?"undefined":(0,r.default)(e))?n.push(l(e)):n.push(e)})),t.push(n)})),t}},"CE4/":function(e,t,n){"use strict";var i=n("nAx8"),s=n("USwo"),r=n("CYMq"),o=n("xMGN"),a=n("bS86"),l=n("0WpP"),c=n("SkeG"),u=n("I90/");s(s.S+s.F*!n("h3Hq")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,s,d,h=r(e),p="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,v=0,b=u(h);if(m&&(g=i(g,f>2?arguments[2]:void 0,2)),null==b||p==Array&&a(b))for(n=new p(t=l(h.length));t>v;v++)c(n,v,m?g(h[v],v):h[v]);else for(d=b.call(h),n=new p;!(s=d.next()).done;v++)c(n,v,m?o(d,g,[s.value,v],!0):s.value);return n.length=v,n}})},CFWb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockImpl=t.TwilsockChannel=t.Response=void 0;const i=n("+qE3"),s=n("xDTo"),r=n("uShU"),o=n("w7D8"),a=n("CQrr"),l=n("L5mX"),c=n("ZgEp");t.Response=class{};class u extends i.EventEmitter{constructor(e,t,n){super(),this.terminalStates=["disconnected","rejected"],this.lastEmittedState=void 0,this.tokenExpiredSasCode=20104,this.terminationReason="Connection is not initialized",this.websocket=e,this.websocket.on("connected",()=>this.fsm.socketConnected()),this.websocket.on("disconnected",e=>this.fsm.socketClosed()),this.websocket.on("message",e=>this.onIncomingMessage(e)),this.websocket.on("socketError",e=>this.emit("connectionError",{terminal:!1,message:e.message,httpStatusCode:null,errorCode:null})),this.transport=t,this.config=n,this.retrier=new c.BackoffRetrier(n.retryPolicy),this.retrier.on("attempt",()=>this.retry()),this.retrier.on("failed",e=>{r.log.warn(`Retrying failed: ${e.message}`),this.disconnect()}),"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",()=>{r.log.debug("Browser reported connectivity state: online"),this.fsm.systemOnline()}),window.addEventListener("offline",()=>{r.log.debug("Browser reported connectivity state: offline"),this.websocket.close(),this.fsm.socketClosed()})),this.fsm=new s({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:()=>{this.setupSocket(),this.emit("connecting")},onEnterInitialising:()=>{this.sendInit()},onLeaveInitialising:()=>{this.cancelInit()},onEnterUpdating:()=>{this.sendUpdate()},onLeaveUpdating:()=>{this.cancelUpdate()},onEnterRetrying:()=>{this.initRetry(),this.emit("connecting")},onEnterConnected:()=>{this.resetBackoff(),this.onConnected()},onUserUpdateToken:()=>{this.resetBackoff()},onTokenRejected:()=>{this.resetBackoff(),this.closeSocket(!0),this.finalizeSocket()},onUserDisconnect:()=>{this.closeSocket(!0)},onEnterDisconnecting:()=>{this.startDisconnectTimer()},onLeaveDisconnecting:()=>{this.cancelDisconnectTimer()},onEnterWaitSocketClosed:()=>{this.startDisconnectTimer()},onLeaveWaitSocketClosed:()=>{this.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:()=>{this.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:()=>{this.cancelDisconnectTimer()},onDisconnected:()=>{this.resetBackoff(),this.finalizeSocket()},onReceiveClose:(e,t)=>{this.onCloseReceived(t)},onReceiveOffload:(e,t)=>{r.log.debug("onreceiveoffload: ",t),this.modifyBackoff(t.body),this.onCloseReceived(t.status)},onUnsupported:()=>{this.closeSocket(!0),this.finalizeSocket()},onError:(e,t)=>{this.closeSocket(t),this.finalizeSocket()},onEnterState:e=>{"none"!==e.from&&this.changeState(e)},onInvalidTransition:(e,t,n)=>{r.log.warn("FSM: unexpected transition",t,n)}}})}changeState(e){r.log.debug(`FSM: ${e.transition}: ${e.from} --\x3e ${e.to}`),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}resetBackoff(){r.log.trace("resetBackoff"),this.retrier.stop()}modifyBackoff(e){r.log.trace("modifyBackoff",e);let t=e?e.backoff_policy:null;t&&"number"==typeof t.reconnect_min_ms&&this.retrier.modifyBackoff(t.reconnect_min_ms)}startDisconnectTimer(){r.log.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(()=>{r.log.debug("disconnecting is timed out"),this.closeSocket(!0)},3e3)}cancelDisconnectTimer(){r.log.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}get isConnected(){return"connected"===this.state&&this.websocket.isConnected}get state(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"rejected";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}initRetry(){r.log.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}retry(){"connecting"!=this.fsm.state?(r.log.trace("retry"),this.websocket.close(),this.fsm.userRetry()):r.log.trace("can\t retry as already connecting")}onConnected(){this.emit("connected")}finalizeSocket(){r.log.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}setupSocket(){r.log.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}onIncomingMessage(e){let{method:t,header:n,payload:i}=a.Parser.parse(e);if("reply"!==t&&this.confirmReceiving(n),"notification"===t)this.emit("message",n.message_type,i);else if("reply"===n.method)this.transport.processReply({id:n.id,status:n.status,header:n,body:i});else if("client_update"===n.method)"token_about_to_expire"===n.client_update_type&&this.emit("tokenAboutToExpire");else if("close"===n.method)if(308===n.status.code)r.log.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:n.status.status,body:i});else if(406===n.status.code){const e=`Server closed connection because can't parse protocol: ${JSON.stringify(n.status)}`;this.emitReplyConnectionError(e,n,!0),r.log.error(e),this.fsm.receiveFatalClose()}else 417===n.status.code?(r.log.error(`Server closed connection because can't parse client reply: ${JSON.stringify(n.status)}`),this.fsm.receiveFatalClose(n.status.status)):410===n.status.code?(r.log.warn(`Server closed connection: ${JSON.stringify(n.status)}`),this.fsm.receiveClose(n.status.status),this.emit("tokenExpired")):401===n.status.code?(r.log.error(`Server closed connection: ${JSON.stringify(n.status)}`),this.fsm.receiveClose(n.status.status)):(r.log.warn("unexpected message: ",n.status),this.fsm.receiveOffload({status:n.status.status,body:null}))}async sendInit(){r.log.trace("sendInit");try{this.emit("beforeSendInit");let e=await this.transport.sendInit();this.config.updateContinuationToken(e.continuationToken),this.config.confirmedCapabilities=e.confirmedCapabilities,this.fsm.initSuccess(e),this.emit("initialized",e),this.emit("tokenUpdated")}catch(e){if(e instanceof l.TwilsockReplyError){let t=!1;r.log.warn(`Init rejected by server: ${JSON.stringify(e.reply.status)}`),this.emit("sendInitFailed"),401===e.reply.status.code||403===e.reply.status.code?(t=!0,this.fsm.tokenRejected(e.reply.status),e.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.reply.status.code?(this.modifyBackoff(e.reply.body),this.fsm.initError(!0)):this.fsm.initError(500!==e.reply.status.code),this.emitReplyConnectionError(e.message,e.reply,t)}else this.terminationReason=e.message,this.emit("connectionError",{terminal:!0,message:e.message,httpStatusCode:null,errorCode:null}),this.fsm.initError(!0);this.emit("tokenUpdated",e)}}async sendUpdate(){r.log.trace("sendUpdate");let e=new o.Update(this.config.token);try{let t=await this.transport.sendWithReply(e);this.fsm.updateSuccess(t.body),this.emit("tokenUpdated")}catch(t){if(t instanceof l.TwilsockReplyError){let e=!1;r.log.warn(`Token update rejected by server: ${JSON.stringify(t.reply.status)}`),401===t.reply.status.code||403===t.reply.status.code?(e=!0,this.fsm.tokenRejected(t.reply.status),t.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===t.reply.status.code?(this.modifyBackoff(t.reply.body),this.fsm.updateError(t.reply.status)):this.fsm.updateError(t.reply.status),this.emitReplyConnectionError(t.message,t.reply,e)}else this.emit("error",!1,t.message,null,null),this.fsm.updateError(t);this.emit("tokenUpdated",t)}}emitReplyConnectionError(e,t,n){const i=t.status&&t.status.description?t.status.description:e,s=t.status.code,r=t.status&&t.status.errorCode?t.status.errorCode:null;n&&(this.terminationReason=i),this.emit("connectionError",{terminal:n,message:i,httpStatusCode:s,errorCode:r})}cancelInit(){r.log.trace("cancelInit")}cancelUpdate(){r.log.trace("cancelUpdate")}confirmReceiving(e){r.log.trace("confirmReceiving");try{this.transport.send(new o.Reply(e.id))}catch(t){r.log.debug("failed to confirm packet receiving",t)}}closeSocket(e){r.log.trace(`closeSocket (graceful: ${e})`),e&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),setTimeout(()=>this.fsm.socketClosed(),0)}connect(){r.log.trace("connect"),this.fsm.userConnect()}disconnect(){return r.log.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(e=>{this.disconnectedPromiseResolve=e,this.fsm.userDisconnect()})}updateToken(e){return r.log.trace("updateToken:",e),new Promise((e,t)=>{this.once("tokenUpdated",n=>{n?t(n):e()}),this.fsm.userUpdateToken()})}get isTerminalState(){return-1!==this.terminalStates.indexOf(this.fsm.state)}get getTerminationReason(){return this.terminationReason}onCloseReceived(e){this.websocket.close()}}t.TwilsockChannel=u,t.TwilsockImpl=u},CQrr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;const i=n("uShU");function s(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)).length}function r(e){let t=Array.prototype.map.call(e,e=>String.fromCharCode(e)).join("").replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(t)}function o(e){return JSON.parse(r(e))}t.Parser=class{constructor(){}static parse(e){const t=new Uint8Array(e),n=function(e){let t="",n=0;for(;n<e.length;++n){const i=String.fromCharCode(e[n]);if(t+=i,"\r"===i){n+=2;break}}const i=t.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}(t);if("TWILSOCK"!==n.protocol||"V3.0"!==n.version)return void i.log.error(`unsupported protocol: ${n.protocol} ver ${n.version}`);let s=null;try{s=o(t.subarray(n.size,n.size+n.headerSize))}catch(l){return void i.log.error("failed to parse message header",l,e)}i.log.debug("message received: ",s.method),i.log.trace("message received: ",s);let a=null;if(s.payload_size>0){const c=2+n.size+n.headerSize,u=s.payload_size;if(s.hasOwnProperty("payload_type")&&0!==s.payload_type.indexOf("application/json"))0===s.payload_type.indexOf("text/plain")&&(a=r(t.subarray(c,c+u)));else try{a=o(t.subarray(c,c+u))}catch(l){return void i.log.error("failed to parse message body",l,e)}}return{method:s.method,header:s,payload:a}}static createPacket(e,t=""){e.payload_size=s(t);let n=JSON.stringify(e)+"\r\n",r="TWILSOCK V3.0 "+(s(n)-2)+"\r\n";return i.log.debug("send request:",r+n+t),function(e){let t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)),n=new Uint8Array(t.length);return Array.prototype.forEach.call(t,(e,t)=>{n[t]=e.charCodeAt(0)}),n}(r+n+t).buffer}}},CYMq:function(e,t,n){var i=n("yQFZ");e.exports=function(e){return Object(i(e))}},Cjvl:function(e,t,n){"use strict";var i=a(n("14Xm")),s=a(n("D3Ub")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserChannels=void 0;var l=n("iqZd"),c=n("IMt4"),u=n("k1+U"),d=function(){function e(t,n,i){(0,r.default)(this,e),this.client=t,this.services=n,this.url=i}var t;return(0,o.default)(e,[{key:"getChannels",value:(t=(0,s.default)(i.default.mark((function e(){var t,n,s=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.UriBuilder(this.url).arg("PageToken",r.pageToken).build(),e.next=3,this.services.network.get(t);case 3:return e.abrupt("return",new c.RestPaginator((n=e.sent).body.channels.map((function(e){return new u.ChannelDescriptor(s.client,e)})),(function(e){return s.getChannels({pageToken:e})}),n.body.meta.previous_token,n.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();t.UserChannels=d},CruZ:function(e,t,n){"use strict";var i,s=(i=n("iCc5"))&&i.__esModule?i:{default:i};Object.defineProperty(t,"__esModule",{value:!0}),t.PushNotification=void 0,t.PushNotification=function e(t){(0,s.default)(this,e),this.title=t.title||null,this.body=t.body||null,this.sound=t.sound||null,this.badge=t.badge||null,this.action=t.action||null,this.type=t.type||null,this.data=t.data||{}}},CuL1:function(e,t,n){var i=n("mHY4"),s=n("/tXR"),r=n("GRew");e.exports=function(e){var t=i(e),n=s.f;if(n)for(var o,a=n(e),l=r.f,c=0;a.length>c;)l.call(e,o=a[c++])&&t.push(o);return t}},D0ik:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0,t.Configuration=class{constructor(e,t={}){let n=t.notifications||{};this.registrarUrl=n.ersUrl||`https://ers.${n.region||t.region||"us1"}.twilio.com/v1/registrations`,this._token=e}updateToken(e){this._token=e}get token(){return this._token}}},D3Ub:function(e,t,n){"use strict";t.__esModule=!0;var i,s=(i=n("4d7F"))&&i.__esModule?i:{default:i};t.default=function(e){return function(){var t=e.apply(this,arguments);return new s.default((function(e,n){return function i(r,o){try{var a=t[r](o),l=a.value}catch(c){return void n(c)}if(!a.done)return s.default.resolve(l).then((function(e){i("next",e)}),(function(e){i("throw",e)}));e(l)}("next")}))}}},DQkm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Update=void 0;const i=n("PmLG");t.Update=class extends i.AbstractMessage{constructor(e){super(),this.method="update",this.token=e}}},DrT7:function(e,t,n){var i=n("ekG2"),s=n("d+lc"),r=function(e,t){if(s(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n("nAx8")(Function.call,n("TSC6").f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(s){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},ECU5:function(e,t,n){"use strict";var i=n("8Y7J");class s{constructor(){}}var r=i.xb({encapsulation:0,styles:[[".empty-state-container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;width:100%;height:100%}.empty-state-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-bottom:24px}.empty-state-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:22px;font-size:24px;line-height:32px;font-weight:500}"]],data:{}});function o(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","empty-state-container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,0,"img",[["alt",""],["src","assets/images/icons/icon-no-reservations.svg"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),i.Xb(3,null,["",""])),(e()(),i.zb(4,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(5,null,["",""]))],null,(function(e,t){var n=t.component;e(t,3,0,n.header),e(t,5,0,n.subtitle)}))}var a=n("B0QU"),l=n("SVse"),c=i.xb({encapsulation:2,styles:[],data:{}});function u(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,":svg:linearGradient",[],[[1,"id",0]],null,null,null,null)),(e()(),i.zb(1,0,null,null,0,":svg:stop",[["offset","5%"]],[[1,"stop-color",0],[1,"stop-opacity",0]],null,null,null,null)),(e()(),i.zb(2,0,null,null,0,":svg:stop",[["offset","95%"]],[[1,"stop-color",0],[1,"stop-opacity",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.outerLinearGradient.id),e(t,1,0,n.svg.outerLinearGradient.colorStop1,1),e(t,2,0,n.svg.outerLinearGradient.colorStop2,1)}))}function d(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,":svg:radialGradient",[],[[1,"id",0]],null,null,null,null)),(e()(),i.zb(1,0,null,null,0,":svg:stop",[["offset","5%"]],[[1,"stop-color",0],[1,"stop-opacity",0]],null,null,null,null)),(e()(),i.zb(2,0,null,null,0,":svg:stop",[["offset","95%"]],[[1,"stop-color",0],[1,"stop-opacity",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.radialGradient.id),e(t,1,0,n.svg.radialGradient.colorStop1,1),e(t,2,0,n.svg.radialGradient.colorStop2,1)}))}function h(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:circle",[],[[1,"cx",0],[1,"cy",0],[1,"r",0],[1,"fill",0],[1,"fill-opacity",0],[1,"stroke",0],[1,"stroke-width",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.backgroundCircle.cx,n.svg.backgroundCircle.cy,n.svg.backgroundCircle.r,n.svg.backgroundCircle.fill,n.svg.backgroundCircle.fillOpacity,n.svg.backgroundCircle.stroke,n.svg.backgroundCircle.strokeWidth)}))}function p(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:circle",[],[[1,"cx",0],[1,"cy",0],[1,"r",0],[1,"fill",0],[1,"fill-opacity",0],[1,"stroke",0],[1,"stroke-width",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.backgroundCircle.cx,n.svg.backgroundCircle.cy,n.svg.backgroundCircle.r,i.Gb(1,"url(#",n.svg.radialGradient.id,")"),n.svg.backgroundCircle.fillOpacity,n.svg.backgroundCircle.stroke,n.svg.backgroundCircle.strokeWidth)}))}function f(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,h)),i.yb(2,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,p)),i.yb(4,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.options.backgroundGradient),e(t,4,0,n.options.backgroundGradient)}),null)}function g(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:circle",[],[[1,"cx",0],[1,"cy",0],[1,"r",0],[1,"fill",0],[1,"stroke",0],[1,"stroke-width",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.circle.cx,n.svg.circle.cy,n.svg.circle.r,n.svg.circle.fill,n.svg.circle.stroke,n.svg.circle.strokeWidth)}))}function m(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:path",[],[[1,"d",0],[1,"stroke",0],[1,"stroke-width",0],[1,"stroke-linecap",0],[1,"fill",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.path.d,n.svg.path.stroke,n.svg.path.strokeWidth,n.svg.path.strokeLinecap,n.svg.path.fill)}))}function v(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:path",[],[[1,"d",0],[1,"stroke",0],[1,"stroke-width",0],[1,"stroke-linecap",0],[1,"fill",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.path.d,i.Gb(1,"url(#",n.svg.outerLinearGradient.id,")"),n.svg.path.strokeWidth,n.svg.path.strokeLinecap,n.svg.path.fill)}))}function b(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,m)),i.yb(2,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,v)),i.yb(4,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.options.outerStrokeGradient),e(t,4,0,n.options.outerStrokeGradient)}),null)}function y(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,":svg:tspan",[],[[1,"x",0],[1,"y",0],[1,"dy",0],[1,"font-size",0],[1,"font-weight",0],[1,"fill",0]],null,null,null,null)),(e()(),i.Xb(1,null,["",""]))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.title.x,n.svg.title.y,t.context.$implicit.dy,n.svg.title.fontSize,n.svg.title.fontWeight,n.svg.title.color),e(t,1,0,t.context.$implicit.span)}))}function _(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,y)),i.yb(2,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.jb(0,null,null,0))],(function(e,t){e(t,2,0,t.component.svg.title.tspans)}),null)}function C(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,":svg:tspan",[],[[1,"font-size",0],[1,"font-weight",0],[1,"fill",0]],null,null,null,null)),(e()(),i.Xb(1,null,["",""]))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.units.fontSize,n.svg.units.fontWeight,n.svg.units.color),e(t,1,0,n.svg.units.text)}))}function w(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,":svg:tspan",[],[[1,"x",0],[1,"y",0],[1,"dy",0],[1,"font-size",0],[1,"font-weight",0],[1,"fill",0]],null,null,null,null)),(e()(),i.Xb(1,null,["",""]))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.subtitle.x,n.svg.subtitle.y,t.context.$implicit.dy,n.svg.subtitle.fontSize,n.svg.subtitle.fontWeight,n.svg.subtitle.color),e(t,1,0,t.context.$implicit.span)}))}function k(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,w)),i.yb(2,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.jb(0,null,null,0))],(function(e,t){e(t,2,0,t.component.svg.subtitle.tspans)}),null)}function x(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,6,":svg:text",[["alignment-baseline","baseline"]],[[1,"x",0],[1,"y",0],[1,"text-anchor",0]],null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,_)),i.yb(2,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,C)),i.yb(4,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,k)),i.yb(6,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.options.showTitle),e(t,4,0,n.options.showUnits),e(t,6,0,n.options.showSubtitle)}),(function(e,t){var n=t.component;e(t,0,0,n.svg.circle.cx,n.svg.circle.cy,n.svg.title.textAnchor)}))}function O(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,":svg:image",[["preserveAspectRatio","none"]],[[1,"height",0],[1,"width",0],[1,":xlink:href",0],[1,"x",0],[1,"y",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.svg.image.height,n.svg.image.width,n.svg.image.src,n.svg.image.x,n.svg.image.y)}))}function S(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,15,":svg:svg",[["preserveAspectRatio","xMidYMid meet"],["xmlns","http://www.w3.org/2000/svg"]],[[1,"viewBox",0],[1,"height",0],[1,"width",0],[1,"class",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.emitClickEvent(n)&&i),i}),null,null)),(e()(),i.zb(1,0,null,null,4,":svg:defs",[],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,u)),i.yb(3,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,d)),i.yb(5,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,f)),i.yb(7,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,g)),i.yb(9,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,b)),i.yb(11,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,x)),i.yb(13,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,O)),i.yb(15,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.options.outerStrokeGradient),e(t,5,0,n.options.backgroundGradient),e(t,7,0,n.options.showBackground),e(t,9,0,n.options.showInnerStroke),e(t,11,0,n.options.percent-0!=0||n.options.showZeroOuterStroke),e(t,13,0,!n.options.showImage&&(n.options.showTitle||n.options.showUnits||n.options.showSubtitle)),e(t,15,0,n.options.showImage)}),(function(e,t){var n=t.component;e(t,0,0,n.svg.viewBox,n.svg.height,n.svg.width,n.options.class)}))}function M(e){return i.ac(0,[(e()(),i.jb(16777216,null,null,1,null,S)),i.yb(1,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.svg)}),null)}var P=n("wd/R");class T{constructor(){this.expiresAt=0,this.timeHasExpired=new i.o,this.secondsToExpiration=0,this.secondsAsCompleteTime=600}ngOnInit(){this.initTimer()}initTimer(){const e=setInterval(()=>{const t=P(this.expiresAt),n=P();if(t.isAfter(n)){const i=P.duration(t.diff(n));this.secondsToExpiration=i.asSeconds(),this.secondsToExpiration<=0&&(clearInterval(e),this.secondsToExpiration=0,this.timeHasExpired.emit(this.reservationId))}else clearInterval(e),this.secondsToExpiration=0,this.timeHasExpired.emit(this.reservationId)},1e3)}get timeToExpire(){const e=Math.floor(this.secondsToExpiration/60);return("00"+e).slice(-2)+":"+("00"+Math.floor(this.secondsToExpiration-60*e)).slice(-2)}get percent(){return Math.floor(100*this.secondsToExpiration/this.secondsAsCompleteTime)}get progressColor(){return this.percent>50?"#35B24D":this.percent>25?"#F2A412":"#571B15"}}var E=i.xb({encapsulation:2,styles:[],data:{}});function I(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"circle-progress",[],null,null,null,M,c)),i.yb(1,770048,null,0,a.a,[a.b,i.l,l.d],{backgroundColor:[0,"backgroundColor"],backgroundPadding:[1,"backgroundPadding"],radius:[2,"radius"],space:[3,"space"],percent:[4,"percent"],outerStrokeWidth:[5,"outerStrokeWidth"],outerStrokeColor:[6,"outerStrokeColor"],outerStrokeLinecap:[7,"outerStrokeLinecap"],innerStrokeColor:[8,"innerStrokeColor"],innerStrokeWidth:[9,"innerStrokeWidth"],title:[10,"title"],titleFontSize:[11,"titleFontSize"],animation:[12,"animation"],showTitle:[13,"showTitle"],showSubtitle:[14,"showSubtitle"],showUnits:[15,"showUnits"],showInnerStroke:[16,"showInnerStroke"],showZeroOuterStroke:[17,"showZeroOuterStroke"]},null)],(function(e,t){var n=t.component;e(t,1,1,["transparent",0,19,-3,n.percent,3,n.progressColor,"square","#E1E1E1",3,n.timeToExpire,10,!1,!0,!1,!1,!0,!1])}),null)}var R=n("1Xc+"),j=n("Dxy4"),N=n("YEUz"),U=n("omvX"),A=n("s7LF"),D=n("3Y8D"),L=n("iFvM");class F{constructor(e,t,n){this.fb=e,this.chatService=t,this.snackBar=n,this.closeClicked=new i.o,this.startingChat=!0,this.form=this.fb.group({message:new A.h("",[A.x.required])}),this.messages=[],this.messageSound=L.a,this.playSoundMessages=()=>{this.messageSound.loop(!1),this.messageSound.play(),this.messageSound.volume(1)}}ngOnInit(){this.chatService.createReservationChat(this.reservationId).subscribe(()=>{this.chatService.getChatAccessToken().subscribe(e=>{this.staffEmail=e.identity,D.Client.create(e.token).then(e=>{e.getChannelByUniqueName("rsv"+this.reservationId).then(e=>{this.currentChannel=e,this.getMessagesHistory(),this.initMessagesListener(),this.startingChat=!1}).catch(()=>{this.errorCatchedWithChat()})}).catch(()=>{this.errorCatchedWithChat()})})})}ngOnDestroy(){this.currentChannel.removeAllListeners("messageAdded")}getMessagesHistory(){this.currentChannel.getMessages().then(e=>{this.messages=e.items})}initMessagesListener(){this.currentChannel.on("messageAdded",e=>{this.staffEmail!==e.author&&this.playSoundMessages(),this.messages.push(e)})}sendMessage(){if(this.form.valid){const e=this.form.get("message").value;this.form.get("message").setValue(""),this.currentChannel.sendMessage(e)}}get clientInitials(){let e="";if(this.clientName){const t=this.clientName.split(" ");e=1===t.length?t[0].slice(0,1):t[0].slice(0,1)+t[1].slice(0,1)}return e}errorCatchedWithChat(){this.snackBar.open("Ocurri\xf3 un error tratando de conectar el chat","Entendido",{duration:15e3}),this.emitCloseAction()}emitCloseAction(){this.closeClicked.emit()}}var z=n("AytR"),q=n("IheW");let B=(()=>{class e{constructor(e){this.http=e}createReservationChat(e){const t=z.a.RESERVATION_CHAT.replace("{reservationId}",e.toString());return this.http.post(t,null)}getChatAccessToken(){return this.http.get(z.a.CHAT_ACCESS_TOKEN+"?type=web")}}return e.\u0275prov=i.bc({factory:function(){return new e(i.cc(q.c))},token:e,providedIn:"root"}),e})();var W=n("zHaW"),$=i.xb({encapsulation:0,styles:[["section[_ngcontent-%COMP%]{position:fixed;right:32px;bottom:32px;border:1px solid #f2f2f2;border-radius:8px;width:360px;height:440px;box-shadow:0 0 8px 0 rgba(0,0,0,.04)}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;border-radius:8px 8px 0 0;padding:0 16px;height:54px;background-color:#f2a412}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:calc(100% - 24px);font-size:16px;color:#fff;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;width:24px;height:24px;cursor:pointer}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:8px}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]{padding:24px 16px;height:336px;overflow:auto;background-color:#fff}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]:nth-child(n+2){margin-top:12px}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-staff[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-staff[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .client-initials[_ngcontent-%COMP%]{display:none}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-staff[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{background-color:#fbfbfb}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-staff[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{text-align:right}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-client[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:end;align-items:flex-end}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-client[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .client-initials[_ngcontent-%COMP%]{margin:0 8px 4px 0}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message.user-client[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{max-width:calc(100% - 40px);background-color:#dbeaef}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .client-initials[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;border-radius:100%;height:32px;width:32px;background-color:#3c3c3c;line-height:1;font-size:10px;color:#fff}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .message-info[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block;border-radius:8px;padding:12px 16px;line-height:18px;font-size:14px;color:#3c3c3c}section[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{margin-top:4px;line-height:18px;font-size:10px;color:#a8a8a8}section[_ngcontent-%COMP%]   .text-field[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border:1px solid #f2f2f2;border-radius:0 0 8px 8px;height:50px;background-color:#fbfbfb}section[_ngcontent-%COMP%]   .text-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;padding-left:16px;width:calc(100% - 52px);height:100%;background-color:transparent;font-size:14px;color:#7a7a7a}section[_ngcontent-%COMP%]   .text-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:14px;border:none;width:26px;height:24px;background-color:transparent;background-image:url(/assets/images/icons/send.svg);background-position:50%;background-repeat:no-repeat;background-size:cover;cursor:pointer}"]],data:{}});function G(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"div",[["class","client-initials"]],null,null,null,null,null)),(e()(),i.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.clientInitials)}))}function V(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","message user-staff"]],null,null,null,null,null)),i.yb(1,278528,null,0,l.k,[i.t,i.u,i.l,i.F],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(2,{"user-staff":0,"user-client":1}),(e()(),i.zb(3,0,null,null,4,"div",[["class","message-info"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,G)),i.yb(5,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(6,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(e()(),i.Xb(7,null,[" "," "]))],(function(e,t){var n=t.component,i=e(t,2,0,n.staffEmail===t.context.$implicit.author,n.staffEmail!==t.context.$implicit.author);e(t,1,0,"message user-staff",i),e(t,5,0,n.staffEmail!==t.context.$implicit.author)}),(function(e,t){e(t,7,0,t.context.$implicit.body)}))}function X(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,20,"section",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","header"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(3,null,["Reserva ",""])),(e()(),i.zb(4,0,null,null,1,"div",[["class","close"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.emitCloseAction()&&i),i}),null,null)),(e()(),i.zb(5,0,null,null,0,"img",[["src","assets/images/icons/icon-reject.svg"]],null,null,null,null,null)),(e()(),i.zb(6,0,null,null,2,"div",[["class","messages-container"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,V)),i.yb(8,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.zb(9,0,null,null,11,"form",[["class","text-field"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(e,t,n){var s=!0,r=e.component;return"submit"===t&&(s=!1!==i.Ob(e,11).onSubmit(n)&&s),"reset"===t&&(s=!1!==i.Ob(e,11).onReset()&&s),"ngSubmit"===t&&(s=!1!==r.sendMessage()&&s),s}),null,null)),i.yb(10,16384,null,0,A.B,[],null,null),i.yb(11,540672,null,0,A.l,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),i.Sb(2048,null,A.c,null,[A.l]),i.yb(13,16384,null,0,A.t,[[4,A.c]],null,null),(e()(),i.zb(14,0,null,null,5,"input",[["formControlName","message"],["placeholder","Escribe tu mensaje..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var s=!0;return"input"===t&&(s=!1!==i.Ob(e,15)._handleInput(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,15).onTouched()&&s),"compositionstart"===t&&(s=!1!==i.Ob(e,15)._compositionStart()&&s),"compositionend"===t&&(s=!1!==i.Ob(e,15)._compositionEnd(n.target.value)&&s),s}),null,null)),i.yb(15,16384,null,0,A.d,[i.F,i.l,[2,A.a]],null,null),i.Sb(1024,null,A.q,(function(e){return[e]}),[A.d]),i.yb(17,671744,null,0,A.j,[[3,A.c],[8,null],[8,null],[6,A.q],[2,A.A]],{name:[0,"name"]},null),i.Sb(2048,null,A.r,null,[A.j]),i.yb(19,16384,null,0,A.s,[[4,A.r]],null,null),(e()(),i.zb(20,0,null,null,0,"button",[["type","submit"]],null,null,null,null,null))],(function(e,t){var n=t.component;e(t,8,0,n.messages),e(t,11,0,n.form),e(t,17,0,"message")}),(function(e,t){e(t,3,0,t.component.reservationCode),e(t,9,0,i.Ob(t,13).ngClassUntouched,i.Ob(t,13).ngClassTouched,i.Ob(t,13).ngClassPristine,i.Ob(t,13).ngClassDirty,i.Ob(t,13).ngClassValid,i.Ob(t,13).ngClassInvalid,i.Ob(t,13).ngClassPending),e(t,14,0,i.Ob(t,19).ngClassUntouched,i.Ob(t,19).ngClassTouched,i.Ob(t,19).ngClassPristine,i.Ob(t,19).ngClassDirty,i.Ob(t,19).ngClassValid,i.Ob(t,19).ngClassInvalid,i.Ob(t,19).ngClassPending)}))}function J(e){return i.ac(0,[(e()(),i.jb(16777216,null,null,1,null,X)),i.yb(1,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,!t.component.startingChat)}),null)}var H=n("N7/N"),K=n("kMt3"),Y=n("quSY");class Q{constructor(e,t,n,s){this.reservationsService=e,this.snackBar=t,this.dialog=n,this.reservationService=s,this.reservationCancelled=new i.o,this.reservationAccepted=new i.o,this.dishesChanged=new i.o,this.reservationClosed=new i.o,this.afterModalClosesSubscription=Y.a.EMPTY}get total(){let e=0;for(const t of this.reservation.orders)t.total_in_cents&&(e+=t.total_in_cents);return e/100}getTotalAmountPerDiner(e){let t=0;for(const n of e){let e=0;n.price_in_cents&&(e=n.amount*n.price_in_cents,t+=e)}return t/100}onReservationConfirmation(){"pending"===this.reservation.status?this.reservationsService.confirmReservation(this.reservation.id).subscribe(()=>{this.openSnackBar("Aceptaste la solicitud","Entendido"),this.reservationAccepted.emit()}):"checkout"===this.reservation.status&&this.reservationsService.confirmOrder(this.reservation.id).subscribe(()=>{this.openSnackBar("Aceptaste la solicitud de \xf3rdenes","Entendido"),setTimeout(()=>{this.reservationAccepted.emit()},2e3)}),Object(L.c)()}onReservationCancellation(){const e=this.dialog.open(H.a,{width:"540px",data:{reservationId:this.reservation.id}});this.afterModalClosesSubscription=e.afterClosed().subscribe(e=>{this.afterModalClosesSubscription.unsubscribe(),e&&this.reservationCancelled.emit()}),Object(L.c)()}openSnackBar(e,t){this.snackBar.open(e,t,{duration:2e3})}handleAddDish(e){const t=this.dialog.open(K.a,{width:"680px",height:"800px",panelClass:"no-padding",data:{orderId:e}});this.afterModalClosesSubscription=t.afterClosed().subscribe(e=>{e&&this.dishesChanged.emit(this.reservation.id)})}removeDishFromOrder(e,t){this.reservationService.removeDishFromOrder(e,t).subscribe(()=>{this.dishesChanged.emit(this.reservation.id)})}chatClickHandler(){this.reservationIdForChat=this.reservation.id}closeChat(){this.reservationIdForChat=void 0}closeReservation(e){this.reservationService.closeReservation(this.reservation.id,e).subscribe(()=>{this.reservationClosed.emit()})}getRatingStars(e){let t="";for(let n=0;n<e;n++)t+=" &#9733;";return t}}var Z=n("fx7b"),ee=n("iELJ"),te=n("6fQM"),ne=i.xb({encapsulation:0,styles:[[".reservation-header[_ngcontent-%COMP%]{position:relative;margin-bottom:16px;border:1px solid #f2f2f2;border-radius:4px;padding:24px;background-color:#fbfbfb}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]{display:-webkit-box;display:flex;padding-bottom:24px}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]:nth-child(n+2){margin-left:40px}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:start;justify-content:flex-start;-webkit-box-align:center;align-items:center}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]:nth-child(n+2){margin-top:16px}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;max-height:18px}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-left:12px;margin-bottom:0;color:#444;font-weight:500;white-space:nowrap}.reservation-header[_ngcontent-%COMP%]   .info-containers[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   p.date[_ngcontent-%COMP%]{text-transform:capitalize}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border-top:1px solid #f2f2f2;padding-top:24px;width:100%}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%]{margin-right:50px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]:nth-child(n+2), .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]:nth-child(n+2), .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%]:nth-child(n+2){border-left:1px solid #f2f2f2;padding-left:40px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance.tips[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating.tips[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips.tips[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-transform:none}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance.rating[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance.tips[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating.rating[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating.tips[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips.rating[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips.tips[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:5px;color:#7a7a7a;font-size:30px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#f2a412;text-transform:uppercase;font-weight:400;font-family:SF-UI}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:34px;font-weight:300;line-height:40px;display:-webkit-box;display:flex;-webkit-box-align:start;align-items:flex-start;font-family:SF-UI}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:10px;line-height:normal}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%] > span[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%] > span[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:-webkit-box;display:flex;margin-top:8px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:32px;color:#f2a412}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]:nth-child(n+2), .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]:nth-child(n+2), .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]:nth-child(n+2){margin-left:5px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .fill-star[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .fill-star[_ngcontent-%COMP%], .reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .tips[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]   .fill-star[_ngcontent-%COMP%]{font-size:32px;color:#e1e1e1}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .cta-section[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:start;justify-content:flex-start;-webkit-box-align:center;align-items:center;width:100%}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .cta-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-right:40px;text-align:center}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .cta-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:70px;height:70px}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .cta-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span.mat-button-wrapper[_ngcontent-%COMP%]{padding:23px 0}.reservation-header[_ngcontent-%COMP%]   .bottom-section[_ngcontent-%COMP%]   .cta-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{color:#7a7a7a}.reservation-comments[_ngcontent-%COMP%]{margin-top:16px;border-radius:4px;border:1px solid #f2f2f2;padding:20px 28px;background-color:#fbfbfb}.reservation-comments[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:500;font-size:14px;color:#444;line-height:22px}.reservation-comments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:4px;font-size:16px;font-style:italic;color:#7a7a7a;line-height:24px}.reservation-body[_ngcontent-%COMP%]{display:-webkit-box;display:flex;margin-top:16px;padding-bottom:16px;width:100%;overflow-x:auto}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]{border:1px solid #f2f2f2;border-radius:4px;min-width:318px;background-color:#fbfbfb;box-sizing:border-box}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]:nth-child(n+2){margin-left:16px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]{padding:20px 20px 16px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .commensal-number[_ngcontent-%COMP%]{font-size:12px;line-height:18px;color:#7a7a7a}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .name-container[_ngcontent-%COMP%]   .commensal-name[_ngcontent-%COMP%]{line-height:26px;font-size:16px;color:#3c3c3c}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .separation[_ngcontent-%COMP%]{width:calc(100% - 40px);margin:0 auto;height:1px;background-color:#f2f2f2}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]{padding:16px 24px;height:316px;overflow:auto}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]:nth-child(n+2){margin-top:12px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:start;justify-content:flex-start}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#444}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{width:24px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#444}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;margin-left:8px;cursor:pointer}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .ingredients-container[_ngcontent-%COMP%]{margin-top:2px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .ingredients-container[_ngcontent-%COMP%]   .ingredient[_ngcontent-%COMP%]{padding-left:24px;font-size:14px;font-weight:300;line-height:22px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .dishes-container[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]{font-size:11px;color:#a8a8a8;padding-left:24px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .add-dish-and-total[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;border-top:1px solid #f2f2f2;padding:16px 40px 24px 22px}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .add-dish-and-total.contains-add-dish-option[_ngcontent-%COMP%]{-webkit-box-pack:justify;justify-content:space-between}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .add-dish-and-total[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:14px;color:#f2a412;cursor:pointer}.reservation-body[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]   .add-dish-and-total[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{font-size:16px;color:#3c3c3c}"]],data:{}});function ie(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","balance"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Total "])),(e()(),i.zb(3,0,null,null,4,"h2",[],null,null,null,null,null)),(e()(),i.Xb(4,null,[" "," "])),i.Rb(5,2),(e()(),i.zb(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["MXN"]))],null,(function(e,t){var n=t.component,s=i.Yb(t,4,0,e(t,5,0,i.Ob(t.parent,0),n.total,"MXN"));e(t,4,0,s)}))}function se(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"button",[["class","big accept"],["mat-fab",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.onReservationConfirmation()&&i),i}),R.b,R.a)),i.yb(2,180224,null,0,j.b,[i.l,N.g,[2,U.a]],null,null),(e()(),i.zb(3,0,null,0,0,"img",[["alt",""],["height","24px"],["src","assets/images/icons/icon-accept.svg"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Aceptar"]))],null,(function(e,t){e(t,1,0,i.Ob(t,2).disabled||null,"NoopAnimations"===i.Ob(t,2)._animationMode)}))}function re(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"button",[["class","big"],["color","primary"],["mat-fab",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.chatClickHandler({assisted:!0})&&i),i}),R.b,R.a)),i.yb(2,180224,null,0,j.b,[i.l,N.g,[2,U.a]],{color:[0,"color"]},null),(e()(),i.zb(3,0,null,0,0,"img",[["alt",""],["height","24px"],["src","assets/images/icons/icon-chat.svg"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Chat"]))],(function(e,t){e(t,2,0,"primary")}),(function(e,t){e(t,1,0,i.Ob(t,2).disabled||null,"NoopAnimations"===i.Ob(t,2)._animationMode)}))}function oe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,10,"div",[["class","cta-section"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,se)),i.yb(2,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(3,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,2,"button",[["class","big"],["color","warn"],["mat-fab",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.onReservationCancellation()&&i),i}),R.b,R.a)),i.yb(5,180224,null,0,j.b,[i.l,N.g,[2,U.a]],{color:[0,"color"]},null),(e()(),i.zb(6,0,null,0,0,"img",[["alt",""],["height","24px"],["src","assets/images/icons/icon-reject.svg"]],null,null,null,null,null)),(e()(),i.zb(7,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Rechazar"])),(e()(),i.jb(16777216,null,null,1,null,re)),i.yb(10,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,"pending"===n.reservation.status||"checkout"===n.reservation.status),e(t,5,0,"warn"),e(t,10,0,"active"===n.reservation.status||"checkout"===n.reservation.status)}),(function(e,t){e(t,4,0,i.Ob(t,5).disabled||null,"NoopAnimations"===i.Ob(t,5)._animationMode)}))}function ae(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,12,"div",[["class","cta-section"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,2,"button",[["class","big accept"],["mat-fab",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeReservation({assisted:!0})&&i),i}),R.b,R.a)),i.yb(3,180224,null,0,j.b,[i.l,N.g,[2,U.a]],null,null),(e()(),i.zb(4,0,null,0,0,"img",[["alt",""],["height","24px"],["src","assets/images/icons/icon-accept.svg"]],null,null,null,null,null)),(e()(),i.zb(5,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Finalizar"])),(e()(),i.zb(7,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,2,"button",[["class","big not-assisted"],["color","warn"],["mat-fab",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeReservation({assisted:!1})&&i),i}),R.b,R.a)),i.yb(9,180224,null,0,j.b,[i.l,N.g,[2,U.a]],{color:[0,"color"]},null),(e()(),i.zb(10,0,null,0,0,"img",[["alt",""],["height","24px"],["src","assets/images/icons/no-asistio.svg"]],null,null,null,null,null)),(e()(),i.zb(11,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["No asisti\xf3"]))],(function(e,t){e(t,9,0,"warn")}),(function(e,t){e(t,2,0,i.Ob(t,3).disabled||null,"NoopAnimations"===i.Ob(t,3)._animationMode),e(t,8,0,i.Ob(t,9).disabled||null,"NoopAnimations"===i.Ob(t,9)._animationMode)}))}function le(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,7,"div",[["class","tips"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Propinas"])),(e()(),i.zb(3,0,null,null,4,"h2",[],null,null,null,null,null)),(e()(),i.Xb(4,null,[" "," "])),i.Rb(5,2),(e()(),i.zb(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["MXN"]))],null,(function(e,t){var n=t.component,s=i.Yb(t,4,0,e(t,5,0,i.Ob(t.parent,0),n.reservation.tips,"MXN"));e(t,4,0,s)}))}function ce(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,5,"div",[["class","rating"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Calificaci\xf3n"])),(e()(),i.zb(3,0,null,null,2,"span",[],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,0,"span",[["class","star"]],[[8,"innerHTML",1]],null,null,null,null)),(e()(),i.zb(5,0,null,null,0,"span",[["class","fill-star"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,4,0,n.getRatingStars(n.reservation.rating.score)),e(t,5,0,n.getRatingStars(5-n.reservation.rating.score))}))}function ue(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(1,null,[" \u201c",'" ']))],null,(function(e,t){var n=t.component;e(t,1,0,n.reservation.comments?n.reservation.comments:"")}))}function de(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(1,null,[" \u201c",'" ']))],null,(function(e,t){var n=t.component;e(t,1,0,n.reservation.rating&&n.reservation.rating.comment?n.reservation.rating.comment:"")}))}function he(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,0,"img",[["src","assets/images/icons/icon-delete-gray.svg"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.removeDishFromOrder(e.parent.parent.context.$implicit.id,e.parent.context.$implicit.uid)&&i),i}),null,null))],null,null)}function pe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[["class","ingredient"]],null,null,null,null,null)),(e()(),i.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.context.$implicit.name)}))}function fe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[["class","instructions"]],null,null,null,null,null)),(e()(),i.Xb(1,null,[" \u201c","\u201d "]))],null,(function(e,t){e(t,1,0,t.parent.context.$implicit.comments)}))}function ge(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,17,"div",[["class","dish"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,11,"div",[["class","header"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,4,"div",[["class","left-side"]],null,null,null,null,null)),(e()(),i.zb(3,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(4,null,["",""])),(e()(),i.zb(5,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(6,null,["",""])),(e()(),i.zb(7,0,null,null,5,"div",[["class","right-side"]],null,null,null,null,null)),(e()(),i.zb(8,0,null,null,2,"p",[],null,null,null,null,null)),(e()(),i.Xb(9,null,["",""])),i.Rb(10,2),(e()(),i.jb(16777216,null,null,1,null,he)),i.yb(12,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(13,0,null,null,2,"div",[["class","ingredients-container"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,pe)),i.yb(15,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.jb(16777216,null,null,1,null,fe)),i.yb(17,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,12,0,"checkout"===t.component.reservation.status),e(t,15,0,t.context.$implicit.modifiers),e(t,17,0,t.context.$implicit.comments)}),(function(e,t){e(t,4,0,t.context.$implicit.amount),e(t,6,0,t.context.$implicit.name);var n=i.Yb(t,9,0,e(t,10,0,i.Ob(t.parent.parent,0),t.context.$implicit.price_in_cents/100,"MXN"));e(t,9,0,n)}))}function me(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[["class","add"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.handleAddDish(e.parent.context.$implicit.id)&&i),i}),null,null)),(e()(),i.Xb(-1,null,[" + Agregar platillo "]))],null,null)}function ve(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,17,"div",[["class","order"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[["class","name-container"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,1,"p",[["class","commensal-number"]],null,null,null,null,null)),(e()(),i.Xb(3,null,["Comensal ",""])),(e()(),i.zb(4,0,null,null,1,"p",[["class","commensal-name"]],null,null,null,null,null)),(e()(),i.Xb(5,null,["",""])),(e()(),i.zb(6,0,null,null,0,"div",[["class","separation"]],null,null,null,null,null)),(e()(),i.zb(7,0,null,null,2,"div",[["class","dishes-container"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,ge)),i.yb(9,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.zb(10,0,null,null,7,"div",[["class","add-dish-and-total"]],null,null,null,null,null)),i.yb(11,278528,null,0,l.k,[i.t,i.u,i.l,i.F],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(12,{"contains-add-dish-option":0}),(e()(),i.jb(16777216,null,null,1,null,me)),i.yb(14,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(15,0,null,null,2,"p",[["class","total"]],null,null,null,null,null)),(e()(),i.Xb(16,null,[" Total "," "])),i.Rb(17,2)],(function(e,t){var n=t.component;e(t,9,0,t.context.$implicit.dishes);var i=e(t,12,0,"checkout"===n.reservation.status);e(t,11,0,"add-dish-and-total",i),e(t,14,0,"checkout"===n.reservation.status)}),(function(e,t){var n=t.component;e(t,3,0,t.context.index+1),e(t,5,0,t.context.$implicit.customerFullName);var s=i.Yb(t,16,0,e(t,17,0,i.Ob(t.parent,0),n.getTotalAmountPerDiner(t.context.$implicit.dishes),"MXN"));e(t,16,0,s)}))}function be(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-chat",[],null,[[null,"closeClicked"]],(function(e,t,n){var i=!0;return"closeClicked"===t&&(i=!1!==e.component.closeChat()&&i),i}),J,$)),i.yb(1,245760,null,0,F,[A.g,B,W.b],{reservationId:[0,"reservationId"],reservationCode:[1,"reservationCode"],clientName:[2,"clientName"]},{closeClicked:"closeClicked"})],(function(e,t){var n=t.component;e(t,1,0,n.reservationIdForChat,n.reservation.code,n.reservation.customerFullName)}),null)}function ye(e){return i.ac(0,[i.Pb(0,l.c,[i.v,i.k]),(e()(),i.zb(1,0,null,null,41,"div",[["class","reservation"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,30,"div",[["class","reservation-header"]],null,null,null,null,null)),(e()(),i.zb(3,0,null,null,18,"div",[["class","info-containers"]],null,null,null,null,null)),(e()(),i.zb(4,0,null,null,8,"div",[["class","column"]],null,null,null,null,null)),(e()(),i.zb(5,0,null,null,3,"div",[["class","data"]],null,null,null,null,null)),(e()(),i.zb(6,0,null,null,0,"img",[["alt",""],["src","assets/images/icons/icon-calendar.svg"]],null,null,null,null,null)),(e()(),i.zb(7,0,null,null,1,"p",[["class","date"]],null,null,null,null,null)),(e()(),i.Xb(8,null,[" "," "])),(e()(),i.zb(9,0,null,null,3,"div",[["class","data"]],null,null,null,null,null)),(e()(),i.zb(10,0,null,null,0,"img",[["alt",""],["src","assets/images/icons/icon-diners.svg"]],null,null,null,null,null)),(e()(),i.zb(11,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(12,null,[" "," "," "])),(e()(),i.zb(13,0,null,null,8,"div",[["class","column"]],null,null,null,null,null)),(e()(),i.zb(14,0,null,null,3,"div",[["class","data"]],null,null,null,null,null)),(e()(),i.zb(15,0,null,null,0,"img",[["alt",""],["src","assets/images/icons/icon-time.svg"]],null,null,null,null,null)),(e()(),i.zb(16,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(17,null,[" "," "])),(e()(),i.zb(18,0,null,null,3,"div",[["class","data"]],null,null,null,null,null)),(e()(),i.zb(19,0,null,null,0,"img",[["alt",""],["src","assets/images/icons/icon-sitting-area.svg"]],null,null,null,null,null)),(e()(),i.zb(20,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(21,null,[" "," "])),(e()(),i.zb(22,0,null,null,10,"div",[["class","bottom-section"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,ie)),i.yb(24,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,oe)),i.yb(26,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,ae)),i.yb(28,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,le)),i.yb(30,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,ce)),i.yb(32,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(33,0,null,null,6,"div",[["class","reservation-comments"]],null,null,null,null,null)),(e()(),i.zb(34,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Comentarios"])),(e()(),i.jb(16777216,null,null,1,null,ue)),i.yb(37,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,de)),i.yb(39,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(40,0,null,null,2,"div",[["class","reservation-body"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,ve)),i.yb(42,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.jb(16777216,null,null,1,null,be)),i.yb(44,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,24,0,"pending"!==n.reservation.status),e(t,26,0,!n.hasToUseAssistanceOptions&&"closed"!==n.reservation.status),e(t,28,0,n.hasToUseAssistanceOptions&&"closed"!==n.reservation.status),e(t,30,0,"closed"===n.reservation.status&&n.reservation.rating),e(t,32,0,"closed"===n.reservation.status&&n.reservation.rating),e(t,37,0,"closed"!==n.reservation.status),e(t,39,0,"closed"===n.reservation.status),e(t,42,0,n.reservation.orders),e(t,44,0,n.reservationIdForChat)}),(function(e,t){var n=t.component;e(t,8,0,n.reservation.fullDate),e(t,12,0,n.reservation.people,n.reservation.people>1?"comensales":"comensal"),e(t,17,0,n.reservation.fullTime),e(t,21,0,n.reservation.zoneName)}))}var _e=n("YHaq"),Ce=n("PDjf"),we=n("Y1Mv"),ke=n("Q2Ze"),xe=n("ZTz/"),Oe=n("7KAL"),Se=n("UhP/"),Me=n("9gLZ"),Pe=n("CeGm"),Te=n("H3DK"),Ee=n("SCoL"),Ie=n("TN/R"),Re=n("e6WT"),je=n("8sFK"),Ne=n("nmIE"),Ue=n("1O3W"),Ae=n("Wcq6");class De{constructor(e,t){this.router=e,this.fb=t,this.actionClicked=new i.o,this.activePeriodChanged=new i.o,this.dateChanged=new i.o,this.openMenu=!1,this.form=this.fb.group({activeReservationsPeriod:["today"],date:[new Date]})}activePeriodChangedHandler(e){this.activePeriodChanged.emit(e)}dateChangedHandler(e){this.dateChanged.emit(e)}logout(){Ae.auth().signOut().then(()=>{localStorage.clear(),this.router.navigate(["/login"])})}}var Le=n("iInd"),Fe=i.xb({encapsulation:0,styles:[[".dashboard-header[_ngcontent-%COMP%]{-webkit-box-pack:justify;justify-content:space-between;position:relative;padding-left:24px;padding-right:40px;height:74px;width:100%;background-color:#fff;box-shadow:0 1px 0 0 #f2f2f2,0 2px 4px 0 rgba(0,0,0,.02);z-index:2}.dashboard-header[_ngcontent-%COMP%], .dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]{-webkit-box-pack:start;justify-content:flex-start}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]   .section-name-action[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]   .section-name-action[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;line-height:21px;color:#3c3c3c}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{margin-left:16px}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding-bottom:0}.dashboard-header[_ngcontent-%COMP%]   .left-options[_ngcontent-%COMP%]   .grey-select[_ngcontent-%COMP%]{width:216px;margin-left:30px}.dashboard-header[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{border:1px solid #f2a412;border-radius:50%;width:38px;height:38px;cursor:pointer}.dashboard-header[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:none;position:absolute;top:44px;right:0;border-radius:4px;width:175px;box-shadow:0 0 6px 0 rgba(60,60,60,.12);z-index:3;background-color:#fff}.dashboard-header[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .menu.open[_ngcontent-%COMP%]{display:block}.dashboard-header[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;list-style:none}.dashboard-header[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:13px 0 13px 20px;color:#3c3c3c;font-size:14px;line-height:22px}  .mat-form-field-wrapper{padding-bottom:0}  .mat-form-field-wrapper .mat-form-field-flex{border-radius:4px;height:42px}  .mat-form-field-wrapper .mat-form-field-flex .mat-form-field-infix{border:0;padding:0;font-size:14px}  .mat-form-field-wrapper .mat-form-field-flex .mat-form-field-infix .mat-select .mat-select-trigger .mat-select-value{color:#7a7a7a}  .mat-form-field-wrapper .mat-form-field-flex .mat-form-field-infix .mat-select .mat-select-trigger .mat-select-arrow-wrapper{-webkit-transform:none;transform:none}  .mat-form-field-underline{display:none}  .mat-select-arrow{color:#f2a412}"]],data:{}});function ze(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,15,"mat-select",[["class","mat-select"],["formControlName","activeReservationsPeriod"],["role","listbox"]],[[1,"id",0],[1,"tabindex",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-required",0],[1,"aria-disabled",0],[1,"aria-invalid",0],[1,"aria-owns",0],[1,"aria-multiselectable",0],[1,"aria-describedby",0],[1,"aria-activedescendant",0],[2,"mat-select-disabled",null],[2,"mat-select-invalid",null],[2,"mat-select-required",null],[2,"mat-select-empty",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"valueChange"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(e,t,n){var s=!0,r=e.component;return"keydown"===t&&(s=!1!==i.Ob(e,4)._handleKeydown(n)&&s),"focus"===t&&(s=!1!==i.Ob(e,4)._onFocus()&&s),"blur"===t&&(s=!1!==i.Ob(e,4)._onBlur()&&s),"valueChange"===t&&(s=!1!==r.activePeriodChangedHandler(n)&&s),s}),we.b,we.a)),i.Sb(6144,null,ke.d,null,[xe.c]),i.yb(2,671744,null,0,A.j,[[3,A.c],[8,null],[8,null],[8,null],[2,A.A]],{name:[0,"name"]},null),i.Sb(2048,null,A.r,null,[A.j]),i.yb(4,2080768,null,3,xe.c,[Oe.c,i.h,i.A,Se.b,i.l,[2,Me.b],[2,A.u],[2,A.l],[2,ke.c],[6,A.r],[8,null],xe.a,N.j],null,{valueChange:"valueChange"}),i.Tb(603979776,1,{options:1}),i.Tb(603979776,2,{optionGroups:1}),i.Tb(603979776,3,{customTrigger:0}),i.yb(8,16384,null,0,A.s,[[4,A.r]],null,null),i.Sb(2048,null,Se.h,null,[xe.c]),(e()(),i.zb(10,0,null,1,2,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],(function(e,t,n){var s=!0;return"click"===t&&(s=!1!==i.Ob(e,11)._selectViaInteraction()&&s),"keydown"===t&&(s=!1!==i.Ob(e,11)._handleKeydown(n)&&s),s}),Pe.b,Pe.a)),i.yb(11,8568832,[[1,4]],0,Se.n,[i.l,i.h,[2,Se.h],[2,Se.m]],{value:[0,"value"]},null),(e()(),i.Xb(-1,0,["Reservaciones de hoy"])),(e()(),i.zb(13,0,null,1,2,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],(function(e,t,n){var s=!0;return"click"===t&&(s=!1!==i.Ob(e,14)._selectViaInteraction()&&s),"keydown"===t&&(s=!1!==i.Ob(e,14)._handleKeydown(n)&&s),s}),Pe.b,Pe.a)),i.yb(14,8568832,[[1,4]],0,Se.n,[i.l,i.h,[2,Se.h],[2,Se.m]],{value:[0,"value"]},null),(e()(),i.Xb(-1,0,["Pr\xf3ximas reservaciones"]))],(function(e,t){e(t,2,0,"activeReservationsPeriod"),e(t,4,0),e(t,11,0,"today"),e(t,14,0,"next")}),(function(e,t){e(t,0,1,[i.Ob(t,4).id,i.Ob(t,4).tabIndex,i.Ob(t,4)._getAriaLabel(),i.Ob(t,4)._getAriaLabelledby(),i.Ob(t,4).required.toString(),i.Ob(t,4).disabled.toString(),i.Ob(t,4).errorState,i.Ob(t,4).panelOpen?i.Ob(t,4)._optionIds:null,i.Ob(t,4).multiple,i.Ob(t,4)._ariaDescribedby||null,i.Ob(t,4)._getAriaActiveDescendant(),i.Ob(t,4).disabled,i.Ob(t,4).errorState,i.Ob(t,4).required,i.Ob(t,4).empty,i.Ob(t,8).ngClassUntouched,i.Ob(t,8).ngClassTouched,i.Ob(t,8).ngClassPristine,i.Ob(t,8).ngClassDirty,i.Ob(t,8).ngClassValid,i.Ob(t,8).ngClassInvalid,i.Ob(t,8).ngClassPending]),e(t,10,0,i.Ob(t,11)._getTabIndex(),i.Ob(t,11).selected,i.Ob(t,11).multiple,i.Ob(t,11).active,i.Ob(t,11).id,i.Ob(t,11)._getAriaSelected(),i.Ob(t,11).disabled.toString(),i.Ob(t,11).disabled),e(t,13,0,i.Ob(t,14)._getTabIndex(),i.Ob(t,14).selected,i.Ob(t,14).multiple,i.Ob(t,14).active,i.Ob(t,14).id,i.Ob(t,14)._getAriaSelected(),i.Ob(t,14).disabled.toString(),i.Ob(t,14).disabled)}))}function qe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,30,"mat-form-field",[["class","datepicker back-gray mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,Te.b,Te.a)),i.yb(1,7520256,null,9,ke.c,[i.l,i.h,[2,Se.f],[2,Me.b],[2,ke.a],Ee.a,i.A,[2,U.a]],null,null),i.Tb(603979776,4,{_controlNonStatic:0}),i.Tb(335544320,5,{_controlStatic:0}),i.Tb(603979776,6,{_labelChildNonStatic:0}),i.Tb(335544320,7,{_labelChildStatic:0}),i.Tb(603979776,8,{_placeholderChild:0}),i.Tb(603979776,9,{_errorChildren:1}),i.Tb(603979776,10,{_hintChildren:1}),i.Tb(603979776,11,{_prefixChildren:1}),i.Tb(603979776,12,{_suffixChildren:1}),(e()(),i.zb(11,0,null,3,2,"mat-label",[],null,null,null,null,null)),i.yb(12,16384,[[6,4],[7,4]],0,ke.f,[],null,null),(e()(),i.Xb(-1,null,["Reservaciones del"])),(e()(),i.zb(14,0,null,1,10,"input",[["class","mat-input-element mat-form-field-autofill-control"],["formControlName","date"],["matInput",""],["readonly",""]],[[1,"aria-haspopup",0],[1,"aria-owns",0],[1,"min",0],[1,"max",0],[8,"disabled",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0]],[[null,"dateChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"],[null,"keydown"],[null,"focus"]],(function(e,t,n){var s=!0,r=e.component;return"input"===t&&(s=!1!==i.Ob(e,15)._handleInput(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,15).onTouched()&&s),"compositionstart"===t&&(s=!1!==i.Ob(e,15)._compositionStart()&&s),"compositionend"===t&&(s=!1!==i.Ob(e,15)._compositionEnd(n.target.value)&&s),"input"===t&&(s=!1!==i.Ob(e,16)._onInput(n.target.value)&&s),"change"===t&&(s=!1!==i.Ob(e,16)._onChange()&&s),"blur"===t&&(s=!1!==i.Ob(e,16)._onBlur()&&s),"keydown"===t&&(s=!1!==i.Ob(e,16)._onKeydown(n)&&s),"blur"===t&&(s=!1!==i.Ob(e,23)._focusChanged(!1)&&s),"focus"===t&&(s=!1!==i.Ob(e,23)._focusChanged(!0)&&s),"input"===t&&(s=!1!==i.Ob(e,23)._onInput()&&s),"dateChange"===t&&(s=!1!==r.dateChangedHandler(n.value)&&s),s}),null,null)),i.yb(15,16384,null,0,A.d,[i.F,i.l,[2,A.a]],null,null),i.yb(16,147456,null,0,Ie.h,[i.l,[2,Se.a],[2,Se.d],[2,ke.c]],{matDatepicker:[0,"matDatepicker"]},{dateChange:"dateChange"}),i.Sb(1024,null,A.p,(function(e){return[e]}),[Ie.h]),i.Sb(1024,null,A.q,(function(e,t){return[e,t]}),[A.d,Ie.h]),i.yb(19,671744,null,0,A.j,[[3,A.c],[6,A.p],[8,null],[6,A.q],[2,A.A]],{name:[0,"name"]},null),i.Sb(2048,null,A.r,null,[A.j]),i.yb(21,16384,null,0,A.s,[[4,A.r]],null,null),i.Sb(2048,null,Re.a,null,[Ie.h]),i.yb(23,999424,null,0,Re.b,[i.l,Ee.a,[6,A.r],[2,A.u],[2,A.l],Se.b,[6,Re.a],je.a,i.A],{readonly:[0,"readonly"]},null),i.Sb(2048,[[4,4],[5,4]],ke.d,null,[Re.b]),(e()(),i.zb(25,0,null,4,3,"mat-datepicker-toggle",[["class","mat-datepicker-toggle"],["matSuffix",""]],[[1,"tabindex",0],[2,"mat-datepicker-toggle-active",null],[2,"mat-accent",null],[2,"mat-warn",null]],[[null,"focus"]],(function(e,t,n){var s=!0;return"focus"===t&&(s=!1!==i.Ob(e,27)._button.focus()&&s),s}),Ne.e,Ne.d)),i.yb(26,16384,[[12,4]],0,ke.g,[],null,null),i.yb(27,1753088,null,1,Ie.k,[Ie.i,i.h,[8,null]],{datepicker:[0,"datepicker"]},null),i.Tb(603979776,13,{_customIcon:0}),(e()(),i.zb(29,16777216,null,1,1,"mat-datepicker",[],null,null,null,Ne.f,Ne.c)),i.yb(30,180224,[["date",4]],0,Ie.f,[ee.e,Ue.c,i.A,i.R,Ie.a,[2,Se.a],[2,Me.b],[2,l.d]],null,null)],(function(e,t){e(t,16,0,i.Ob(t,30)),e(t,19,0,"date"),e(t,23,0,""),e(t,27,0,i.Ob(t,30))}),(function(e,t){e(t,0,1,["standard"==i.Ob(t,1).appearance,"fill"==i.Ob(t,1).appearance,"outline"==i.Ob(t,1).appearance,"legacy"==i.Ob(t,1).appearance,i.Ob(t,1)._control.errorState,i.Ob(t,1)._canLabelFloat,i.Ob(t,1)._shouldLabelFloat(),i.Ob(t,1)._hasFloatingLabel(),i.Ob(t,1)._hideControlPlaceholder(),i.Ob(t,1)._control.disabled,i.Ob(t,1)._control.autofilled,i.Ob(t,1)._control.focused,"accent"==i.Ob(t,1).color,"warn"==i.Ob(t,1).color,i.Ob(t,1)._shouldForward("untouched"),i.Ob(t,1)._shouldForward("touched"),i.Ob(t,1)._shouldForward("pristine"),i.Ob(t,1)._shouldForward("dirty"),i.Ob(t,1)._shouldForward("valid"),i.Ob(t,1)._shouldForward("invalid"),i.Ob(t,1)._shouldForward("pending"),!i.Ob(t,1)._animationsEnabled]),e(t,14,1,[i.Ob(t,16)._datepicker?"dialog":null,(null==i.Ob(t,16)._datepicker?null:i.Ob(t,16)._datepicker.opened)&&i.Ob(t,16)._datepicker.id||null,i.Ob(t,16).min?i.Ob(t,16)._dateAdapter.toIso8601(i.Ob(t,16).min):null,i.Ob(t,16).max?i.Ob(t,16)._dateAdapter.toIso8601(i.Ob(t,16).max):null,i.Ob(t,16).disabled,i.Ob(t,21).ngClassUntouched,i.Ob(t,21).ngClassTouched,i.Ob(t,21).ngClassPristine,i.Ob(t,21).ngClassDirty,i.Ob(t,21).ngClassValid,i.Ob(t,21).ngClassInvalid,i.Ob(t,21).ngClassPending,i.Ob(t,23)._isServer,i.Ob(t,23).id,i.Ob(t,23).placeholder,i.Ob(t,23).disabled,i.Ob(t,23).required,i.Ob(t,23).readonly&&!i.Ob(t,23)._isNativeSelect||null,i.Ob(t,23)._ariaDescribedby||null,i.Ob(t,23).errorState,i.Ob(t,23).required.toString()]),e(t,25,0,i.Ob(t,27).disabled?null:-1,i.Ob(t,27).datepicker&&i.Ob(t,27).datepicker.opened,i.Ob(t,27).datepicker&&"accent"===i.Ob(t,27).datepicker.color,i.Ob(t,27).datepicker&&"warn"===i.Ob(t,27).datepicker.color)}))}function Be(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,19,"div",[["class","dashboard-header"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,12,"div",[["class","left-options"]],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,2,"div",[["class","section-name-action"]],null,null,null,null,null)),(e()(),i.zb(3,0,null,null,1,"p",[["class","title"]],null,null,null,null,null)),(e()(),i.Xb(4,null,["",""])),(e()(),i.zb(5,0,null,null,8,"form",[["class","grey-select"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(e,t,n){var s=!0;return"submit"===t&&(s=!1!==i.Ob(e,7).onSubmit(n)&&s),"reset"===t&&(s=!1!==i.Ob(e,7).onReset()&&s),s}),null,null)),i.yb(6,16384,null,0,A.B,[],null,null),i.yb(7,540672,null,0,A.l,[[8,null],[8,null]],{form:[0,"form"]},null),i.Sb(2048,null,A.c,null,[A.l]),i.yb(9,16384,null,0,A.t,[[4,A.c]],null,null),(e()(),i.jb(16777216,null,null,1,null,ze)),i.yb(11,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,qe)),i.yb(13,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(14,0,null,null,5,"div",[["class","profile relative"]],null,null,null,null,null)),(e()(),i.zb(15,0,null,null,0,"div",[["class","backImg user relative"]],null,[[null,"click"]],(function(e,t,n){var i=!0,s=e.component;return"click"===t&&(i=0!=(s.openMenu=!s.openMenu)&&i),i}),null,null)),(e()(),i.zb(16,0,null,null,3,"ul",[["class","menu"]],[[2,"open",null]],null,null,null,null)),(e()(),i.zb(17,0,null,null,2,"li",[],null,[[null,"click"]],(function(e,t,n){var i=!0,s=e.component;return"click"===t&&(s.logout(),i=0!=(s.openMenu=!1)&&i),i}),null,null)),(e()(),i.zb(18,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Cerrar sesi\xf3n"]))],(function(e,t){var n=t.component;e(t,7,0,n.form),e(t,11,0,n.hasPeriodSelectToBeVisible),e(t,13,0,n.hasCalendarToBeVisible)}),(function(e,t){var n=t.component;e(t,4,0,n.sectionName),e(t,5,0,i.Ob(t,9).ngClassUntouched,i.Ob(t,9).ngClassTouched,i.Ob(t,9).ngClassPristine,i.Ob(t,9).ngClassDirty,i.Ob(t,9).ngClassValid,i.Ob(t,9).ngClassInvalid,i.Ob(t,9).ngClassPending),e(t,16,0,n.openMenu)}))}n("XL7Z"),n("xv9W"),n("NUHO"),n.d(t,"a",(function(){return We})),n.d(t,"b",(function(){return Qe}));var We=i.xb({encapsulation:0,styles:[['#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{position:absolute;top:74px;left:0;width:260px;height:inherit;box-shadow:inset -1px 0 0 0 #f2f2f2;background-color:#fff;overflow:auto}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%]{list-style-type:none}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:start;align-items:flex-start;border-bottom:1px solid #f2f2f2;padding:10px 20px 10px 24px;min-height:106;cursor:pointer;position:relative}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation.active[_ngcontent-%COMP%], #reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]:hover{background-color:#f2f2f2}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{cursor:default}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data.contains-timer[_ngcontent-%COMP%]{width:calc(100% - 48px)}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:100%;font-size:12px;line-height:18px;color:#7a7a7a;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p.code[_ngcontent-%COMP%], #reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p.name[_ngcontent-%COMP%]{font-size:14px;line-height:22px;font-weight:500}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p.code[_ngcontent-%COMP%]{color:#f2a412;text-transform:uppercase}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p.name[_ngcontent-%COMP%]{color:#444}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation[_ngcontent-%COMP%]   .reservations-data[_ngcontent-%COMP%]   p.date[_ngcontent-%COMP%]{text-transform:capitalize}#reservations[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%] > ul.reservations-list[_ngcontent-%COMP%] > .reservation.unread[_ngcontent-%COMP%]:before{content:"";position:absolute;left:7px;top:calc(50% - 6px);border-radius:50%;height:12px;width:12px;background-color:#ff4549}#reservations[_ngcontent-%COMP%]   main#content[_ngcontent-%COMP%]{margin:0 0 0 auto;width:calc(100% - 261px);min-height:100%}#reservations[_ngcontent-%COMP%]   main#content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{height:100%;overflow:auto}#reservations[_ngcontent-%COMP%]   main#content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{margin:0 auto}']],data:{animation:[{type:7,name:"items",definitions:[{type:1,expr:":enter",animation:[{type:6,styles:{transform:"scale(0.5)",opacity:0},offset:null},{type:4,styles:{type:6,styles:{transform:"scale(1)",opacity:1},offset:null},timings:"500ms ease-out"}],options:null},{type:1,expr:":leave",animation:[{type:3,steps:[{type:6,styles:{opacity:1,overflow:"hidden"},offset:null},{type:4,styles:{type:6,styles:{height:0,paddingTop:0,paddingBottom:0},offset:null},timings:"800ms ease"},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"200ms"}],options:null}],options:null}],options:{}}]}});function $e(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-reservations-empty-state",[],null,null,null,o,r)),i.yb(1,49152,null,0,s,[],{header:[0,"header"],subtitle:[1,"subtitle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.emptyReservationsHeader,n.emptyReservationsSubtitle)}),null)}function Ge(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,"pending"===t.parent.context.$implicit.status?"Solicitud de espacio":"Solicitud de \xf3rdenes")}))}function Ve(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[["class","date"]],null,null,null,null,null)),(e()(),i.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.parent.context.$implicit.fullDate)}))}function Xe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),i.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.parent.context.$implicit.customerPhone)}))}function Je(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-reservation-timer",[],null,[[null,"timeHasExpired"]],(function(e,t,n){var i=!0;return"timeHasExpired"===t&&(i=!1!==e.component.removeReservationFromList(n)&&i),i}),I,E)),i.yb(1,114688,null,0,T,[],{expiresAt:[0,"expiresAt"],reservationId:[1,"reservationId"]},{timeHasExpired:"timeHasExpired"})],(function(e,t){e(t,1,0,t.parent.context.$implicit.expires_at,t.parent.context.$implicit.id)}),null)}function He(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,17,"li",[["class","reservation"]],[[24,"@items",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.onReservationClick(e.context.$implicit.id)&&i),i}),null,null)),i.yb(1,278528,null,0,l.k,[i.t,i.u,i.l,i.F],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(2,{active:0,unread:1}),(e()(),i.zb(3,0,null,null,12,"div",[["class","reservations-data"]],null,null,null,null,null)),i.yb(4,278528,null,0,l.k,[i.t,i.u,i.l,i.F],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Qb(5,{"contains-timer":0}),(e()(),i.zb(6,0,null,null,1,"p",[["class","code"]],null,null,null,null,null)),(e()(),i.Xb(7,null,[" "," "])),(e()(),i.jb(16777216,null,null,1,null,Ge)),i.yb(9,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,Ve)),i.yb(11,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(12,0,null,null,1,"p",[["class","name"]],null,null,null,null,null)),(e()(),i.Xb(13,null,["",""])),(e()(),i.jb(16777216,null,null,1,null,Xe)),i.yb(15,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,Je)),i.yb(17,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=e(t,2,0,t.context.$implicit.id===t.component.selectedReservation.id,t.context.$implicit.is_new);e(t,1,0,"reservation",n);var i=e(t,5,0,"pending"===t.context.$implicit.status||"checkout"===t.context.$implicit.status);e(t,4,0,"reservations-data",i),e(t,9,0,"pending"===t.context.$implicit.status||"checkout"===t.context.$implicit.status),e(t,11,0,"active"===t.context.$implicit.status||"closed"===t.context.$implicit.status),e(t,15,0,t.context.$implicit.customerPhone),e(t,17,0,t.context.$implicit.expires_at&&("pending"===t.context.$implicit.status||"checkout"===t.context.$implicit.status))}),(function(e,t){e(t,0,0,void 0),e(t,7,0,t.context.$implicit.code?t.context.$implicit.code:""),e(t,13,0,t.context.$implicit.customerFullName)}))}function Ke(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-reservation",[],null,[[null,"reservationCancelled"],[null,"reservationAccepted"],[null,"reservationClosed"],[null,"dishesChanged"]],(function(e,t,n){var i=!0,s=e.component;return"reservationCancelled"===t&&(i=!1!==s.getReservations()&&i),"reservationAccepted"===t&&(i=!1!==s.getReservations()&&i),"reservationClosed"===t&&(i=!1!==s.getReservations()&&i),"dishesChanged"===t&&(i=!1!==s.getSelectedReservation(n)&&i),i}),ye,ne)),i.yb(1,49152,null,0,Q,[Z.a,W.b,ee.e,te.a],{reservation:[0,"reservation"],hasToUseAssistanceOptions:[1,"hasToUseAssistanceOptions"]},{reservationCancelled:"reservationCancelled",reservationAccepted:"reservationAccepted",dishesChanged:"dishesChanged",reservationClosed:"reservationClosed"})],(function(e,t){var n=t.component;e(t,1,0,n.reservation,n.hasToUseAssistanceOptions)}),null)}function Ye(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,11,"div",[["class","dashboard-content"],["id","reservations"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,3,"aside",[],null,null,null,null,null)),(e()(),i.zb(2,0,null,null,2,"ul",[["class","reservations-list"]],null,null,null,null,null)),(e()(),i.jb(16777216,null,null,1,null,He)),i.yb(4,278528,null,0,l.l,[i.R,i.N,i.t],{ngForOf:[0,"ngForOf"]},null),(e()(),i.zb(5,0,null,null,6,"main",[["id","content"]],null,null,null,null,null)),(e()(),i.zb(6,0,null,null,5,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,_e.b,_e.a)),i.yb(7,49152,null,0,Ce.a,[[2,U.a]],null,null),(e()(),i.zb(8,0,null,0,3,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),i.yb(9,16384,null,0,Ce.b,[],null,null),(e()(),i.jb(16777216,null,null,1,null,Ke)),i.yb(11,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,4,0,n.reservations),e(t,11,0,n.reservation.id)}),(function(e,t){e(t,6,0,"NoopAnimations"===i.Ob(t,7)._animationMode)}))}function Qe(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,6,"section",[["class","dashboard-section-container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"app-staff-header",[],null,[[null,"activePeriodChanged"],[null,"dateChanged"]],(function(e,t,n){var i=!0,s=e.component;return"activePeriodChanged"===t&&(i=!1!==s.reservationsPeriodChangedHandler(n)&&i),"dateChanged"===t&&(i=!1!==s.getReservations(void 0,n)&&i),i}),Be,Fe)),i.yb(2,49152,null,0,De,[Le.l,A.g],{sectionName:[0,"sectionName"],hasCalendarToBeVisible:[1,"hasCalendarToBeVisible"],hasPeriodSelectToBeVisible:[2,"hasPeriodSelectToBeVisible"]},{activePeriodChanged:"activePeriodChanged",dateChanged:"dateChanged"}),(e()(),i.jb(16777216,null,null,1,null,$e)),i.yb(4,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,null,1,null,Ye)),i.yb(6,16384,null,0,l.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.sectionTitle,n.hasCalendarToBeVisible,n.hasPeriodOfTimeLogicToBeActive),e(t,4,0,0===n.reservations.length),e(t,6,0,n.reservations.length>0)}),null)}},EJiy:function(e,t,n){"use strict";t.__esModule=!0;var i=o(n("F+2o")),s=o(n("+JPL")),r="function"==typeof s.default&&"symbol"==typeof i.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof s.default&&"symbol"===r(i.default)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":r(e)}},ENu8:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},EcEN:function(e,t,n){var i=n("xDdU"),s=n("xk4V"),r=s;r.v1=i,r.v4=s,e.exports=r},Eig5:function(e,t,n){"use strict";var i=v(n("4d7F")),s=v(n("gDS+")),r=v(n("14Xm")),o=v(n("D3Ub")),a=v(n("ql3t")),l=v(n("Yz+Y")),c=v(n("iCc5")),u=v(n("V7oC")),d=v(n("FYw3")),h=v(n("mRg0")),p=v(n("u8T8")),f=v(n("SEkw")),g=v(n("EJiy")),m=v(n("JO7F"));function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof p.default)return(0,p.default)(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Member=void 0;var y=n("+qE3"),_=n("iqZd"),C=n("yC9A"),w=n("C9Jq"),k=C.Logger.scope("Member"),x=function(e){function t(e,n,i,s){(0,c.default)(this,t);var r=(0,d.default)(this,(t.__proto__||(0,l.default)(t)).call(this));if(r.channel=n,r.services=e,r.state={attributes:_.parseAttributes(i.attributes,"Retrieved malformed attributes from the server for member: "+s,k),dateCreated:i.dateCreated?_.parseTime(i.dateCreated):null,dateUpdated:i.dateCreated?_.parseTime(i.dateUpdated):null,sid:s,typingTimeout:null,isTyping:!1,identity:i.identity||null,roleSid:i.roleSid||null,lastConsumedMessageIndex:(0,a.default)(i.lastConsumedMessageIndex)?i.lastConsumedMessageIndex:null,lastConsumptionTimestamp:i.lastConsumptionTimestamp?_.parseTime(i.lastConsumptionTimestamp):null,type:i.type||"chat",userInfo:i.userInfo},!i.identity&&!i.type)throw new Error("Received invalid Member object from server: Missing identity or type of Member.");return r}var n,i,p,f;return(0,h.default)(t,e),(0,u.default)(t,[{key:"_startTyping",value:function(e){var t=this;return clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.channel.emit("typingStarted",this),this.state.typingTimeout=setTimeout((function(){return t._endTyping()}),e),this}},{key:"_endTyping",value:function(){this.state.typingTimeout&&(this.state.isTyping=!1,this.emit("typingEnded",this),this.channel.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(e){var t=[],n=_.parseAttributes(e.attributes,"Retrieved malformed attributes from the server for member: "+this.state.sid,k);e.attributes&&!_.isDeepEqual(this.state.attributes,n)&&(this.state.attributes=n,t.push("attributes"));var i=_.parseTime(e.dateUpdated);e.dateUpdated&&i.getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=i,t.push("dateUpdated"));var s=_.parseTime(e.dateCreated);if(e.dateCreated&&s.getTime()!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=s,t.push("dateCreated")),e.roleSid&&this.state.roleSid!==e.roleSid&&(this.state.roleSid=e.roleSid,t.push("roleSid")),!(0,a.default)(e.lastConsumedMessageIndex)&&null!==e.lastConsumedMessageIndex||this.state.lastConsumedMessageIndex===e.lastConsumedMessageIndex||(this.state.lastConsumedMessageIndex=e.lastConsumedMessageIndex,t.push("lastConsumedMessageIndex")),e.lastConsumptionTimestamp){var r=new Date(e.lastConsumptionTimestamp);this.state.lastConsumptionTimestamp&&this.state.lastConsumptionTimestamp.getTime()===r.getTime()||(this.state.lastConsumptionTimestamp=r,t.push("lastConsumptionTimestamp"))}return t.length>0&&this.emit("updated",{member:this,updateReasons:t}),this}},{key:"getUserDescriptor",value:(f=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User Descriptor is not supported for this Member type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUserDescriptor(this.state.identity));case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"getUser",value:(p=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User is not supported for this Member type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"remove",value:(i=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.channel.removeMember(this));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateAttributes",value:(n=(0,o.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("editMemberAttributes",{channelSid:this.channel.sid,memberSid:this.sid,attributes:(0,s.default)(t)});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastConsumedMessageIndex",get:function(){return this.state.lastConsumedMessageIndex}},{key:"lastConsumptionTimestamp",get:function(){return this.state.lastConsumptionTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}}]),t}(y.EventEmitter);(function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=(0,m.default)(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);r>3&&o&&(0,f.default)(t,n,o)})([w.asyncTypeCheck(["string","number","boolean","object",w.literal(null)]),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",i.default)],x.prototype,"updateAttributes",null),t.Member=x},EvBC:function(e,t,n){"use strict";var i=r(n("iCc5")),s=r(n("V7oC"));function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0;var o=function(){function e(t){(0,i.default)(this,e);var n=(t=t||{}).Chat||t.IPMessaging||t||{};this.region=n.region||t.region,this.baseUrl=n.apiUri||n.typingUri||(this.region&&"us1"!==this.region?"https://aim."+this.region+".twilio.com":"https://aim.twilio.com"),this.typingIndicatorUri=this.baseUrl+"/v1/typing",this.typingIndicatorTimeoutOverride=n.typingIndicatorTimeoutOverride,this.httpCacheIntervalOverride=n.httpCacheIntervalOverride,this.consumptionReportIntervalOverride=n.consumptionReportIntervalOverride,this.userInfosToSubscribeOverride=n.userInfosToSubscribeOverride,this.retryWhenThrottledOverride=n.retryWhenThrottledOverride,this.backoffConfigOverride=n.backoffConfigOverride,this.productId=t.productId}return(0,s.default)(e,[{key:"typingIndicatorTimeoutDefault",get:function(){return 5e3}},{key:"httpCacheIntervalDefault",get:function(){return"PT5S"}},{key:"consumptionReportIntervalDefault",get:function(){return"PT5S"}},{key:"userInfosToSubscribeDefault",get:function(){return 100}},{key:"retryWhenThrottledDefault",get:function(){return!0}},{key:"backoffConfigDefault",get:function(){return{min:1e3,max:4e3,maxAttemptsCount:3}}}]),e}();t.Configuration=o},"F+2o":function(e,t,n){e.exports={default:n("UR8F"),__esModule:!0}},FYw3:function(e,t,n){"use strict";t.__esModule=!0;var i,s=(i=n("EJiy"))&&i.__esModule?i:{default:i};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,s.default)(t))&&"function"!=typeof t?e:t}},FgkJ:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},FkhZ:function(e,t,n){n("3+Ww"),n("C5kU"),n("ZY/g"),n("ZWGZ"),n("3P3t"),n("nhJU"),n("l+6R"),e.exports=n("VSTI").Map},FxMp:function(e,t,n){"use strict";var i=d(n("AyUB")),s=d(n("s3Ml")),r=d(n("rfXi")),o=d(n("Qv35")),a=d(n("Yz+Y")),l=d(n("iCc5")),c=d(n("FYw3")),u=d(n("mRg0"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SessionError=void 0;var h=function(e){function t(e,n){(0,l.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return i.name=i.constructor.name,i.message=e,i.code=n,Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=(new Error).stack,i}return(0,u.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,r.default)(arguments));return(0,s.default)(t,(0,a.default)(this)),t}return t.prototype=(0,i.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s.default?(0,s.default)(t,e):t.__proto__=e,t}(Error));t.SessionError=h},FyfS:function(e,t,n){e.exports={default:n("fUKC"),__esModule:!0}},GDZC:function(e,t,n){var i=n("bKEA"),s=n("ZDin").f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==r.call(e)?function(e){try{return s(e)}catch(t){return o.slice()}}(e):s(i(e))}},GQeE:function(e,t,n){e.exports={default:n("1GvH"),__esModule:!0}},GRew:function(e,t){t.f={}.propertyIsEnumerable},GfoU:function(e,t,n){var i=n("/F7N"),s=n("yQFZ");e.exports=function(e){return function(t,n){var r,o,a=String(s(t)),l=i(n),c=a.length;return l<0||l>=c?e?"":void 0:(r=a.charCodeAt(l))<55296||r>56319||l+1===c||(o=a.charCodeAt(l+1))<56320||o>57343?e?a.charAt(l):r:e?a.slice(l,l+2):o-56320+(r-55296<<10)+65536}}},GhSp:function(e,t,n){var i=n("d+lc"),s=n("+vXQ"),r=n("M5dz"),o=Object.defineProperty;t.f=n("C61u")?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),s)try{return o(e,t,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},H86R:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncListImpl=t.SyncList=void 0;const i=n("IMmU"),s=n("v2fs"),r=n("PyJ+"),o=n("PalJ"),a=n("BUbV"),l=n("1dR4"),c=n("/2MY"),u=n("9y9p"),d=n("oaU9"),h=n("PEWQ");class p extends a.SyncEntity{constructor(e,t,n){super(e,n),this.updateMergingQueue=new d.NamespacedMergingQueue((e,t)=>"number"==typeof t.ttl?{ttl:t.ttl}:e),this.cache=new u.Cache,this.descriptor=t,this.descriptor.date_updated=new Date(this.descriptor.date_updated)}get uri(){return this.descriptor.url}get revision(){return this.descriptor.revision}get lastEventId(){return this.descriptor.last_event_id}get links(){return this.descriptor.links}get dateExpires(){return this.descriptor.date_expires}static get type(){return"list"}get type(){return"list"}get indexName(){}get queryString(){}get sid(){return this.descriptor.sid}get uniqueName(){return this.descriptor.unique_name||null}get dateUpdated(){return this.descriptor.date_updated}async _addOrUpdateItemOnServer(e,t,n,i){const s={data:t};void 0!==i&&(s.ttl=i);const r=await this.services.network.post(e,s,n);return r.body.data=t,r.body.date_updated=new Date(r.body.date_updated),r.body}async push(e,t){let n=(t||{}).ttl;i.validateOptionalTtl(n);let s=await this._addOrUpdateItemOnServer(this.links.items,e,void 0,n),r=Number(s.index);return this._handleItemMutated(r,s.url,s.last_event_id,s.revision,e,s.date_updated,s.date_expires,!0,!1),this.cache.get(r)}async set(e,t,n){const s=n||{};return i.validateOptionalTtl(s.ttl),this.updateMergingQueue.squashAndAdd(e,s,n=>this._updateItemUnconditionally(e,t,n.ttl))}async _updateItemUnconditionally(e,t,n){let i=await this.get(e);const s=await this._addOrUpdateItemOnServer(i.uri,t,void 0,n);return this._handleItemMutated(e,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,!1,!1),this.cache.get(e)}async _updateItemWithIfMatch(e,t,n){const s=await this.get(e),r=t(i.deepClone(s.value));if(!r)return s;{const i=s.revision;try{const t=await this._addOrUpdateItemOnServer(s.uri,r,i,n);return this._handleItemMutated(e,t.url,t.last_event_id,t.revision,t.data,t.date_updated,t.date_expires,!1,!1),this.cache.get(e)}catch(o){if(412===o.status)return await this._getItemFromServer(e),this._updateItemWithIfMatch(e,t,n);throw o}}}async mutate(e,t,n){const s=n||{};return i.validateOptionalTtl(s.ttl),this.updateMergingQueue.add(e,s,n=>this._updateItemWithIfMatch(e,t,n.ttl))}async update(e,t,n){return this.mutate(e,e=>Object.assign(e,t),n)}async remove(e){let t=await this.get(e),n=await this.services.network.delete(t.uri);this._handleItemRemoved(e,n.body.last_event_id,void 0,new Date(n.body.date_updated),!1)}async get(e){return this.cache.get(e)||this._getItemFromServer(e)}async _getItemFromServer(e){let t=await this.queryItems({index:e});if(t.items.length<1)throw new r.SyncError(`No item with index ${e} found`,404,54151);return t.items[0]}async queryItems(e){e=e||{};const t=new s.UriBuilder(this.links.items).queryParam("From",e.from).queryParam("PageSize",e.limit).queryParam("Index",e.index).queryParam("PageToken",e.pageToken).queryParam("Order",e.order).build();let n=await this.services.network.get(t),i=n.body.items.map(e=>(e.date_updated=new Date(e.date_updated),this.cache.get(e.index)?this._handleItemMutated(e.index,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):this.cache.store(Number(e.index),new l.ListItem({index:Number(e.index),uri:e.url,revision:e.revision,lastEventId:e.last_event_id,dateUpdated:e.date_updated,dateExpires:e.date_expires,value:e.data}),e.last_event_id),this.cache.get(e.index))),r=n.body.meta;return new c.Paginator(i,e=>this.queryItems({pageToken:e}),r.previous_token,r.next_token)}async getItems(e){return i.validatePageSize((e=e||{}).pageSize),e.limit=e.pageSize||e.limit||50,e.order=e.order||"asc",this.queryItems(e)}async getContext(){if(!this.context){let e=await this.services.network.get(this.links.context);this._updateContextIfRequired(e.body.data,e.body.last_event_id)}return this.context}async setTtl(e){i.validateMandatoryTtl(e);try{const t={ttl:e},n=await this.services.network.post(this.uri,t);this.descriptor.date_expires=n.body.date_expires}catch(t){throw 404===t.status&&this.onRemoved(!1),t}}async setItemTtl(e,t){i.validateMandatoryTtl(t);let n=await this.get(e);const s={ttl:t},r=await this.services.network.post(n.uri,s);n.updateDateExpires(r.body.date_expires)}async removeList(){await this.services.network.delete(this.uri),this.onRemoved(!0)}onRemoved(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}shouldIgnoreEvent(e,t){return this.cache.isKnown(e,t)}_update(e,t){const n=Number(e.item_index);switch(e.date_created=new Date(e.date_created),e.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(n,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"list_item_added"===e.type,!0);break;case"list_item_removed":this._handleItemRemoved(n,e.id,e.item_data,e.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(e.context_data,e.id,e.date_created);break;case"list_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.list_revision)}_advanceLastEventId(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}_updateRootDateUpdated(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}_handleItemMutated(e,t,n,i,s,r,a,c,u){if(this.shouldIgnoreEvent(e,n))o.default.trace("Item ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(r);let o=this.cache.get(e);if(o)o.update(n,i,s,r),this.cache.store(e,o,n),void 0!==a&&o.updateDateExpires(a),this.emitItemMutationEvent(o,u,!1);else{let o=new l.ListItem({index:e,uri:t,lastEventId:n,revision:i,value:s,dateUpdated:r,dateExpires:a});this.cache.store(e,o,n),this.emitItemMutationEvent(o,u,c)}}}emitItemMutationEvent(e,t,n){this.broadcastEventToListeners(n?"itemAdded":"itemUpdated",{item:e,isLocal:!t})}_handleItemRemoved(e,t,n,i,s){this._updateRootDateUpdated(i),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{index:e,isLocal:!s,value:n})}_handleContextUpdate(e,t,n){this._updateRootDateUpdated(n),this._updateContextIfRequired(e,t)&&this.broadcastEventToListeners("contextUpdated",{context:e,isLocal:!1})}_updateContextIfRequired(e,t){return!this.contextEventId||t>this.contextEventId?(this.context=e,this.contextEventId=t,!0):(o.default.trace("Context update skipped, current:",this.lastEventId,", remote:",t),!1)}}t.SyncListImpl=p;class f extends h.default{constructor(e){super(),this.syncListImpl=e,this.syncListImpl.attach(this)}get uri(){return this.syncListImpl.uri}get revision(){return this.syncListImpl.revision}get lastEventId(){return this.syncListImpl.lastEventId}get links(){return this.syncListImpl.links}get dateExpires(){return this.syncListImpl.dateExpires}static get type(){return p.type}get type(){return p.type}get sid(){return this.syncListImpl.sid}get uniqueName(){return this.syncListImpl.uniqueName}get dateUpdated(){return this.syncListImpl.dateUpdated}async push(e,t){return this.ensureNotClosed(),this.syncListImpl.push(e,t)}async set(e,t,n){return this.ensureNotClosed(),this.syncListImpl.set(e,t,n)}async mutate(e,t,n){return this.ensureNotClosed(),this.syncListImpl.mutate(e,t,n)}async update(e,t,n){return this.ensureNotClosed(),this.syncListImpl.update(e,t,n)}async remove(e){return this.ensureNotClosed(),this.syncListImpl.remove(e)}async get(e){return this.ensureNotClosed(),this.syncListImpl.get(e)}async getContext(){return this.ensureNotClosed(),this.syncListImpl.getContext()}async getItems(e){return this.ensureNotClosed(),this.syncListImpl.getItems(e)}async setTtl(e){return this.ensureNotClosed(),this.syncListImpl.setTtl(e)}async setItemTtl(e,t){return this.ensureNotClosed(),this.syncListImpl.setItemTtl(e,t)}async removeList(){return this.ensureNotClosed(),this.syncListImpl.removeList()}close(){super.close(),this.syncListImpl.detach(this.listenerUuid)}}t.SyncList=f,t.default=f},HlZy:function(e,t,n){"use strict";var i=d(n("4d7F")),s=d(n("14Xm")),r=d(n("D3Ub")),o=d(n("Yz+Y")),a=d(n("iCc5")),l=d(n("V7oC")),c=d(n("FYw3")),u=d(n("mRg0"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Members=void 0;var h=n("+qE3"),p=n("Eig5"),f=n("yC9A").Logger.scope("Members"),g=function(e){function t(e,n,i){(0,a.default)(this,t);var s=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return s.services=n,s.channel=e,s.members=i,s}var n,d,h,g;return(0,u.default)(t,e),(0,l.default)(t,[{key:"unsubscribe",value:(g=(0,r.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rosterEntityPromise){e.next=6;break}return e.next=3,this.rosterEntityPromise;case 3:e.sent.close(),this.rosterEntityPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"subscribe",value:function(e){var t=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:e,mode:"open_existing"}).then((function(e){e.on("itemAdded",(function(e){f.debug(t.channel.sid+" itemAdded: "+e.item.key),t.upsertMember(e.item.key,e.item.value).then((function(e){t.emit("memberJoined",e)}))})),e.on("itemRemoved",(function(e){f.debug(t.channel.sid+" itemRemoved: "+e.key);var n=e.key;if(t.members.has(n)){var i=t.members.get(n);t.members.delete(n),t.emit("memberLeft",i)}})),e.on("itemUpdated",(function(e){f.debug(t.channel.sid+" itemUpdated: "+e.item.key),t.upsertMember(e.item.key,e.item.value)}));var n=[],s=t;return e.getItems().then((function e(t){return t.items.forEach((function(e){n.push(s.upsertMember(e.key,e.value))})),t.hasNextPage?t.nextPage().then(e):null})).then((function(){return i.default.all(n)})).then((function(){return e}))})).catch((function(e){throw t.rosterEntityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&f.error("Failed to get roster object for channel",t.channel.sid,e),f.debug("ERROR: Failed to get roster object for channel",t.channel.sid,e),e}))}},{key:"upsertMember",value:(h=(0,r.default)(s.default.mark((function e(t,n){var i,r=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this.members.get(t))){e.next=3;break}return e.abrupt("return",i._update(n));case 3:return i=new p.Member(this.services,this.channel,n,t),this.members.set(t,i),i.on("updated",(function(e){return r.emit("memberUpdated",e)})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getMembers",value:function(){var e=this;return this.rosterEntityPromise.then((function(){var t=[];return e.members.forEach((function(e){return t.push(e)})),t}))}},{key:"getMemberBySid",value:(d=(0,r.default)(s.default.mark((function e(t){var n=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise.then((function(){var e=n.members.get(t);if(!e)throw new Error("Member with SID "+t+" was not found");return e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getMemberByIdentity",value:(n=(0,r.default)(s.default.mark((function e(t){var n,i=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.abrupt("return",this.rosterEntityPromise.then((function(){if(i.members.forEach((function(e){e.identity===t&&(n=e)})),!n)throw new Error("Member with identity "+t+" was not found");return n})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"add",value:function(e){return this.services.session.addCommand("addMemberV2",{channelSid:this.channel.sid,username:e})}},{key:"invite",value:function(e){return this.services.session.addCommand("inviteMember",{channelSid:this.channel.sid,username:e})}},{key:"removeByIdentity",value:function(e){return this.services.session.addCommand("removeMember",{channelSid:this.channel.sid,username:e})}},{key:"removeBySid",value:function(e){return this.services.session.addCommand("removeMember",{channelSid:this.channel.sid,memberSid:e})}}]),t}(h.EventEmitter);t.Members=g},Huux:function(e,t,n){n("PJ8w")("Set")},I2ZF:function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0;return[n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]]].join("")}},I7B1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;const i=n("+qwt");t.Metadata=class{static getMetadata(e){"undefined"!=typeof navigator&&i.parse(navigator.userAgent);let t=e&&e.clientMetadata?e.clientMetadata:{};const n={env:i.name,envv:i.version,os:i.os.family,osv:i.os.version,osa:i.os.architecture,sdk:"js-default"};let s={};return["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"].filter(e=>e in t||e in n).forEach(e=>s[e]=e in t?t[e]:n[e]),s}}},"I90/":function(e,t,n){var i=n("aqg2"),s=n("zBWt")("iterator"),r=n("ig3W");e.exports=n("VSTI").getIteratorMethod=function(e){if(null!=e)return e[s]||e["@@iterator"]||r[i(e)]}},IMmU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateId=t.validatePageSize=t.validateMandatoryTtl=t.validateOptionalTtl=t.deepClone=void 0;const i=n("PyJ+");function s(e,t){if(t&&void 0===e)return;const n=typeof e;if("number"!==n||!(r(s=e)&&s>=0))throw new i.default(`Invalid TTL, expected a positive integer of type number, was ${"object"===n?"object":`'${e}' of type '${n}'`}`,400,54011);var s}function r(e){return!isNaN(parseInt(e))&&isFinite(e)}t.deepClone=function(e){return JSON.parse(JSON.stringify(e))},t.validateId=function(e){if(void 0===e)return;const t=typeof e;if("string"!==t)throw new Error(`Invalid ID type, expected a string, got '${t}'`)},t.validateOptionalTtl=function(e){s(e,!0)},t.validateMandatoryTtl=function(e){s(e,!1)},t.validatePageSize=function(e){var t;if(!(void 0===e||r(t=e)&&t>0))throw new i.default(`Invalid pageSize parameter. Expected a positive integer, was '${e}'.`,400,54455)}},IMt4:function(e,t,n){"use strict";var i=o(n("4d7F")),s=o(n("iCc5")),r=o(n("V7oC"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RestPaginator=void 0;var a=function(){function e(t,n,i,r){(0,s.default)(this,e),this.state={prevToken:i,nextToken:r,source:n,items:t}}return(0,r.default)(e,[{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):i.default.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):i.default.reject(new Error("No previous page"))}},{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}}]),e}();t.RestPaginator=a},IYKI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Close=void 0;const i=n("PmLG");t.Close=class extends i.AbstractMessage{constructor(){super(),this.method="close"}}},IouD:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{}},"Ir+t":function(e,t,n){n("3+Ww"),n("C5kU"),n("ZY/g"),n("xXl2"),n("Nlwn"),n("XLeT"),e.exports=n("VSTI").Promise},JAUQ:function(e,t,n){var i=n("ekG2");e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},JKKi:function(e,t,n){var i=n("d+lc"),s=n("ekG2"),r=n("8sL3");e.exports=function(e,t){if(i(e),s(t)&&t.constructor===e)return t;var n=r.f(e);return(0,n.resolve)(t),n.promise}},JO7F:function(e,t,n){e.exports={default:n("ZblS"),__esModule:!0}},JpO0:function(e,t,n){var i=n("CYMq"),s=n("znrX");n("czaS")("getPrototypeOf",(function(){return function(e){return s(i(e))}}))},Jt1Q:function(e,t,n){"use strict";var i=n("b08l"),s=n("ENu8"),r=n("kvAF"),o={};n("BRsN")(o,n("zBWt")("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=i(o,{next:s(1,n)}),r(e,t+" Iterator")}},KgOX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncMap=t.SyncMapImpl=void 0;const i=n("IMmU"),s=n("v2fs"),r=n("PyJ+"),o=n("PalJ"),a=n("BUbV"),l=n("mK5Q"),c=n("/2MY"),u=n("9y9p"),d=n("oaU9"),h=n("PEWQ");class p extends a.SyncEntity{constructor(e,t,n){super(e,n),this.updateMergingQueue=new d.NamespacedMergingQueue((e,t)=>"number"==typeof t.ttl?{ttl:t.ttl}:e),this.cache=new u.Cache,this.descriptor=t,this.descriptor.date_updated=new Date(this.descriptor.date_updated),t.items&&t.items.forEach(e=>{e.date_updated=new Date(e.date_updated),this.cache.store(e.key,new l.MapItem(e),e.last_event_id)})}get uri(){return this.descriptor.url}get links(){return this.descriptor.links}get revision(){return this.descriptor.revision}get lastEventId(){return this.descriptor.last_event_id}get dateExpires(){return this.descriptor.date_expires}static get type(){return"map"}get type(){return"map"}get indexName(){}get queryString(){}get sid(){return this.descriptor.sid}get uniqueName(){return this.descriptor.unique_name||null}get dateUpdated(){return this.descriptor.date_updated}async set(e,t,n){const s=n||{};return i.validateOptionalTtl(s.ttl),this.updateMergingQueue.squashAndAdd(e,s,n=>this._putItemUnconditionally(e,t,n.ttl))}async get(e){return this.cache.has(e)?this.cache.get(e):this._getItemFromServer(e)}async _getItemFromServer(e){let t=await this.queryItems({key:e});if(t.items.length<1)throw new r.SyncError(`No item with key ${e} found`,404,54201);return t.items[0]}async mutate(e,t,n){const s=n||{};return i.validateOptionalTtl(s.ttl),this.updateMergingQueue.add(e,s,n=>this._putItemWithIfMatch(e,t,n.ttl))}async update(e,t,n){return this.mutate(e,e=>Object.assign(e,t),n)}async _putItemUnconditionally(e,t,n){const i=await this._putItemToServer(e,t,void 0,n),s=i.item;return this._handleItemMutated(s.key,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,i.added,!1),this.cache.get(s.key)}async _putItemWithIfMatch(e,t,n){const s=await this.get(e).catch(t=>{if(404===t.status)return new l.MapItem({key:e,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw t});let r=t(i.deepClone(s.value));if(!r)return s;{let i=s.revision;try{const t=await this._putItemToServer(e,r,i,n),s=t.item;return this._handleItemMutated(s.key,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,t.added,!1),this.cache.get(s.key)}catch(o){if(412===o.status)return await this._getItemFromServer(e),this._putItemWithIfMatch(e,t,n);throw o}}}async _putItemToServer(e,t,n,i){const r=new s.UriBuilder(this.links.items).pathSegment(e).build(),o={data:t};void 0!==i&&(o.ttl=i);try{const e=await this.services.network.put(r,o,n),i=e.body;return i.data=t,i.date_updated=new Date(i.date_updated),{added:201===e.status.code,item:i}}catch(a){throw 404===a.status&&this.onRemoved(!1),a}}async remove(e){if(void 0===e)throw new Error("Key argument is invalid");let t=await this.get(e),n=await this.services.network.delete(t.uri);this._handleItemRemoved(e,n.body.last_event_id,void 0,new Date(n.body.date_updated),!1)}async queryItems(e){e=e||{};const t=new s.UriBuilder(this.links.items).queryParam("From",e.from).queryParam("PageSize",e.limit).queryParam("Key",e.key).queryParam("PageToken",e.pageToken).queryParam("Order",e.order).build();let n=await this.services.network.get(t),i=n.body.items.map(e=>(e.date_updated=new Date(e.date_updated),this.cache.get(e.key)?this._handleItemMutated(e.key,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):this.cache.store(e.key,new l.MapItem(e),e.last_event_id),this.cache.get(e.key)));const r=n.body.meta;return new c.Paginator(i,e=>this.queryItems({pageToken:e}),r.previous_token,r.next_token)}async getItems(e){return i.validatePageSize((e=e||{}).pageSize),e.limit=e.pageSize||e.limit||50,e.order=e.order||"asc",this.queryItems(e)}shouldIgnoreEvent(e,t){return this.cache.isKnown(e,t)}_update(e,t){switch(e.date_created=new Date(e.date_created),e.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(e.item_key,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"map_item_added"===e.type,!0);break;case"map_item_removed":this._handleItemRemoved(e.item_key,e.id,e.item_data,e.date_created,!0);break;case"map_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.map_revision)}_advanceLastEventId(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}_updateRootDateUpdated(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}_handleItemMutated(e,t,n,i,s,r,a,c,u){if(this.shouldIgnoreEvent(e,n))o.default.trace("Item ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(r);let o=this.cache.get(e);o?(o.update(n,i,s,r),this.cache.store(e,o,n),void 0!==a&&o.updateDateExpires(a),this.emitItemMutationEvent(o,u,!1)):(o=new l.MapItem({key:e,url:t,last_event_id:n,revision:i,data:s,date_updated:r,date_expires:a}),this.cache.store(e,o,n),this.emitItemMutationEvent(o,u,c))}}emitItemMutationEvent(e,t,n){this.broadcastEventToListeners(n?"itemAdded":"itemUpdated",{item:e,isLocal:!t})}_handleItemRemoved(e,t,n,i,s){this._updateRootDateUpdated(i),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{key:e,isLocal:!s,value:n})}onRemoved(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}async setTtl(e){i.validateMandatoryTtl(e);try{const t={ttl:e},n=await this.services.network.post(this.uri,t);this.descriptor.date_expires=n.body.date_expires}catch(t){throw 404===t.status&&this.onRemoved(!1),t}}async setItemTtl(e,t){i.validateMandatoryTtl(t);let n=await this.get(e);const s={ttl:t},r=await this.services.network.post(n.uri,s);n.updateDateExpires(r.body.date_expires)}async removeMap(){await this.services.network.delete(this.uri),this.onRemoved(!0)}}t.SyncMapImpl=p;class f extends h.Closeable{constructor(e){super(),this.syncMapImpl=e,this.syncMapImpl.attach(this)}get uri(){return this.syncMapImpl.uri}get links(){return this.syncMapImpl.links}get revision(){return this.syncMapImpl.revision}get lastEventId(){return this.syncMapImpl.lastEventId}get dateExpires(){return this.syncMapImpl.dateExpires}static get type(){return p.type}get type(){return p.type}get sid(){return this.syncMapImpl.sid}get uniqueName(){return this.syncMapImpl.uniqueName}get dateUpdated(){return this.syncMapImpl.dateUpdated}async set(e,t,n){return this.ensureNotClosed(),this.syncMapImpl.set(e,t,n)}async get(e){return this.ensureNotClosed(),this.syncMapImpl.get(e)}async mutate(e,t,n){return this.ensureNotClosed(),this.syncMapImpl.mutate(e,t,n)}async update(e,t,n){return this.ensureNotClosed(),this.syncMapImpl.update(e,t,n)}async remove(e){return this.ensureNotClosed(),this.syncMapImpl.remove(e)}async getItems(e){return this.ensureNotClosed(),this.syncMapImpl.getItems(e)}async setTtl(e){return this.ensureNotClosed(),this.syncMapImpl.setTtl(e)}async setItemTtl(e,t){return this.ensureNotClosed(),this.syncMapImpl.setItemTtl(e,t)}async removeMap(){this.ensureNotClosed(),await this.syncMapImpl.removeMap()}close(){super.close(),this.syncMapImpl.detach(this.listenerUuid)}}t.SyncMap=f,t.default=f},KnDq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryEvent=t.Telemetry=void 0;const i=n("NDb0");t.TelemetryEvent=class{constructor(e,t,n,i,s,r){this.start=e,this.end=t,this.title=n,this.details=i,this.id=s,this.type=r}},t.Telemetry=class extends i.AbstractMessage{constructor(e){super(),this.method="telemetry.v1",this.events=e}}},KtlF:function(e,t,n){var i=n("aqg2"),s=n("AjXP");e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return s(this)}}},"L+wn":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorage=void 0,t.SessionStorage=class{constructor(e,t){this.config=e,this.storageId=null;try{this.storage=t||sessionStorage}catch(n){}}storageKey(e,t){return`${this.storageId}::${e}::${t}`}get isReady(){return this.config.sessionStorageEnabled&&!!this.storageId}updateStorageId(e){this.storageId=e}store(e,t,n){return this.isReady?this._store(this.storageKey(e,t),n):null}read(e,t){return this.isReady?this._read(this.storageKey(e,t)):null}remove(e,t,n){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(e,t)),n&&this.storage.removeItem(this.storageKey(e,n))}catch(i){}}update(e,t,n,i){if(!this.isReady)return null;this._apply(this.storageKey(e,t),i),n&&this._apply(this.storageKey(e,n),i)}_store(e,t){try{this.storage.setItem(e,JSON.stringify(t))}catch(n){}}_read(e){try{let t=this.storage.getItem(e);if(t)return JSON.parse(t)}catch(t){}return null}_apply(e,t){let n=this._read(e);if(!n)return!1;this._store(e,Object.assign(n,t))}}},L5Xn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTests=t.createPatch=t.applyPatch=void 0;var i=n("b0Ca"),s=n("MJ8e"),r=n("RoUj");function o(e,t){var n=i.Pointer.fromJSON(t).evaluate(e);if(void 0!==n)return{op:"test",path:t,value:n.value}}t.applyPatch=function(e,t){return t.map((function(t){return s.apply(e,t)}))},t.createPatch=function(e,t,n){var s=new i.Pointer;return(n?function(e){return function t(n,i,s){var o=e(n,i,s);return Array.isArray(o)?o:r.diffAny(n,i,s,t)}}(n):r.diffAny)(e,t,s)},t.createTests=function(e,t){var n=new Array;return t.filter(r.isDestructive).forEach((function(t){var i=o(e,t.path);if(i&&n.push(i),"from"in t){var s=o(e,t.from);s&&n.push(s)}})),n}},L5mX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockReplyError=void 0;const i=n("7FP+");t.TwilsockReplyError=class extends i.TwilsockError{constructor(e,t){super(e),this.reply=t}}},L5pH:function(e,t){e.exports=function(){}},LHh4:function(e,t,n){"use strict";var i,s=n("7whZ"),r=n("rNHk")(0),o=n("ugGH"),a=n("40oJ"),l=n("By1P"),c=n("qwtH"),u=n("ekG2"),d=n("JAUQ"),h=n("JAUQ"),p=!s.ActiveXObject&&"ActiveXObject"in s,f=a.getWeak,g=Object.isExtensible,m=c.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(e){if(u(e)){var t=f(e);return!0===t?m(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(d(this,"WeakMap"),e,t)}},y=e.exports=n("M+fh")("WeakMap",v,b,c,!0,!0);h&&p&&(l((i=c.getConstructor(v,"WeakMap")).prototype,b),a.NEED=!0,r(["delete","has","get","set"],(function(e){var t=y.prototype,n=t[e];o(t,e,(function(t,s){if(u(t)&&!g(t)){this._f||(this._f=new i);var r=this._f[e](t,s);return"set"==e?this:r}return n.call(this,t,s)}))})))},LQWY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=t.objectType=t.hasOwnProperty=void 0,t.hasOwnProperty=Object.prototype.hasOwnProperty,t.objectType=function(e){return void 0===e?"undefined":null===e?"null":Array.isArray(e)?"array":typeof e},t.clone=function e(n){if(null==n||"object"!=typeof n)return n;if(n.constructor==Array){for(var i=n.length,s=new Array(i),r=0;r<i;r++)s[r]=e(n[r]);return s}var o={};for(var a in n)t.hasOwnProperty.call(n,a)&&(o[a]=e(n[a]));return o}},Li4W:function(e,t,n){n("1i29")("Set")},Lr1a:function(e,t,n){n("JpO0"),e.exports=n("VSTI").Object.getPrototypeOf},"M+fh":function(e,t,n){"use strict";var i=n("7whZ"),s=n("USwo"),r=n("40oJ"),o=n("S4vA"),a=n("BRsN"),l=n("iZ5/"),c=n("wlNh"),u=n("ukM9"),d=n("ekG2"),h=n("kvAF"),p=n("GhSp").f,f=n("rNHk")(0),g=n("C61u");e.exports=function(e,t,n,m,v,b){var y=i[e],_=y,C=v?"set":"add",w=_&&_.prototype,k={};return g&&"function"==typeof _&&(b||w.forEach&&!o((function(){(new _).entries().next()})))?(_=t((function(t,n){u(t,_,e,"_c"),t._c=new y,null!=n&&c(n,v,t[C],t)})),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;e in w&&(!b||"clear"!=e)&&a(_.prototype,e,(function(n,i){if(u(this,_,e),!t&&b&&!d(n))return"get"==e&&void 0;var s=this._c[e](0===n?0:n,i);return t?this:s}))})),b||p(_.prototype,"size",{get:function(){return this._c.size}})):(_=m.getConstructor(t,e,v,C),l(_.prototype,n),r.NEED=!0),h(_,e),k[e]=_,s(s.G+s.W+s.F,k),b||m.setStrong(_,e,v),_}},M5dz:function(e,t,n){var i=n("ekG2");e.exports=function(e,t){if(!i(e))return e;var n,s;if(t&&"function"==typeof(n=e.toString)&&!i(s=n.call(e)))return s;if("function"==typeof(n=e.valueOf)&&!i(s=n.call(e)))return s;if(!t&&"function"==typeof(n=e.toString)&&!i(s=n.call(e)))return s;throw TypeError("Can't convert object to primitive value")}},MBy0:function(e,t,n){n("4Zg2")("asyncIterator")},MJ8e:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.apply=t.InvalidOperationError=t.test=t.copy=t.move=t.replace=t.remove=t.add=t.TestError=t.MissingError=void 0;var r=n("b0Ca"),o=n("LQWY"),a=n("NjAj"),l=function(e){function t(t){var n=e.call(this,"Value required at path: "+t)||this;return n.path=t,n.name="MissingError",n}return s(t,e),t}(Error);t.MissingError=l;var c=function(e){function t(t,n){var i=e.call(this,"Test failed: "+t+" != "+n)||this;return i.actual=t,i.expected=n,i.name="TestError",i}return s(t,e),t}(Error);function u(e,t,n){if(Array.isArray(e))if("-"==t)e.push(n);else{var i=parseInt(t,10);e.splice(i,0,n)}else e[t]=n}function d(e,t){if(Array.isArray(e)){var n=parseInt(t,10);e.splice(n,1)}else delete e[t]}function h(e,t){var n=r.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.parent?new l(t.path):(u(n.parent,n.key,o.clone(t.value)),null)}function p(e,t){var n=r.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.value?new l(t.path):(d(n.parent,n.key),null)}function f(e,t){var n=r.Pointer.fromJSON(t.path).evaluate(e);if(null===n.parent)return new l(t.path);if(Array.isArray(n.parent)){if(parseInt(n.key,10)>=n.parent.length)return new l(t.path)}else if(void 0===n.value)return new l(t.path);return n.parent[n.key]=t.value,null}function g(e,t){var n=r.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new l(t.from);var i=r.Pointer.fromJSON(t.path).evaluate(e);return void 0===i.parent?new l(t.path):(d(n.parent,n.key),u(i.parent,i.key,n.value),null)}function m(e,t){var n=r.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new l(t.from);var i=r.Pointer.fromJSON(t.path).evaluate(e);return void 0===i.parent?new l(t.path):(u(i.parent,i.key,o.clone(n.value)),null)}function v(e,t){var n=r.Pointer.fromJSON(t.path).evaluate(e);return a.compare(n.value,t.value)?null:new c(n.value,t.value)}t.TestError=c,t.add=h,t.remove=p,t.replace=f,t.move=g,t.copy=m,t.test=v;var b=function(e){function t(t){var n=e.call(this,"Invalid operation: "+t.op)||this;return n.operation=t,n.name="InvalidOperationError",n}return s(t,e),t}(Error);t.InvalidOperationError=b,t.apply=function(e,t){switch(t.op){case"add":return h(e,t);case"remove":return p(e,t);case"replace":return f(e,t);case"move":return g(e,t);case"copy":return m(e,t);case"test":return v(e,t)}return new b(t)}},MZ0W:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.Logger=void 0;const i=n("XH0y").getLogger("twilsock");function s(e,t){return[`${(new Date).toISOString()} Twilsock ${e}:`].concat(Array.from(t))}class r{constructor(e){this.prefix="",this.prefix=null!=e&&e.length>0?" "+e+":":""}setLevel(e){i.setLevel(e)}static setLevel(e){i.setLevel(e)}trace(...e){i.debug.apply(null,s("T",e))}debug(...e){i.debug.apply(null,s("D",e))}info(...e){i.info.apply(null,s("I",e))}warn(...e){i.warn.apply(null,s("W",e))}error(...e){i.error.apply(null,s("E",e))}static trace(...e){i.trace.apply(null,s("T",e))}static debug(...e){i.debug.apply(null,s("D",e))}static info(...e){i.info.apply(null,s("I",e))}static warn(...e){i.warn.apply(null,s("W",e))}static error(...e){i.error.apply(null,s("E",e))}}t.Logger=r;let o=new r("");t.log=o},MrV2:function(e,t,n){var i=n("USwo");i(i.S,"Number",{isInteger:n("PAC6")})},N4c9:function(e,t,n){n("wYM1");var i=n("VSTI").Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},"N7/N":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("s7LF"),s=n("quSY");class r{constructor(e,t,n,r,o){this.data=e,this.dialogRef=t,this.fB=n,this.reservationsService=r,this.snackBar=o,this.form=this.fB.group({motive:["",[i.x.required,i.x.maxLength(400)]]}),this.cancellationSubscription=s.a.EMPTY,this.visibleContent="motiveForm"}ngOnDestroy(){this.cancellationSubscription.unsubscribe()}requestCancellation(){if(this.form.valid){const e=this.form.get("motive").value;this.cancellationSubscription=this.reservationsService.cancelReservation(this.data.reservationId,e).subscribe(()=>{this.cancellationSubscription.unsubscribe(),this.closeDialog(!0),this.openSnackBar("Cancelaste la solicitud","Entendido")})}}closeDialog(e){this.dialogRef.close(e)}openSnackBar(e,t){this.snackBar.open(e,t,{duration:2e3})}setVisibleSection(e){this.visibleContent=e}}},NDb0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessage=void 0;const i=n("EcEN");t.AbstractMessage=class{constructor(e){this.id=e||`TM${i.v4()}`}}},NRBv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InitReply=t.ContinuationTokenStatus=void 0;const i=n("NDb0");t.ContinuationTokenStatus=class{},t.InitReply=class extends i.AbstractMessage{constructor(e,t,n,i,s,r,o){super(e),this.continuationToken=t,this.continuationTokenStatus=n,this.offlineStorage=i,this.initRegistrations=s,this.debugInfo=r,this.confirmedCapabilities=o}}},NjAj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compare=void 0;var i=n("LQWY");t.compare=function e(t,n){if(t===n)return!0;var s=i.objectType(t),r=i.objectType(n);return"array"==s&&"array"==r?function(t,n){var i=t.length;if(i!==n.length)return!1;for(var s=0;s<i;s++)if(!e(t[s],n[s]))return!1;return!0}(t,n):"object"==s&&"object"==r&&function(t,n){var s=Object.keys(t),r=Object.keys(n),o=s.length;if(o!==r.length)return!1;for(var a=0;a<o;a++){var l=s[a];if(!i.hasOwnProperty.call(n,l)||!e(t[l],n[l]))return!1}return!0}(t,n)}},Nlwn:function(e,t,n){"use strict";var i=n("USwo"),s=n("VSTI"),r=n("7whZ"),o=n("2zfi"),a=n("JKKi");i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,s.Promise||r.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})},ODRq:function(e,t,n){e.exports={default:n("FkhZ"),__esModule:!0}},"OS/M":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{}},OTpG:function(e,t,n){"use strict";var i=n("5ETA"),s=n("USwo"),r=n("ugGH"),o=n("BRsN"),a=n("ig3W"),l=n("Jt1Q"),c=n("kvAF"),u=n("znrX"),d=n("zBWt")("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,f,g,m,v){l(n,t,f);var b,y,_,C=function(e){if(!h&&e in O)return O[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",k="values"==g,x=!1,O=e.prototype,S=O[d]||O["@@iterator"]||g&&O[g],M=S||C(g),P=g?k?C("entries"):M:void 0,T="Array"==t&&O.entries||S;if(T&&(_=u(T.call(new e)))!==Object.prototype&&_.next&&(c(_,w,!0),i||"function"==typeof _[d]||o(_,d,p)),k&&S&&"values"!==S.name&&(x=!0,M=function(){return S.call(this)}),i&&!v||!h&&!x&&O[d]||o(O,d,M),a[t]=M,a[w]=p,g)if(b={values:k?M:C("values"),keys:m?M:C("keys"),entries:P},v)for(y in b)y in O||r(O,y,b[y]);else s(s.P+s.F*(h||x),t,b);return b}},Oa1h:function(e,t,n){var i=n("bKEA"),s=n("0WpP"),r=n("nRFE");e.exports=function(e){return function(t,n,o){var a,l=i(t),c=s(l.length),u=r(o,c);if(e&&n!=n){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},OnFN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Media=class{constructor(e,t,n){this.config=e,this.network=t,this._update(n)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}async getContentUrl(){let e=await this.network.get(`${this.config.baseUrl}/${this.sid}`);return this._update(e.body),Promise.resolve(this.state.contentDirectUrl)}_update(e){this.state={sid:e.sid,serviceSid:e.service_sid,channelSid:e.channel_sid,messageSid:e.message_sid,dateCreated:e.date_created?new Date(e.date_created):null,dateUpdated:e.date_updated?new Date(e.date_updated):null,size:e.size,contentType:e.content_type,url:e.url,contentUrl:e.links.content,contentDirectUrl:e.links.content_direct_temporary,filename:e.filename?e.filename:null}}}},OxZ0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PacketInterface=t.PacketResponse=void 0;const i=n("uShU"),s=n("EcEN"),r=n("7FP+"),o=n("L5mX"),a=n("CQrr"),l=n("w7D8"),c=n("BG5D");t.PacketResponse=class{},t.PacketInterface=class{constructor(e,t){this.config=t,this.activeRequests=new Map,this.channel=e,this.channel.on("reply",e=>this.processReply(e)),this.channel.on("disconnected",()=>{this.activeRequests.forEach(e=>{clearTimeout(e.timeout),e.reject(new r.TwilsockError("disconnected"))}),this.activeRequests.clear()})}get isConnected(){return this.channel.isConnected}processReply(e){const t=this.activeRequests.get(e.id);var n;t&&(clearTimeout(t.timeout),this.activeRequests.delete(e.id),(n=e.status.code)>=200&&n<300?t.resolve(e):(t.reject(new o.TwilsockReplyError("Transport failure: "+e.status.status,e)),i.log.trace("message rejected")))}storeRequest(e,t,n){let s={resolve:t,reject:n,timeout:setTimeout(()=>{i.log.trace("request",e,"is timed out"),n(new r.TwilsockError("Twilsock: request timeout: "+e))},3e4)};this.activeRequests.set(e,s)}shutdown(){this.activeRequests.forEach(e=>{clearTimeout(e.timeout),e.reject(new r.TwilsockError("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}async sendInit(){i.log.trace("sendInit");let e=c.Metadata.getMetadata(this.config),t=new l.Init(this.config.token,this.config.continuationToken,e,this.config.initRegistrations,this.config.tweaks),n=await this.sendWithReply(t);return new l.InitReply(n.id,n.header.continuation_token,n.header.continuation_token_status,n.header.offline_storage,n.header.init_registrations,n.header.debug_info,new Set(n.header.capabilities))}sendClose(){let e=new l.Close;this.send(e)}sendWithReply(e,t){return new Promise((n,i)=>{let s=this.send(e,t);this.storeRequest(s,n,i)})}send(e,t){e.id=e.id||`TM${s.v4()}`;let n=a.Parser.createPacket(e,function(e){switch(typeof e){case"undefined":return"";case"object":return JSON.stringify(e);default:return e}}(t));try{return this.channel.send(n),e.id}catch(r){throw i.log.debug("failed to send ",e,r),i.log.trace(r.stack),r}}}},P15O:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InitReply=t.ContinuationTokenStatus=void 0;const i=n("PmLG");t.ContinuationTokenStatus=class{},t.InitReply=class extends i.AbstractMessage{constructor(e,t,n,i,s,r,o){super(e),this.continuationToken=t,this.continuationTokenStatus=n,this.offlineStorage=i,this.initRegistrations=s,this.debugInfo=r,this.confirmedCapabilities=o}}},P2sY:function(e,t,n){e.exports={default:n("uccp"),__esModule:!0}},PAC6:function(e,t,n){var i=n("ekG2"),s=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&s(e)===e}},PDjf:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o}));class i{}class s{constructor(e){this._animationMode=e}}class r{}class o{}class a{}},PEWQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Closeable=void 0;const i=n("+qE3"),s=n("EcEN");class r extends i.EventEmitter{constructor(){super(),this.closed=!1,this.uuid=s()}get listenerUuid(){return this.uuid}close(){this.removeAllListeners(),this.closed=!0}ensureNotClosed(){if(this.closed)throw new Error("Invalid operation on closed object")}}t.Closeable=r,t.default=r},PJ8w:function(e,t,n){"use strict";var i=n("USwo");e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},PWsN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntitiesCache=void 0,t.EntitiesCache=class{constructor(){this.names=new Map,this.entities=new Map}store(e){return this.entities.get(e.sid)||(this.entities.set(e.sid,e),e.uniqueName&&this.names.set(e.type+"::"+e.uniqueName,e.sid),e)}getResolved(e,t){let n=this.names.get(t+"::"+e);return n?this.entities.get(n):null}get(e,t){return this.entities.get(e)||this.getResolved(e,t)||null}remove(e){let t=this.entities.get(e);t&&(this.entities.delete(e),t.uniqueName&&this.names.delete(t.type+"::"+t.uniqueName))}}},PalJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("XH0y").getLogger("twilio-sync");function s(e,t){return[`${(new Date).toISOString()} Sync ${e}:`].concat(Array.from(t))}t.default={setLevel:function(e){i.setLevel(e)},trace:function(...e){i.trace.apply(null,s("T",e))},debug:function(...e){i.debug.apply(null,s("D",e))},info:function(...e){i.info.apply(null,s("I",e))},warn:function(...e){i.warn.apply(null,s("W",e))},error:function(...e){i.error.apply(null,s("E",e))}}},PfQu:function(e,t,n){"use strict";var i=n("rdj4"),s=n("JAUQ");e.exports=n("M+fh")("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return i.def(s(this,"Set"),e=0===e?0:e,e)}},i)},PmLG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessage=void 0;const i=n("EcEN");t.AbstractMessage=class{constructor(e){this.id=e||`TM${i.v4()}`}}},"PyJ+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncNetworkError=t.SyncError=void 0;class i extends Error{constructor(e,t=0,n=0){super(),this.name=this.constructor.name,this.message=`${e} (status: ${t}, code: ${n})`,this.status=t,this.code=n}}t.SyncError=i,t.SyncNetworkError=class extends i{constructor(e,t=0,n=0,i){super(e,t,n),this.body=i}},t.default=i},Q3x1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.Logger=void 0;const i=n("XH0y");function s(e,t){return[`${(new Date).toISOString()} Notifications ${e}:`].concat(Array.from(t))}class r{constructor(){this.prefix=""}static scope(e=""){return new r}setLevel(e){i.setLevel(e)}trace(...e){i.debug.apply(null,s("T"+this.prefix,e))}debug(...e){i.debug.apply(null,s("D"+this.prefix,e))}info(...e){i.info.apply(null,s("I"+this.prefix,e))}warn(...e){i.warn.apply(null,s("W"+this.prefix,e))}error(...e){i.error.apply(null,s("E"+this.prefix,e))}}t.Logger=r;let o=r.scope();t.log=o},QQLf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;const i=n("PalJ");class s{constructor(e){this.config=e.config,this.subscriptions=e.subscriptions,this.notifications=e.notifications,this.notifications.subscribe("twilio.sync.event"),this.notifications.subscribe("com.twilio.rtd.cds.document"),this.notifications.subscribe("com.twilio.rtd.cds.list"),this.notifications.subscribe("com.twilio.rtd.cds.map"),this.notifications.on("message",(e,t)=>this.onMessage(e,t)),this.notifications.on("transportReady",e=>this.onConnectionStateChanged(e))}onMessage(e,t){switch(i.default.trace("Notification type:",e,"content:",t),e){case"com.twilio.rtd.cds.document":case"com.twilio.rtd.cds.list":case"com.twilio.rtd.cds.map":this.subscriptions.acceptMessage(t,!1);break;case"twilio.sync.event":this.subscriptions.acceptMessage(t,!0)}}subscribe(e,t){this.subscriptions.add(e,t)}unsubscribe(e){this.subscriptions.remove(e)}onConnectionStateChanged(e){this.subscriptions.onConnectionStateChanged(e)}}t.Router=s,t.default=s},QRdY:function(e,t,n){n("xfML"),e.exports=n("VSTI").Object.setPrototypeOf},Qv35:function(e,t,n){e.exports={default:n("UWlV"),__esModule:!0}},RoUj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diffAny=t.diffObjects=t.diffArrays=t.intersection=t.subtract=t.isDestructive=void 0;var i=n("NjAj"),s=n("LQWY");function r(e,t){var n={};for(var i in e)s.hasOwnProperty.call(e,i)&&void 0!==e[i]&&(n[i]=1);for(var r in t)s.hasOwnProperty.call(t,r)&&void 0!==t[r]&&delete n[r];return Object.keys(n)}function o(e){for(var t=e.length,n={},i=0;i<t;i++){var r=e[i];for(var o in r)s.hasOwnProperty.call(r,o)&&void 0!==r[o]&&(n[o]=(n[o]||0)+1)}for(var o in n)n[o]<t&&delete n[o];return Object.keys(n)}function a(e,t){return{operations:e.operations.concat(t),cost:e.cost+1}}function l(e,t,n,s){void 0===s&&(s=u);var r={"0,0":{operations:[],cost:0}},o=isNaN(e.length)||e.length<=0?0:e.length,l=isNaN(t.length)||t.length<=0?0:t.length;return function n(s,o){var l=s+","+o,c=r[l];if(void 0===c){if(s>0&&o>0&&i.compare(e[s-1],t[o-1]))c=n(s-1,o-1);else{var u=[];if(s>0){var d=n(s-1,o);u.push(a(d,{op:"remove",index:s-1}))}if(o>0){var h=n(s,o-1);u.push(a(h,{op:"add",index:s-1,value:t[o-1]}))}if(s>0&&o>0){var p=n(s-1,o-1);u.push(a(p,{op:"replace",index:s-1,original:e[s-1],value:t[o-1]}))}c=u.sort((function(e,t){return e.cost-t.cost}))[0]}r[l]=c}return c}(o,l).operations.reduce((function(e,t){var i=e[0],r=e[1];if(function(e){return"add"===e.op}(t)){var a=t.index+1+r,l=a<o+r?String(a):"-",c={op:t.op,path:n.add(l).toString(),value:t.value};return[i.concat(c),r+1]}if(function(e){return"remove"===e.op}(t))return c={op:t.op,path:n.add(String(t.index+r)).toString()},[i.concat(c),r-1];var u=n.add(String(t.index+r)),d=s(t.original,t.value,u);return[i.concat.apply(i,d),r]}),[[],0])[0]}function c(e,t,n,i){void 0===i&&(i=u);var s=[];return r(e,t).forEach((function(e){s.push({op:"remove",path:n.add(e).toString()})})),r(t,e).forEach((function(e){s.push({op:"add",path:n.add(e).toString(),value:t[e]})})),o([e,t]).forEach((function(r){s.push.apply(s,i(e[r],t[r],n.add(r)))})),s}function u(e,t,n,i){if(void 0===i&&(i=u),e===t)return[];var r=s.objectType(e),o=s.objectType(t);return"array"==r&&"array"==o?l(e,t,n,i):"object"==r&&"object"==o?c(e,t,n,i):[{op:"replace",path:n.toString(),value:t}]}t.isDestructive=function(e){var t=e.op;return"remove"===t||"replace"===t||"copy"===t||"move"===t},t.subtract=r,t.intersection=o,t.diffArrays=l,t.diffObjects=c,t.diffAny=u},RpkJ:function(e,t,n){var i=n("ZWGZ"),s=n("USwo"),r=n("s2er")("metadata"),o=r.store||(r.store=new(n("LHh4"))),a=function(e,t,n){var s=o.get(e);if(!s){if(!n)return;o.set(e,s=new i)}var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}return r};e.exports={store:o,map:a,has:function(e,t,n){var i=a(t,n,!1);return void 0!==i&&i.has(e)},get:function(e,t,n){var i=a(t,n,!1);return void 0===i?void 0:i.get(e)},set:function(e,t,n,i){a(n,i,!0).set(e,t)},keys:function(e,t){var n=a(e,t,!1),i=[];return n&&n.forEach((function(e,t){i.push(t)})),i},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){s(s.S,"Reflect",e)}}},S4vA:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},S6HK:function(e,t,n){"use strict";var i=n("FgkJ"),s=n("ekG2"),r=n("Temt"),o=[].slice,a={},l=function(e,t,n){if(!(t in a)){for(var i=[],s=0;s<t;s++)i[s]="a["+s+"]";a[t]=Function("F,a","return new F("+i.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=i(this),n=o.call(arguments,1),a=function(){var i=n.concat(o.call(arguments));return this instanceof a?l(t,i.length,i):r(t,i,e)};return s(t.prototype)&&(a.prototype=t.prototype),a}},SEkw:function(e,t,n){e.exports={default:n("N4c9"),__esModule:!0}},SGKw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenStorage=void 0;class i{static get sessionStorage(){try{return global.sessionStorage}catch(e){return null}}static get window(){try{return global.window}catch(e){return null}}static storeToken(e,t){i.canStore&&i.sessionStorage.setItem(i.getKeyName(t),e)}static getStoredToken(e){return i.canStore?i.sessionStorage.getItem(i.getKeyName(e)):null}static initialize(){i.canStore&&(i.sessionStorage.getItem(i.initializedFlag)&&this.clear(),i.sessionStorage.setItem(i.initializedFlag,"true"),i.window.addEventListener("unload",()=>{i.sessionStorage.removeItem(i.initializedFlag)}))}static clear(){if(i.canStore){let e=[];for(let t=0;t<i.sessionStorage.length;t++){const n=i.sessionStorage.key(t);0===n.indexOf(i.tokenStoragePrefix)&&e.push(n)}e.forEach(e=>i.sessionStorage.removeItem(e)),i.sessionStorage.removeItem(i.initializedFlag)}}static getKeyName(e){return`${i.tokenStoragePrefix}${e}`}static get canStore(){return i.sessionStorage&&i.window}}t.TokenStorage=i,i.initializedFlag="twilio_twilsock_token_storage",i.tokenStoragePrefix="twilio_continuation_token_",i.initialize()},SkeG:function(e,t,n){"use strict";var i=n("GhSp"),s=n("ENu8");e.exports=function(e,t,n){t in e?i.f(e,t,s(0,n)):e[t]=n}},SwMz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncMapItem=t.SyncMap=t.SyncListItem=t.SyncList=t.SyncDocument=t.SyncClient=void 0;const i=n("zs2D");Object.defineProperty(t,"SyncClient",{enumerable:!0,get:function(){return i.SyncClient}});const s=n("oUms");Object.defineProperty(t,"SyncDocument",{enumerable:!0,get:function(){return s.SyncDocument}});const r=n("H86R");Object.defineProperty(t,"SyncList",{enumerable:!0,get:function(){return r.SyncList}});const o=n("1dR4");Object.defineProperty(t,"SyncListItem",{enumerable:!0,get:function(){return o.ListItem}});const a=n("KgOX");Object.defineProperty(t,"SyncMap",{enumerable:!0,get:function(){return a.SyncMap}});const l=n("mK5Q");Object.defineProperty(t,"SyncMapItem",{enumerable:!0,get:function(){return l.MapItem}}),t.default=i.SyncClient,e.exports=i.SyncClient,e.exports.SyncClient=i.SyncClient},Sxqd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0,t.Configuration=class{constructor(e,t,n={}){this.confirmedCapabilities=new Set,this.activeGrant=t,this._token=e,this.url=(n.twilsock||n.Twilsock||{}).uri||`wss://tsock.${n.region||"us1"}.twilio.com/v3/wsconnect`,this._continuationToken=n.continuationToken?n.continuationToken:null,this.logLevel=n.logLevel?n.logLevel:"error",this.retryPolicy=n.retryPolicy?n.retryPolicy:{min:1e3,max:12e4,randomness:.2},this.clientMetadata=n.clientMetadata?n.clientMetadata:{},this.clientMetadata.ver="0.5.14",this.initRegistrations=n.initRegistrations?n.initRegistrations:null,this.tweaks=n.tweaks?n.tweaks:null}get token(){return this._token}get continuationToken(){return this._continuationToken}updateToken(e){this._token=e}updateContinuationToken(e){this._continuationToken=e}}},SzqN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientInfo=void 0;const i=n("+qwt");class s{constructor(e){this.sdk="js",this.sdkVer=e,this.os=i.os.family,this.osVer=i.os.version,this.pl=i.name,this.plVer=i.version}}t.ClientInfo=s,t.default=s},TSC6:function(e,t,n){var i=n("GRew"),s=n("ENu8"),r=n("bKEA"),o=n("M5dz"),a=n("nA4W"),l=n("+vXQ"),c=Object.getOwnPropertyDescriptor;t.f=n("C61u")?c:function(e,t){if(e=r(e),t=o(t,!0),l)try{return c(e,t)}catch(n){}if(a(e,t))return s(!i.f.call(e,t),e[t])}},TYje:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},TZCi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockReplyError=void 0;const i=n("arZA");t.TwilsockReplyError=class extends i.TwilsockError{constructor(e,t){super(e),this.reply=t}}},Temt:function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},TnF5:function(e,t,n){n("4Zg2")("observable")},Trx6:function(e,t,n){var i=n("TYje");e.exports=Array.isArray||function(e){return"Array"==i(e)}},UR8F:function(e,t,n){n("C5kU"),n("ZY/g"),e.exports=n("/NTb").f("iterator")},USwo:function(e,t,n){var i=n("7whZ"),s=n("VSTI"),r=n("nAx8"),o=n("BRsN"),a=n("nA4W"),l=function(e,t,n){var c,u,d,h=e&l.F,p=e&l.G,f=e&l.S,g=e&l.P,m=e&l.B,v=e&l.W,b=p?s:s[t]||(s[t]={}),y=b.prototype,_=p?i:f?i[t]:(i[t]||{}).prototype;for(c in p&&(n=t),n)(u=!h&&_&&void 0!==_[c])&&a(b,c)||(d=u?_[c]:n[c],b[c]=p&&"function"!=typeof _[c]?n[c]:m&&u?r(d,i):v&&_[c]==d?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):g&&"function"==typeof d?r(Function.call,d):d,g&&((b.virtual||(b.virtual={}))[c]=d,e&l.R&&y&&!y[c]&&o(y,c,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},UWlV:function(e,t,n){n("XVPX"),e.exports=n("VSTI").Reflect.construct},Ut7X:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;const i=n("PmLG");t.Message=class extends i.AbstractMessage{constructor(e,t,n){super(),this.method="message",this.active_grant=e,this.payload_type=t,this.http_request=n}}},V6L8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockImpl=t.TwilsockChannel=t.Response=void 0;const i=n("+qE3"),s=n("xDTo"),r=n("MZ0W"),o=n("bldR"),a=n("ioUz"),l=n("TZCi"),c=n("cRVY");t.Response=class{};class u extends i.EventEmitter{constructor(e,t,n){super(),this.terminalStates=["disconnected","rejected"],this.lastEmittedState=void 0,this.tokenExpiredSasCode=20104,this.terminationReason="Connection is not initialized",this.websocket=e,this.websocket.on("connected",()=>this.fsm.socketConnected()),this.websocket.on("disconnected",e=>this.fsm.socketClosed()),this.websocket.on("message",e=>this.onIncomingMessage(e)),this.websocket.on("socketError",e=>this.emit("connectionError",{terminal:!1,message:e.message,httpStatusCode:null,errorCode:null})),this.transport=t,this.config=n,this.retrier=new c.BackoffRetrier(n.retryPolicy),this.retrier.on("attempt",()=>this.retry()),this.retrier.on("failed",e=>{r.log.warn(`Retrying failed: ${e.message}`),this.disconnect()}),"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",()=>{r.log.debug("Browser reported connectivity state: online"),this.fsm.systemOnline()}),window.addEventListener("offline",()=>{r.log.debug("Browser reported connectivity state: offline"),this.websocket.close(),this.fsm.socketClosed()})),this.fsm=new s({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:()=>{this.setupSocket(),this.emit("connecting")},onEnterInitialising:()=>{this.sendInit()},onLeaveInitialising:()=>{this.cancelInit()},onEnterUpdating:()=>{this.sendUpdate()},onLeaveUpdating:()=>{this.cancelUpdate()},onEnterRetrying:()=>{this.initRetry(),this.emit("connecting")},onEnterConnected:()=>{this.resetBackoff(),this.onConnected()},onUserUpdateToken:()=>{this.resetBackoff()},onTokenRejected:()=>{this.resetBackoff(),this.closeSocket(!0),this.finalizeSocket()},onUserDisconnect:()=>{this.closeSocket(!0)},onEnterDisconnecting:()=>{this.startDisconnectTimer()},onLeaveDisconnecting:()=>{this.cancelDisconnectTimer()},onEnterWaitSocketClosed:()=>{this.startDisconnectTimer()},onLeaveWaitSocketClosed:()=>{this.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:()=>{this.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:()=>{this.cancelDisconnectTimer()},onDisconnected:()=>{this.resetBackoff(),this.finalizeSocket()},onReceiveClose:(e,t)=>{this.onCloseReceived(t)},onReceiveOffload:(e,t)=>{r.log.debug("onreceiveoffload: ",t),this.modifyBackoff(t.body),this.onCloseReceived(t.status)},onUnsupported:()=>{this.closeSocket(!0),this.finalizeSocket()},onError:(e,t)=>{this.closeSocket(t),this.finalizeSocket()},onEnterState:e=>{"none"!==e.from&&this.changeState(e)},onInvalidTransition:(e,t,n)=>{r.log.warn("FSM: unexpected transition",t,n)}}})}changeState(e){r.log.debug(`FSM: ${e.transition}: ${e.from} --\x3e ${e.to}`),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}resetBackoff(){r.log.trace("resetBackoff"),this.retrier.stop()}modifyBackoff(e){r.log.trace("modifyBackoff",e);let t=e?e.backoff_policy:null;t&&"number"==typeof t.reconnect_min_ms&&this.retrier.modifyBackoff(t.reconnect_min_ms)}startDisconnectTimer(){r.log.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(()=>{r.log.debug("disconnecting is timed out"),this.closeSocket(!0)},3e3)}cancelDisconnectTimer(){r.log.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}get isConnected(){return"connected"===this.state&&this.websocket.isConnected}get state(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"rejected";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}initRetry(){r.log.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}retry(){"connecting"!=this.fsm.state?(r.log.trace("retry"),this.websocket.close(),this.fsm.userRetry()):r.log.trace("can\t retry as already connecting")}onConnected(){this.emit("connected")}finalizeSocket(){r.log.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}setupSocket(){r.log.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}onIncomingMessage(e){let{method:t,header:n,payload:i}=a.Parser.parse(e);if("reply"!==t&&this.confirmReceiving(n),"notification"===t)this.emit("message",n.message_type,i);else if("reply"===n.method)this.transport.processReply({id:n.id,status:n.status,header:n,body:i});else if("client_update"===n.method)"token_about_to_expire"===n.client_update_type&&this.emit("tokenAboutToExpire");else if("close"===n.method)if(308===n.status.code)r.log.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:n.status.status,body:i});else if(406===n.status.code){const e=`Server closed connection because can't parse protocol: ${JSON.stringify(n.status)}`;this.emitReplyConnectionError(e,n,!0),r.log.error(e),this.fsm.receiveFatalClose()}else 417===n.status.code?(r.log.error(`Server closed connection because can't parse client reply: ${JSON.stringify(n.status)}`),this.fsm.receiveFatalClose(n.status.status)):410===n.status.code?(r.log.warn(`Server closed connection: ${JSON.stringify(n.status)}`),this.fsm.receiveClose(n.status.status),this.emit("tokenExpired")):401===n.status.code?(r.log.error(`Server closed connection: ${JSON.stringify(n.status)}`),this.fsm.receiveClose(n.status.status)):(r.log.warn("unexpected message: ",n.status),this.fsm.receiveOffload({status:n.status.status,body:null}))}async sendInit(){r.log.trace("sendInit");try{this.emit("beforeSendInit");let e=await this.transport.sendInit();this.config.updateContinuationToken(e.continuationToken),this.config.confirmedCapabilities=e.confirmedCapabilities,this.fsm.initSuccess(e),this.emit("initialized",e),this.emit("tokenUpdated")}catch(e){if(e instanceof l.TwilsockReplyError){let t=!1;r.log.warn(`Init rejected by server: ${JSON.stringify(e.reply.status)}`),this.emit("sendInitFailed"),401===e.reply.status.code||403===e.reply.status.code?(t=!0,this.fsm.tokenRejected(e.reply.status),e.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.reply.status.code?(this.modifyBackoff(e.reply.body),this.fsm.initError(!0)):this.fsm.initError(500!==e.reply.status.code),this.emitReplyConnectionError(e.message,e.reply,t)}else this.terminationReason=e.message,this.emit("connectionError",{terminal:!0,message:e.message,httpStatusCode:null,errorCode:null}),this.fsm.initError(!0);this.emit("tokenUpdated",e)}}async sendUpdate(){r.log.trace("sendUpdate");let e=new o.Update(this.config.token);try{let t=await this.transport.sendWithReply(e);this.fsm.updateSuccess(t.body),this.emit("tokenUpdated")}catch(t){if(t instanceof l.TwilsockReplyError){let e=!1;r.log.warn(`Token update rejected by server: ${JSON.stringify(t.reply.status)}`),401===t.reply.status.code||403===t.reply.status.code?(e=!0,this.fsm.tokenRejected(t.reply.status),t.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===t.reply.status.code?(this.modifyBackoff(t.reply.body),this.fsm.updateError(t.reply.status)):this.fsm.updateError(t.reply.status),this.emitReplyConnectionError(t.message,t.reply,e)}else this.emit("error",!1,t.message,null,null),this.fsm.updateError(t);this.emit("tokenUpdated",t)}}emitReplyConnectionError(e,t,n){const i=t.status&&t.status.description?t.status.description:e,s=t.status.code,r=t.status&&t.status.errorCode?t.status.errorCode:null;n&&(this.terminationReason=i),this.emit("connectionError",{terminal:n,message:i,httpStatusCode:s,errorCode:r})}cancelInit(){r.log.trace("cancelInit")}cancelUpdate(){r.log.trace("cancelUpdate")}confirmReceiving(e){r.log.trace("confirmReceiving");try{this.transport.send(new o.Reply(e.id))}catch(t){r.log.debug("failed to confirm packet receiving",t)}}closeSocket(e){r.log.trace(`closeSocket (graceful: ${e})`),e&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),setTimeout(()=>this.fsm.socketClosed(),0)}connect(){r.log.trace("connect"),this.fsm.userConnect()}disconnect(){return r.log.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(e=>{this.disconnectedPromiseResolve=e,this.fsm.userDisconnect()})}updateToken(e){return r.log.trace("updateToken:",e),new Promise((e,t)=>{this.once("tokenUpdated",n=>{n?t(n):e()}),this.fsm.userUpdateToken()})}get isTerminalState(){return-1!==this.terminalStates.indexOf(this.fsm.state)}get getTerminationReason(){return this.terminationReason}onCloseReceived(e){this.websocket.close()}}t.TwilsockChannel=u,t.TwilsockImpl=u},V7oC:function(e,t,n){"use strict";t.__esModule=!0;var i,s=(i=n("SEkw"))&&i.__esModule?i:{default:i};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()},V86R:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("auUO"),s=global.XMLHttpRequest||n(7).XMLHttpRequest;class r{constructor(){}static request(e,t,n,r){return new Promise((o,a)=>{let l=new s;l.open(e,t,!0),l.onreadystatechange=function(){if(4!==l.readyState)return;const e=(t=l.getAllResponseHeaders())?t.split("\r\n").map(e=>e.split(": ")).filter(e=>2===e.length&&e[1].length>0).reduce((e,t)=>(e[t[0]]=t[1],e),{}):{};var t;const n=function(e){const t=e.getResponseHeader("Content-Type");if(!t||0!==t.indexOf("application/json")||0===e.responseText.length)return e.responseText;try{return JSON.parse(e.responseText)}catch(n){return e.responseText}}(l);if(200<=l.status&&l.status<300)o({status:l.status,headers:e,body:n});else{const t=l.statusText&&l.statusText.code?l.statusText.code:"NONE";let s;s="string"==typeof n?n&&1===n.split("\n",2).length?n:"":JSON.stringify(n),a(new i.TransportError(`${l.status}: [${t}] ${s}`,l.status,n,t,e))}};for(let e in n)l.setRequestHeader(e,n[e]),"Content-Type"===e&&"application/json"===n[e]&&(r=JSON.stringify(r));l.send(r)})}get(e,t){return r.request("GET",e,t)}post(e,t,n){return r.request("POST",e,t,n)}}t.Transport=r},VSTI:function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},VaU9:function(e,t,n){"use strict";var i=a(n("4d7F")),s=a(n("ODRq")),r=a(n("V7oC")),o=a(n("iCc5"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ConsumptionHorizon=void 0;var l=n("FxMp"),c=function(){function e(t){(0,o.default)(this,e),this.services=t,this.consumptionHorizonRequests=new s.default,this.consumptionHorizonUpdateTimer=null}return(0,r.default)(e,[{key:"getReportInterval",value:function(){return this.services.session.getConsumptionReportInterval().then((function(e){return 1e3*e}))}},{key:"delayedSendConsumptionHorizon",value:function(e){var t=this;null===this.consumptionHorizonUpdateTimer&&(this.sendConsumptionReport(!0),this.consumptionHorizonUpdateTimer=setTimeout((function(){t.sendConsumptionReport(!1)}),e))}},{key:"sendConsumptionReport",value:function(e){var t=this,n=[],i=new s.default;this.consumptionHorizonRequests.forEach((function(e,t){n.push(e.entry),i.set(t,e.promises)})),n.length>0&&this.services.session.addCommand("consumptionReportV2",{report:n}).then((function(e){return t.processConsumptionReportResponse(e,i)})).catch((function(e){return t.processConsumptionReportError(e,i)})),e||(this.consumptionHorizonUpdateTimer=null),this.consumptionHorizonRequests.clear()}},{key:"processConsumptionReportResponse",value:function(e,t){e&&e.report&&Array.isArray(e.report)&&e.report.length>0&&e.report.forEach((function(e){var n=e;if(t.has(n.channelSid)){var i=null;void 0!==n.unreadMessagesCount&&null!=n.unreadMessagesCount&&(i=n.unreadMessagesCount),t.get(n.channelSid).forEach((function(e){return e.resolve(i)})),t.delete(n.channelSid)}})),this.processConsumptionReportError(new l.SessionError("Error while setting LastConsumedMessageIndex",null),t)}},{key:"processConsumptionReportError",value:function(e,t){t.forEach((function(t){return t.forEach((function(t){return t.reject(e)}))}))}},{key:"updateLastConsumedMessageIndexForChannel",value:function(e,t){var n=this;return new i.default((function(i,s){n.addPendingConsumptionHorizonRequest(e,{channelSid:e,messageIdx:t},{resolve:i,reject:s}),n.getReportInterval().then((function(e){return n.delayedSendConsumptionHorizon(e)}))}))}},{key:"advanceLastConsumedMessageIndexForChannel",value:function(e,t,n){var s=this,r=this.consumptionHorizonRequests.get(e);return new i.default((function(i,o){s.addPendingConsumptionHorizonRequest(e,r&&r.entry?r.entry.messageIdx>=t?r.entry:{channelSid:e,messageIdx:t}:null!==n&&t<n?{channelSid:e,messageIdx:n}:{channelSid:e,messageIdx:t},{resolve:i,reject:o}),s.getReportInterval().then((function(e){return s.delayedSendConsumptionHorizon(e)}))}))}},{key:"addPendingConsumptionHorizonRequest",value:function(e,t,n){if(this.consumptionHorizonRequests.has(e)){var i=this.consumptionHorizonRequests.get(e);i.entry=t,i.promises.push(n)}else this.consumptionHorizonRequests.set(e,{entry:t,promises:[n]})}}]),e}();t.ConsumptionHorizon=c},WKX2:function(e,t,n){"use strict";var i=y(n("FyfS")),s=y(n("sk9p")),r=y(n("ODRq")),o=y(n("14Xm")),a=y(n("D3Ub")),l=y(n("4d7F")),c=y(n("P2sY")),u=y(n("Yz+Y")),d=y(n("V7oC")),h=y(n("FYw3")),p=y(n("mRg0")),f=y(n("iCc5")),g=y(n("u8T8")),m=y(n("SEkw")),v=y(n("EJiy")),b=y(n("JO7F"));function y(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=(0,b.default)(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,v.default)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&(0,m.default)(t,n,o),o},C=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,v.default)(Reflect))&&"function"==typeof g.default)return(0,g.default)(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PushNotification=t.Client=t.User=void 0;var w=n("+qE3"),k=n("yC9A"),x=n("EvBC"),O=n("uaGA");Object.defineProperty(t,"User",{enumerable:!0,get:function(){return O.User}});var S=n("6quN"),M=n("iWbE"),P=n("dDpT"),T=n("0YXi"),E=n("kUwj"),I=n("/LtL"),R=n("SwMz"),j=n("nA69"),N=n("hNz0"),U=n("ygN2"),A=n("cEKI"),D=n("je5X"),L=n("VaU9"),F=n("Cjvl"),z=n("CruZ");Object.defineProperty(t,"PushNotification",{enumerable:!0,get:function(){return z.PushNotification}});var q=n("iqZd"),B=n("C9Jq"),W=k.Logger.scope("Client"),$=n("0s00").version,G=function e(){(0,f.default)(this,e)},V=function(e){function t(e,n){(0,f.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,u.default)(t)).call(this));if(i.connectionState="connecting",i.sessionPromise=null,i.channelsPromise=null,i.version=$,i.parsePushNotification=t.parsePushNotification,i.options=n||{},!i.options.disableDeepClone){var s=(0,c.default)((0,c.default)({},i.options),{transport:void 0,twilsockClient:void 0});(s=q.deepClone(s)).transport=i.options.transport,s.twilsockClient=i.options.twilsockClient,i.options=s}i.options.logLevel=i.options.logLevel||"silent",W.setLevel(i.options.logLevel);var r=i.options.productId="ip_messaging";if(i.options.clientMetadata=i.options.clientMetadata||{},i.options.clientMetadata.hasOwnProperty("type")||(i.options.clientMetadata.type="chat"),i.options.clientMetadata.hasOwnProperty("sdk")||(i.options.clientMetadata.sdk="JS",i.options.clientMetadata.sdkv=$),i.options.Sync=i.options.Sync||{},void 0===i.options.Sync.enableSessionStorage&&(i.options.Sync.enableSessionStorage=!0),i.options.region&&(i.options.Sync.region=i.options.region),!e)throw new Error("A valid Twilio token should be provided");return i.services=new G,i.config=new x.Configuration(i.options),i.options.twilsockClient=i.options.twilsockClient||new E.Twilsock(e,r,i.options),i.options.transport=i.options.transport||i.options.twilsockClient,i.options.notificationsClient=i.options.notificationsClient||new I.Notifications(e,i.options),i.options.syncClient=i.options.syncClient||new R.SyncClient(e,i.options),i.services.syncClient=i.options.syncClient,i.services.transport=i.options.transport,i.services.twilsockClient=i.options.twilsockClient,i.services.notificationClient=i.options.notificationsClient,i.services.session=new N.Session(i.services,i.config),i.sessionPromise=i.services.session.initialize(),i.services.network=new M.Network(i.config,i.services),i.services.users=new A.Users({session:i.services.session,network:i.services.network,syncClient:i.services.syncClient}),i.services.users.on("userSubscribed",i.emit.bind(i,"userSubscribed")),i.services.users.on("userUpdated",(function(e){return i.emit("userUpdated",e)})),i.services.users.on("userUnsubscribed",i.emit.bind(i,"userUnsubscribed")),i.services.twilsockClient.on("tokenAboutToExpire",(function(e){return i.emit("tokenAboutToExpire",e)})),i.services.twilsockClient.on("tokenExpired",(function(){return i.emit("tokenExpired")})),i.services.twilsockClient.on("connectionError",(function(e){return i.emit("connectionError",e)})),i.services.consumptionHorizon=new L.ConsumptionHorizon(i.services),i.services.typingIndicator=new D.TypingIndicator(i.config,{transport:i.services.twilsockClient,notificationClient:i.services.notificationClient},i.getChannelBySid.bind(i)),i.services.syncList=new T.SyncList(i.services),i.channels=new U.Channels(i.services),i.channelsPromise=i.sessionPromise.then((function(){return i.channels.on("channelAdded",i.emit.bind(i,"channelAdded")),i.channels.on("channelRemoved",i.emit.bind(i,"channelRemoved")),i.channels.on("channelInvited",i.emit.bind(i,"channelInvited")),i.channels.on("channelJoined",i.emit.bind(i,"channelJoined")),i.channels.on("channelLeft",i.emit.bind(i,"channelLeft")),i.channels.on("channelUpdated",(function(e){return i.emit("channelUpdated",e)})),i.channels.on("memberJoined",i.emit.bind(i,"memberJoined")),i.channels.on("memberLeft",i.emit.bind(i,"memberLeft")),i.channels.on("memberUpdated",(function(e){return i.emit("memberUpdated",e)})),i.channels.on("messageAdded",i.emit.bind(i,"messageAdded")),i.channels.on("messageUpdated",(function(e){return i.emit("messageUpdated",e)})),i.channels.on("messageRemoved",i.emit.bind(i,"messageRemoved")),i.channels.on("typingStarted",i.emit.bind(i,"typingStarted")),i.channels.on("typingEnded",i.emit.bind(i,"typingEnded")),i.channels.fetchChannels()})).then((function(){return i.channels})),i.services.notificationClient.on("connectionStateChanged",(function(e){var t=null;switch(e){case"connected":t="connected";break;case"denied":t="denied";break;case"disconnecting":t="disconnecting";break;case"disconnected":t="disconnected";break;default:t="connecting"}t!==i.connectionState&&(i.connectionState=t,i.emit("connectionStateChanged",i.connectionState))})),i.fpaToken=e,i}var n,i,s,r,g,m,v,b,y,_,C;return(0,p.default)(t,e),(0,d.default)(t,[{key:"subscribeToPushNotifications",value:function(e){var t=this,n=[];return[P.NotificationTypes.NEW_MESSAGE,P.NotificationTypes.ADDED_TO_CHANNEL,P.NotificationTypes.INVITED_TO_CHANNEL,P.NotificationTypes.REMOVED_FROM_CHANNEL,P.NotificationTypes.TYPING_INDICATOR,P.NotificationTypes.CONSUMPTION_UPDATE].forEach((function(i){n.push(t.services.notificationClient.subscribe(i,e))})),l.default.all(n)}},{key:"unsubscribeFromPushNotifications",value:function(e){var t=this,n=[];return[P.NotificationTypes.NEW_MESSAGE,P.NotificationTypes.ADDED_TO_CHANNEL,P.NotificationTypes.INVITED_TO_CHANNEL,P.NotificationTypes.REMOVED_FROM_CHANNEL,P.NotificationTypes.TYPING_INDICATOR,P.NotificationTypes.CONSUMPTION_UPDATE].forEach((function(i){n.push(t.services.notificationClient.unsubscribe(i,e))})),l.default.all(n)}},{key:"initialize",value:(C=(0,a.default)(o.default.mark((function e(){var n,i,s=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionPromise;case 2:return t.supportedPushChannels.forEach((function(e){return s.subscribeToPushNotifications(e)})),e.next=5,this.services.session.getSessionLinks();case 5:return this.services.publicChannels=new S.PublicChannels(this,this.services,(n=e.sent).publicChannelsUrl),this.services.userChannels=new F.UserChannels(this,this.services,n.myChannelsUrl),(i=(0,c.default)(this.options)).transport=null,this.services.mcsClient=new j.McsClient(this.fpaToken,n.mediaServiceUrl,i),e.next=13,this.services.typingIndicator.initialize();case 13:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"shutdown",value:(_=(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.twilsockClient.disconnect();case 2:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"updateToken",value:(y=(0,a.default)(o.default.mark((function e(t){var n=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W.info("updateToken"),this.fpaToken!==t){e.next=3;break}return e.abrupt("return",this);case 3:return e.next=5,this.services.twilsockClient.updateToken(t).then((function(){return n.fpaToken=t})).then((function(){return n.services.mcsClient.updateToken(t)})).then((function(){return n.sessionPromise}));case 5:return e.abrupt("return",this);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"getChannelBySid",value:(b=(0,a.default)(o.default.mark((function e(t){var n=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.channels.syncListRead.promise.then((function(){return n.channels.getChannel(t).then((function(e){return e||n.services.publicChannels.getChannelBySid(t).then((function(e){return n.channels.pushChannel(e)}))}))})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"getChannelByUniqueName",value:(v=(0,a.default)(o.default.mark((function e(t){var n=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.channels.syncListRead.promise.then((function(){return n.services.publicChannels.getChannelByUniqueName(t).then((function(e){return n.channels.pushChannel(e)}))})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getSubscribedChannels",value:function(e){return this.channelsPromise.then((function(t){return t.getChannels(e)}))}},{key:"getLocalChannels",value:function(e){return this.channelsPromise.then((function(n){var i=[];n.channels.forEach((function(e){i.push(e)}));var s=(null==e?void 0:e.order)||"ascending";return e&&e.criteria&&("lastMessage"===e.criteria?i.sort((function(e,n){return t.compareChannelsByLastMessage(e,n,s)})):"uniqueName"===e.criteria?i.sort((function(e,n){return t.compareChannelsByStringProperty(e.uniqueName,n.uniqueName,s)})):"friendlyName"===e.criteria&&i.sort((function(e,n){return t.compareChannelsByStringProperty(e.friendlyName,n.friendlyName,s)}))),i}))}},{key:"getPublicChannelDescriptors",value:function(){return this.services.publicChannels.getChannels()}},{key:"getUserChannelDescriptors",value:function(){return this.services.userChannels.getChannels()}},{key:"createChannel",value:function(e){return e=e||{},this.channelsPromise.then((function(t){return t.addChannel(e)}))}},{key:"setPushRegistrationId",value:(m=(0,a.default)(o.default.mark((function e(t,n){var i=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscribeToPushNotifications(t).then((function(){return i.services.notificationClient.setPushRegistrationId(n,t)}));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"unsetPushRegistrationId",value:(g=(0,a.default)(o.default.mark((function e(n){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==t.supportedPushChannels.indexOf(n)){e.next=2;break}throw new Error("Invalid or unsupported channelType: "+n);case 2:return e.next=4,this.unsubscribeFromPushNotifications(n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"handlePushNotification",value:(r=(0,a.default)(o.default.mark((function e(n){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:W.debug("handlePushNotification, notificationPayload=",n),this.emit("pushNotification",t.parsePushNotification(n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getUser",value:function(e){return this.services.users.getUser(e)}},{key:"getUserDescriptor",value:(s=(0,a.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getUserDescriptor(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getSubscribedUsers",value:(i=(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getSubscribedUsers());case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"user",get:function(){return this.services.users.myself}},{key:"reachabilityEnabled",get:function(){return this.services.session.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}}],[{key:"create",value:(n=(0,a.default)(o.default.mark((function e(n,i){var s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new t(n,i),e.next=3,s.initialize();case 3:return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"compareChannelsByLastMessage",value:function(e,t,n){if(e.lastMessage&&t.lastMessage){if(e.lastMessage.dateCreated&&t.lastMessage.dateCreated)return e.lastMessage.dateCreated.getTime()<t.lastMessage.dateCreated.getTime()?"ascending"===n?-1:1:"ascending"===n?1:-1;if(e.lastMessage.dateCreated)return-1;if(t.lastMessage.dateCreated)return 1}return e.lastMessage?-1:t.lastMessage?1:0}},{key:"compareChannelsByStringProperty",value:function(e,t,n){return e&&t?"ascending"===n?e.localeCompare(t):-1*e.localeCompare(t):e?-1:t?1:0}},{key:"parsePushNotificationChatData",value:function(e){var n={};for(var i in t.supportedPushDataFields)null!=e[i]&&("message_index"===i?null!==q.parseToNumber(e[i])&&(n[t.supportedPushDataFields[i]]=Number(e[i])):n[t.supportedPushDataFields[i]]=e[i]);return n}},{key:"parsePushNotification",value:function(e){if(W.debug("parsePushNotification, notificationPayload=",e),void 0!==e.aps){if(!e.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var n=t.parsePushNotificationChatData(e),i=e.aps,s=null,r=null;return"string"==typeof i.alert?s=i.alert||null:(s=i.alert.body||null,r=i.alert.title||null),new z.PushNotification({title:r,body:s,sound:i.sound||null,badge:i.badge||null,action:i.category||null,type:e.twi_message_type,data:n})}if(void 0!==e.data){var o=e.data;if(!o.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var a=t.parsePushNotificationChatData(e.data);return new z.PushNotification({title:o.twi_title||null,body:o.twi_body||null,sound:o.twi_sound||null,badge:null,action:o.twi_action||null,type:o.twi_message_type,data:a})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),t}(w.EventEmitter);V.version=$,V.supportedPushChannels=["fcm","apn","gcm"],V.supportedPushDataFields={channel_sid:"channelSid",message_sid:"messageSid",message_index:"messageIndex"},_([B.asyncTypeCheck(B.nonEmptyString),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"updateToken",null),_([B.asyncTypeCheck(B.nonEmptyString),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"getChannelBySid",null),_([B.asyncTypeCheck(B.nonEmptyString),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"getChannelByUniqueName",null),_([B.asyncTypeCheck(["undefined",B.custom((function(e){if("object"!==(void 0===e?"undefined":(0,v.default)(e))||null===e||Array.isArray(e))return[!1,"valid sorting options (should be a pure object)"];var t=new r.default([["criteria",["lastMessage","friendlyName","uniqueName"]],["order",["ascending","descending"]]]),n=!0,o=!1,a=void 0;try{for(var l,c=(0,i.default)(t.entries());!(n=(l=c.next()).done);n=!0){var u=(0,s.default)(l.value,2),d=u[0],h=u[1];if(void 0!==e[d]&&!h.includes(e[d]))return[!1,"valid sorting options (sortingOptions."+d+' should be one of: "'+h.join('", "')+'")',"malformed sorting options (sortingOptions."+d+" is "+B.stringifyReceivedType(e[d])+")"]}}catch(p){o=!0,a=p}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}return[!0]}))]),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",l.default)],V.prototype,"getLocalChannels",null),_([B.asyncTypeCheck(["undefined",B.custom((function(e){if("object"!==(void 0===e?"undefined":(0,v.default)(e))||null===e||Array.isArray(e))return[!1,"valid channel options (should be a pure object)"];var t=new r.default([["friendlyName","string"],["isPrivate","boolean"],["uniqueName","string"]]),n=!0,o=!1,a=void 0;try{for(var l,c=(0,i.default)(t.entries());!(n=(l=c.next()).done);n=!0){var u=(0,s.default)(l.value,2),d=u[0],h=u[1];if(void 0!==e[d]&&(0,v.default)(e[d])!==h)return[!1,"valid channel options (options."+d+" should be of type "+h+")","malformed channel options (options."+d+" is "+B.stringifyReceivedType(e[d])+")"]}}catch(p){o=!0,a=p}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}return[!0]}))]),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",l.default)],V.prototype,"createChannel",null),_([B.asyncTypeCheck(B.literal("gcm","fcm","apn"),"string"),C("design:type",Function),C("design:paramtypes",[String,String]),C("design:returntype",l.default)],V.prototype,"setPushRegistrationId",null),_([B.asyncTypeCheck(B.literal("gcm","fcm","apn")),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"unsetPushRegistrationId",null),_([B.asyncTypeCheck(B.pureObject),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",l.default)],V.prototype,"handlePushNotification",null),_([B.asyncTypeCheck(B.nonEmptyString),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"getUser",null),_([B.asyncTypeCheck(B.nonEmptyString),C("design:type",Function),C("design:paramtypes",[String]),C("design:returntype",l.default)],V.prototype,"getUserDescriptor",null),_([B.asyncTypeCheck("string",["undefined",B.pureObject]),C("design:type",Function),C("design:paramtypes",[String,Object]),C("design:returntype",l.default)],V,"create",null),_([B.typeCheck(B.pureObject),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",z.PushNotification)],V,"parsePushNotification",null),t.Client=V,t.default=V},WjQu:function(e,t,n){"use strict";var i=a(n("14Xm")),s=a(n("D3Ub")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Media=void 0;var l=function(){function e(t,n){(0,r.default)(this,e),this.mcsMedia=null,this.services=n,this.state={sid:t.sid,filename:t.filename,contentType:t.contentType,size:t.size}}var t;return(0,o.default)(e,[{key:"getContentTemporaryUrl",value:(t=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mcsMedia){e.next=8;break}if(!this.services.mcsClient){e.next=7;break}return e.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=e.sent,e.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:return e.abrupt("return",this.mcsMedia.getContentUrl());case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}}]),e}();t.Media=l},WpRT:function(e,t,n){var i=n("s2er")("keys"),s=n("ixoo");e.exports=function(e){return i[e]||(i[e]=s(e))}},Wxaq:function(e,t,n){"use strict";var i=a(n("14Xm")),s=a(n("D3Ub")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserDescriptors=void 0;var l=n("iqZd"),c=n("IMt4"),u=n("4dLj"),d=function(){function e(t,n){(0,r.default)(this,e),this.services=t,this.url=n}var t,n;return(0,o.default)(e,[{key:"getUserDescriptor",value:(n=(0,s.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new u.UserDescriptor(this.services,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getChannelUserDescriptors",value:(t=(0,s.default)(i.default.mark((function e(t){var n,s,r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.UriBuilder(this.url).arg("ChannelSid",t).arg("PageToken",o.pageToken).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new c.RestPaginator((s=e.sent).body.users.map((function(e){return new u.UserDescriptor(r.services,e)})),(function(e){return r.getChannelUserDescriptors(t,{pageToken:e})}),s.body.meta.prev_token,s.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.UserDescriptors=d},XH0y:function(e,t,n){var i,s;!function(r,o){"use strict";void 0===(s="function"==typeof(i=function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(i){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function r(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&t?s:void 0!==console[n]?i(console,n):void 0!==console.log?i(console,"log"):e)}function o(t,i){for(var s=0;s<n.length;s++){var r=n[s];this[r]=s<t?e:this.methodFactory(r,t,i)}this.log=this.debug}function a(e,t,n){return function(){"undefined"!=typeof console&&(o.call(this,t,n),this[e].apply(this,arguments))}}function l(e,t,n){return r(e)||a.apply(this,arguments)}function c(e,t,i){var s,r=this,a="loglevel";function c(){var e;if("undefined"!=typeof window){try{e=window.localStorage[a]}catch(i){}if(void 0===e)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(a)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(i){}return void 0===r.levels[e]&&(e=void 0),e}}e&&(a+=":"+e),r.name=e,r.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},r.methodFactory=i||l,r.getLevel=function(){return s},r.setLevel=function(t,i){if("string"==typeof t&&void 0!==r.levels[t.toUpperCase()]&&(t=r.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=r.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(s=t,!1!==i&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!=typeof window){try{return void(window.localStorage[a]=t)}catch(i){}try{window.document.cookie=encodeURIComponent(a)+"="+t+";"}catch(i){}}}(t),o.call(r,t,e),"undefined"==typeof console&&t<r.levels.SILENT)return"No console available for logging"},r.setDefaultLevel=function(e){c()||r.setLevel(e,!1)},r.enableAll=function(e){r.setLevel(r.levels.TRACE,e)},r.disableAll=function(e){r.setLevel(r.levels.SILENT,e)};var u=c();null==u&&(u=null==t?"WARN":t),r.setLevel(u,!1)}var u=new c,d={};u.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new c(e,u.getLevel(),u.methodFactory)),t};var h="undefined"!=typeof window?window.log:void 0;return u.noConflict=function(){return"undefined"!=typeof window&&window.log===u&&(window.log=h),u},u.getLoggers=function(){return d},u})?i.call(t,n,t,e):i)||(e.exports=s)}()},XL7Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("quSY"),s=n("TwVa"),r=n("lJxs"),o=n("wd/R");class a{constructor(e,t,n,r){this.restaurantService=e,this.reservationsService=t,this.newRequestAlertService=n,this.router=r,this.reservations=[],this.selectedReservation=s.f.empty(),this.reservation=s.f.empty(),this.currentRestaurantSubscription=i.a.EMPTY,this.getReservationsSubscription=i.a.EMPTY,this.getReservationDetailsSubscription=i.a.EMPTY,this.newReservationSubscription=i.a.EMPTY,this.newCheckoutReservationSubscription=i.a.EMPTY,this.newInServiceReservationSubscription=i.a.EMPTY,this.newCancelledReservationSubscription=i.a.EMPTY}ngOnInit(){this.getRestaurantInfo(),this.listenForReservationsUpdates(),this.listenForReservationsCancellations(),this.clearStatusDot()}ngOnDestroy(){this.currentRestaurantSubscription.unsubscribe(),this.getReservationsSubscription.unsubscribe(),this.getReservationDetailsSubscription.unsubscribe(),this.newReservationSubscription.unsubscribe(),this.newCheckoutReservationSubscription.unsubscribe(),this.newCancelledReservationSubscription.unsubscribe(),this.newInServiceReservationSubscription.unsubscribe()}clearStatusDot(){this.isThisTheNewReservationsCRUD&&this.newRequestAlertService.hasNewRequest.next(!1),this.isThisTheInServiceReservationsCRUD&&this.newRequestAlertService.hasNewInServiceReservation.next(!1)}getRestaurantInfo(){this.currentRestaurantSubscription=this.restaurantService.currentRestaurant.subscribe(e=>{this.restaurant=e,"active"===this.reservationsTypes.status?this.getReservations("today"):this.getReservations()})}getReservations(e,t){const n=this.reservationsTypes;this.hasPeriodOfTimeLogicToBeActive&&("today"===e?(n.from=Math.floor(o().startOf("day").valueOf()/1e3),n.to=Math.floor(o().endOf("day").valueOf()/1e3)):"next"===e&&(n.from=Math.floor(o().endOf("day").valueOf()/1e3),n.to=void 0)),this.hasCalendarToBeVisible&&(t?(n.from=Math.floor(t.startOf("day").valueOf()/1e3),n.to=Math.floor(t.endOf("day").valueOf()/1e3)):(n.from=Math.floor(o().startOf("day").valueOf()/1e3),n.to=Math.floor(o().endOf("day").valueOf()/1e3))),this.reservationsService.getRestaurantReservations(this.restaurant.id,n).pipe(Object(r.a)(e=>e.reservations.map(e=>new s.f(e)).filter(e=>!(("pending"===e.status||"checkout"===e.status)&&this.isTimeExpired(e.expires_at))))).subscribe(e=>{this.reservations=e,this.selectedReservation=this.reservations[0],this.selectedReservation&&this.getSelectedReservation()})}isTimeExpired(e){return o().valueOf()>e}listenForReservationsUpdates(){this.isThisTheNewReservationsCRUD&&this.initListenersForNewReservationsSection(),this.isThisTheInServiceReservationsCRUD&&this.initListenersForInServiceReservationsSection()}initListenersForNewReservationsSection(){this.newReservationSubscription=this.newRequestAlertService.newPendingReservation.subscribe(e=>{e&&(this.reservations.push(e),1===this.reservations.length&&(this.selectedReservation=this.reservations[0],this.getSelectedReservation(),this.newRequestAlertService.newPendingReservation.next(null)))}),this.newCheckoutReservationSubscription=this.newRequestAlertService.newCheckoutReservation.subscribe(e=>{e&&(this.reservations.push(e),1===this.reservations.length&&(this.selectedReservation=this.reservations[0],this.getSelectedReservation(),this.newRequestAlertService.newCheckoutReservation.next(null)))})}initListenersForInServiceReservationsSection(){this.newInServiceReservationSubscription=this.newRequestAlertService.newInServiceReservation.subscribe(e=>{e&&(this.getReservations(),this.newRequestAlertService.newInServiceReservation.next(null))})}listenForReservationsCancellations(){this.newCancelledReservationSubscription=this.newRequestAlertService.newCancelledReservation.subscribe(e=>{e&&this.removeReservationFromList(e)})}getSelectedReservation(){this.getReservationDetailsSubscription=this.reservationsService.getReservationDetails(this.selectedReservation.id).pipe(Object(r.a)(e=>new s.f(e))).subscribe(e=>{this.reservation=e})}onReservationClick(e){this.reservation=s.f.empty(),this.selectedReservation=this.reservations.find(t=>t.id===e),this.selectedReservation.is_new=!1,this.getSelectedReservation()}reservationsPeriodChangedHandler(e){this.getReservations(e)}get isThisTheNewReservationsCRUD(){return this.router.url.endsWith("new-requests")}get isThisTheInServiceReservationsCRUD(){return this.router.url.endsWith("in-service")}removeReservationFromList(e){if(e){const t=this.reservations.findIndex(t=>t.id===e);this.reservations.splice(t,1),this.selectedReservation&&this.selectedReservation.id===e&&(this.selectedReservation=this.reservations.length>0?this.reservations[0]:void 0,this.selectedReservation&&this.getSelectedReservation())}}}},XLeT:function(e,t,n){"use strict";var i=n("USwo"),s=n("8sL3"),r=n("wqPz");i(i.S,"Promise",{try:function(e){var t=s.f(this),n=r(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},XVPX:function(e,t,n){var i=n("USwo"),s=n("b08l"),r=n("FgkJ"),o=n("d+lc"),a=n("ekG2"),l=n("S4vA"),c=n("S6HK"),u=(n("7whZ").Reflect||{}).construct,d=l((function(){function e(){}return!(u((function(){}),[],e)instanceof e)})),h=!l((function(){u((function(){}))}));i(i.S+i.F*(d||h),"Reflect",{construct:function(e,t){r(e),o(t);var n=arguments.length<3?e:r(arguments[2]);if(h&&!d)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return i.push.apply(i,t),new(c.apply(e,i))}var l=n.prototype,p=s(a(l)?l:Object.prototype),f=Function.apply.call(e,p,t);return a(f)?f:p}})},YHaq:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var i=n("8Y7J"),s=(n("PDjf"),n("9gLZ"),n("UhP/"),n("YEUz"),n("omvX"),i.xb({encapsulation:2,styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],data:{}}));function r(e){return i.ac(2,[i.Nb(null,0),i.Nb(null,1)],null,null)}},Ysb6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{}},"Yz+Y":function(e,t,n){e.exports={default:n("Lr1a"),__esModule:!0}},ZDin:function(e,t,n){var i=n("A9a0"),s=n("l0Kd").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},ZWGZ:function(e,t,n){"use strict";var i=n("rdj4"),s=n("JAUQ");e.exports=n("M+fh")("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=i.getEntry(s(this,"Map"),e);return t&&t.v},set:function(e,t){return i.def(s(this,"Map"),0===e?0:e,t)}},i,!0)},"ZY/g":function(e,t,n){n("aFj7");for(var i=n("7whZ"),s=n("BRsN"),r=n("ig3W"),o=n("zBWt")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<a.length;l++){var c=a[l],u=i[c],d=u&&u.prototype;d&&!d[o]&&s(d,o,c),r[c]=r.Array}},ZblS:function(e,t,n){n("kcqV");var i=n("VSTI").Object;e.exports=function(e,t){return i.getOwnPropertyDescriptor(e,t)}},ZdHh:function(e){e.exports=JSON.parse('{"_args":[["twilio-mcs-client@0.3.3","D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin"]],"_from":"twilio-mcs-client@0.3.3","_id":"twilio-mcs-client@0.3.3","_inBundle":false,"_integrity":"sha512-lNnVITgLg14HBG2oshnwjAeyBxhuqJeAIQE/KUDCGLHwtA6moE49SE1RRtUr5hhziyDSCTjm5X8YeP0m/lL7QA==","_location":"/twilio-mcs-client","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"twilio-mcs-client@0.3.3","name":"twilio-mcs-client","escapedName":"twilio-mcs-client","rawSpec":"0.3.3","saveSpec":null,"fetchSpec":"0.3.3"},"_requiredBy":["/twilio-chat"],"_resolved":"https://registry.npmjs.org/twilio-mcs-client/-/twilio-mcs-client-0.3.3.tgz","_spec":"0.3.3","_where":"D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin","author":{"name":"Twilio"},"browser":{"xmlhttprequest":false},"browserify":{"transform":["babelify"]},"dependencies":{"loglevel":"^1.6.4","operation-retrier":"^3.0.1","xmlhttprequest":"^1.8.0"},"description":"Twilio Media Content Service client library","devDependencies":{"@types/chai":"^4.2.2","@types/chai-as-promised":"^7.1.2","@types/chai-datetime":"0.0.33","@types/chai-string":"^1.4.2","@types/core-js":"^2.5.2","@types/mocha":"^5.2.7","@types/node":"^12.7.4","@types/sinon":"^7.0.13","@types/sinon-chai":"^3.2.3","async":"^3.1.0","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-runtime":"^6.26.0","babelify":"^8.0.0","browserify":"^16.0.0","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-datetime":"^1.5.0","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.1","del":"^5.1.0","dotenv":"^8.1.0","express":"^4.17.1","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^3.0.0","gulp-insert":"^0.5.0","gulp-mocha":"^7.0.1","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^2.0.0","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.0","ink-docstrap":"^1.3.2","isomorphic-form-data":"^2.0.0","jsdoc":"~3.5.5","jsdoc-strip-async-await":"^0.1.0","mocha":"^6.2.0","ngrok":"^3.2.5","nyc":"^14.1.1","sinon":"^7.4.2","sinon-chai":"^3.3.0","source-map-explorer":"^2.0.1","ts-node":"^8.3.0","tslint":"^5.19.0","twilio":"^3.34.0","typescript":"^3.6.2","uglify-save-license":"^0.4.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},"engines":{"node":">=6"},"license":"MIT","main":"lib/index.js","name":"twilio-mcs-client","scripts":{},"types":"./lib/client.d.ts","version":"0.3.3"}')},ZgEp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffRetrier=void 0;const i=n("+qE3"),s=n("vSOj");t.BackoffRetrier=class extends i.EventEmitter{constructor(e){super(),this.options=e?Object.assign({},e):{}}get inProgress(){return!!this.retrier}start(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}stop(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}modifyBackoff(e){this.newBackoff=e}attemptFailed(){if(!this.inProgress)throw new Error("No attempt is in progress");this.newBackoff&&(!this.usedBackoff||this.usedBackoff<this.newBackoff)?this.createRetrier():this.retrier.failed(new Error)}cancel(){this.retrier&&this.retrier.cancel()}cleanRetrier(){this.retrier&&(this.retrier.removeAllListeners(),this.retrier.cancel(),this.retrier=null)}getRetryPolicy(){const e=Object.assign({},this.options);return this.newBackoff&&(e.min=this.newBackoff,e.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),e.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,e}createRetrier(){this.cleanRetrier();const e=this.getRetryPolicy();this.retrier=new s.Retrier(e),this.retrier.once("attempt",()=>{this.retrier.on("attempt",()=>this.emit("attempt")),this.retrier.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",e=>this.emit("failed",e)),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start().catch(e=>{})}}},aFj7:function(e,t,n){"use strict";var i=n("L5pH"),s=n("6jRP"),r=n("ig3W"),o=n("bKEA");e.exports=n("OTpG")(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,s(1)):s(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},aLZZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PacketInterface=t.PacketResponse=void 0;const i=n("MZ0W"),s=n("EcEN"),r=n("arZA"),o=n("TZCi"),a=n("ioUz"),l=n("bldR"),c=n("I7B1");t.PacketResponse=class{},t.PacketInterface=class{constructor(e,t){this.config=t,this.activeRequests=new Map,this.channel=e,this.channel.on("reply",e=>this.processReply(e)),this.channel.on("disconnected",()=>{this.activeRequests.forEach(e=>{clearTimeout(e.timeout),e.reject(new r.TwilsockError("disconnected"))}),this.activeRequests.clear()})}get isConnected(){return this.channel.isConnected}processReply(e){const t=this.activeRequests.get(e.id);var n;t&&(clearTimeout(t.timeout),this.activeRequests.delete(e.id),(n=e.status.code)>=200&&n<300?t.resolve(e):(t.reject(new o.TwilsockReplyError("Transport failure: "+e.status.status,e)),i.log.trace("message rejected")))}storeRequest(e,t,n){let s={resolve:t,reject:n,timeout:setTimeout(()=>{i.log.trace("request",e,"is timed out"),n(new r.TwilsockError("Twilsock: request timeout: "+e))},3e4)};this.activeRequests.set(e,s)}shutdown(){this.activeRequests.forEach(e=>{clearTimeout(e.timeout),e.reject(new r.TwilsockError("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}async sendInit(){i.log.trace("sendInit");let e=c.Metadata.getMetadata(this.config),t=new l.Init(this.config.token,this.config.continuationToken,e,this.config.initRegistrations,this.config.tweaks),n=await this.sendWithReply(t);return new l.InitReply(n.id,n.header.continuation_token,n.header.continuation_token_status,n.header.offline_storage,n.header.init_registrations,n.header.debug_info,new Set(n.header.capabilities))}sendClose(){let e=new l.Close;this.send(e)}sendWithReply(e,t){return new Promise((n,i)=>{let s=this.send(e,t);this.storeRequest(s,n,i)})}send(e,t){e.id=e.id||`TM${s.v4()}`;let n=a.Parser.createPacket(e,function(e){switch(typeof e){case"undefined":return"";case"object":return JSON.stringify(e);default:return e}}(t));try{return this.channel.send(n),e.id}catch(r){throw i.log.debug("failed to send ",e,r),i.log.trace(r.stack),r}}}},aT0f:function(e,t,n){"use strict";var i=n("7whZ"),s=n("nA4W"),r=n("C61u"),o=n("USwo"),a=n("ugGH"),l=n("40oJ").KEY,c=n("S4vA"),u=n("s2er"),d=n("kvAF"),h=n("ixoo"),p=n("zBWt"),f=n("/NTb"),g=n("4Zg2"),m=n("CuL1"),v=n("Trx6"),b=n("d+lc"),y=n("ekG2"),_=n("CYMq"),C=n("bKEA"),w=n("M5dz"),k=n("ENu8"),x=n("b08l"),O=n("GDZC"),S=n("TSC6"),M=n("/tXR"),P=n("GhSp"),T=n("mHY4"),E=S.f,I=P.f,R=O.f,j=i.Symbol,N=i.JSON,U=N&&N.stringify,A=p("_hidden"),D=p("toPrimitive"),L={}.propertyIsEnumerable,F=u("symbol-registry"),z=u("symbols"),q=u("op-symbols"),B=Object.prototype,W="function"==typeof j&&!!M.f,$=i.QObject,G=!$||!$.prototype||!$.prototype.findChild,V=r&&c((function(){return 7!=x(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a}))?function(e,t,n){var i=E(B,t);i&&delete B[t],I(e,t,n),i&&e!==B&&I(B,t,i)}:I,X=function(e){var t=z[e]=x(j.prototype);return t._k=e,t},J=W&&"symbol"==typeof j.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof j},H=function(e,t,n){return e===B&&H(q,t,n),b(e),t=w(t,!0),b(n),s(z,t)?(n.enumerable?(s(e,A)&&e[A][t]&&(e[A][t]=!1),n=x(n,{enumerable:k(0,!1)})):(s(e,A)||I(e,A,k(1,{})),e[A][t]=!0),V(e,t,n)):I(e,t,n)},K=function(e,t){b(e);for(var n,i=m(t=C(t)),s=0,r=i.length;r>s;)H(e,n=i[s++],t[n]);return e},Y=function(e){var t=L.call(this,e=w(e,!0));return!(this===B&&s(z,e)&&!s(q,e))&&(!(t||!s(this,e)||!s(z,e)||s(this,A)&&this[A][e])||t)},Q=function(e,t){if(e=C(e),t=w(t,!0),e!==B||!s(z,t)||s(q,t)){var n=E(e,t);return!n||!s(z,t)||s(e,A)&&e[A][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=R(C(e)),i=[],r=0;n.length>r;)s(z,t=n[r++])||t==A||t==l||i.push(t);return i},ee=function(e){for(var t,n=e===B,i=R(n?q:C(e)),r=[],o=0;i.length>o;)!s(z,t=i[o++])||n&&!s(B,t)||r.push(z[t]);return r};W||(a((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(n){this===B&&t.call(q,n),s(this,A)&&s(this[A],e)&&(this[A][e]=!1),V(this,e,k(1,n))};return r&&G&&V(B,e,{configurable:!0,set:t}),X(e)}).prototype,"toString",(function(){return this._k})),S.f=Q,P.f=H,n("ZDin").f=O.f=Z,n("GRew").f=Y,M.f=ee,r&&!n("5ETA")&&a(B,"propertyIsEnumerable",Y,!0),f.f=function(e){return X(p(e))}),o(o.G+o.W+o.F*!W,{Symbol:j});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var ie=T(p.store),se=0;ie.length>se;)g(ie[se++]);o(o.S+o.F*!W,"Symbol",{for:function(e){return s(F,e+="")?F[e]:F[e]=j(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!W,"Object",{create:function(e,t){return void 0===t?x(e):K(x(e),t)},defineProperty:H,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var re=c((function(){M.f(1)}));o(o.S+o.F*re,"Object",{getOwnPropertySymbols:function(e){return M.f(_(e))}}),N&&o(o.S+o.F*(!W||c((function(){var e=j();return"[null]"!=U([e])||"{}"!=U({a:e})||"{}"!=U(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,i=[e],s=1;arguments.length>s;)i.push(arguments[s++]);if(n=t=i[1],(y(t)||void 0!==e)&&!J(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),i[1]=t,U.apply(N,i)}}),j.prototype[D]||n("BRsN")(j.prototype,D,j.prototype.valueOf),d(j,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},aqg2:function(e,t,n){var i=n("TYje"),s=n("zBWt")("toStringTag"),r="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=Object(e),s))?n:r?i(t):"Object"==(o=i(t))&&"function"==typeof t.callee?"Arguments":o}},arZA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockError=void 0;class i extends Error{constructor(e){super(e)}}t.TwilsockError=i},auUO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t,n,i,s){super(e),this.code=t,this.body=n,this.status=i,this.headers=s}}t.TransportError=i},axwj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;const i=n("NDb0");t.Message=class extends i.AbstractMessage{constructor(e,t,n){super(),this.method="message",this.active_grant=e,this.payload_type=t,this.http_request=n}}},b08l:function(e,t,n){var i=n("d+lc"),s=n("heda"),r=n("l0Kd"),o=n("WpRT")("IE_PROTO"),a=function(){},l=function(){var e,t=n("BfU5")("iframe"),i=r.length;for(t.style.display="none",n("kUGv").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=i(e),n=new a,a.prototype=null,n[o]=e):n=l(),void 0===t?n:s(n,t)}},b0Ca:function(e,t,n){"use strict";function i(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function s(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(t,"__esModule",{value:!0}),t.Pointer=void 0;var r=function(){function e(e){void 0===e&&(e=[""]),this.tokens=e}return e.fromJSON=function(t){var n=t.split("/").map(i);if(""!==n[0])throw new Error("Invalid JSON Pointer: "+t);return new e(n)},e.prototype.toString=function(){return this.tokens.map(s).join("/")},e.prototype.evaluate=function(e){for(var t=null,n="",i=e,s=1,r=this.tokens.length;s<r;s++)i=((t=i)||{})[n=this.tokens[s]];return{parent:t,key:n,value:i}},e.prototype.get=function(e){return this.evaluate(e).value},e.prototype.set=function(e,t){for(var n=e,i=1,s=this.tokens.length-1,r=this.tokens[i];i<s;i++)n=(n||{})[r];n&&(n[this.tokens[this.tokens.length-1]]=t)},e.prototype.push=function(e){this.tokens.push(e)},e.prototype.add=function(t){return new e(this.tokens.concat(String(t)))},e}();t.Pointer=r},bKEA:function(e,t,n){var i=n("n7vu"),s=n("yQFZ");e.exports=function(e){return i(s(e))}},bS86:function(e,t,n){var i=n("ig3W"),s=n("zBWt")("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[s]===e)}},bldR:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Telemetry=t.Close=t.Reply=t.Message=t.Update=t.InitReply=t.Init=void 0;const i=n("6w5q");Object.defineProperty(t,"Init",{enumerable:!0,get:function(){return i.Init}});const s=n("P15O");Object.defineProperty(t,"InitReply",{enumerable:!0,get:function(){return s.InitReply}});const r=n("DQkm");Object.defineProperty(t,"Update",{enumerable:!0,get:function(){return r.Update}});const o=n("Ut7X");Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return o.Message}});const a=n("miUa");Object.defineProperty(t,"Reply",{enumerable:!0,get:function(){return a.Reply}});const l=n("IYKI");Object.defineProperty(t,"Close",{enumerable:!0,get:function(){return l.Close}});const c=n("grBd");Object.defineProperty(t,"Telemetry",{enumerable:!0,get:function(){return c.Telemetry}})},c4i1:function(e,t,n){"use strict";var i=n("8Y7J"),s=n("Q2Ze"),r=n("s7LF"),o=n("XE/z"),a=n("Tj54"),l=n("H3DK"),c=n("UhP/"),u=n("9gLZ"),d=n("SCoL"),h=n("omvX"),p=n("e6WT"),f=n("8sFK"),g=n("SVse"),m=n("N7/N"),v=n("iELJ"),b=n("fx7b"),y=n("zHaW");n.d(t,"a",(function(){return M}));var _=i.xb({encapsulation:0,styles:[["div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#3c3c3c;font-size:14px;font-weight:600}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .motive[_ngcontent-%COMP%]{margin-top:30px;font-size:16px;color:#7a7a7a;font-weight:300}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;-webkit-box-align:center;align-items:center;margin-top:40px}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:pointer}div[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{margin-left:24px}"]],data:{}});function C(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,"mat-error",[["class","mat-error"],["role","alert"]],[[1,"id",0]],null,null,null,null)),i.yb(1,16384,[[6,4]],0,s.b,[],null,null),(e()(),i.Xb(-1,null,[" Esta informaci\xf3n es necesaria "]))],null,(function(e,t){e(t,0,0,i.Ob(t,1).id)}))}function w(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,2,"mat-error",[["class","mat-error"],["role","alert"]],[[1,"id",0]],null,null,null,null)),i.yb(1,16384,[[6,4]],0,s.b,[],null,null),(e()(),i.Xb(-1,null,[" El m\xe1ximo de caracteres es de 400 caracteres "]))],null,(function(e,t){e(t,0,0,i.Ob(t,1).id)}))}function k(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,45,"form",[["class","container"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(e,t,n){var s=!0;return"submit"===t&&(s=!1!==i.Ob(e,2).onSubmit(n)&&s),"reset"===t&&(s=!1!==i.Ob(e,2).onReset()&&s),s}),null,null)),i.yb(1,16384,null,0,r.B,[],null,null),i.yb(2,540672,null,0,r.l,[[8,null],[8,null]],{form:[0,"form"]},null),i.Sb(2048,null,r.c,null,[r.l]),i.yb(4,16384,null,0,r.t,[[4,r.c]],null,null),(e()(),i.zb(5,0,null,null,2,"mat-icon",[["aria-hidden","false"],["aria-label","Cerrar modal"],["class","clr-yellow close mat-icon notranslate"],["role","img"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeDialog(!1)&&i),i}),o.b,o.a)),i.yb(6,9158656,null,0,a.b,[i.l,a.d,[8,"false"],[2,a.a],[2,i.n]],null,null),(e()(),i.Xb(-1,0,["close"])),(e()(),i.zb(8,0,null,null,1,"p",[["class","title"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,["RECHAZAR RESERVACI\xd3N"])),(e()(),i.zb(10,0,null,null,1,"p",[["class","motive"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,[" Indica el motivo por el que no puedes aceptar la solicitud "])),(e()(),i.zb(12,0,null,null,27,"mat-form-field",[["class","example-full-width mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,l.b,l.a)),i.yb(13,7520256,null,9,s.c,[i.l,i.h,[2,c.f],[2,u.b],[2,s.a],d.a,i.A,[2,h.a]],null,null),i.Tb(603979776,1,{_controlNonStatic:0}),i.Tb(335544320,2,{_controlStatic:0}),i.Tb(603979776,3,{_labelChildNonStatic:0}),i.Tb(335544320,4,{_labelChildStatic:0}),i.Tb(603979776,5,{_placeholderChild:0}),i.Tb(603979776,6,{_errorChildren:1}),i.Tb(603979776,7,{_hintChildren:1}),i.Tb(603979776,8,{_prefixChildren:1}),i.Tb(603979776,9,{_suffixChildren:1}),(e()(),i.zb(23,0,null,3,2,"mat-label",[],null,null,null,null,null)),i.yb(24,16384,[[3,4],[4,4]],0,s.f,[],null,null),(e()(),i.Xb(-1,null,["Motivo"])),(e()(),i.zb(26,0,null,1,9,"textarea",[["class","mat-input-element mat-form-field-autofill-control"],["formControlName","motive"],["matInput",""],["maxlength","400"]],[[1,"maxlength",0],[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"focus"]],(function(e,t,n){var s=!0;return"input"===t&&(s=!1!==i.Ob(e,29)._handleInput(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,29).onTouched()&&s),"compositionstart"===t&&(s=!1!==i.Ob(e,29)._compositionStart()&&s),"compositionend"===t&&(s=!1!==i.Ob(e,29)._compositionEnd(n.target.value)&&s),"blur"===t&&(s=!1!==i.Ob(e,33)._focusChanged(!1)&&s),"focus"===t&&(s=!1!==i.Ob(e,33)._focusChanged(!0)&&s),"input"===t&&(s=!1!==i.Ob(e,33)._onInput()&&s),s}),null,null)),i.yb(27,540672,null,0,r.o,[],{maxlength:[0,"maxlength"]},null),i.Sb(1024,null,r.p,(function(e){return[e]}),[r.o]),i.yb(29,16384,null,0,r.d,[i.F,i.l,[2,r.a]],null,null),i.Sb(1024,null,r.q,(function(e){return[e]}),[r.d]),i.yb(31,671744,null,0,r.j,[[3,r.c],[6,r.p],[8,null],[6,r.q],[2,r.A]],{name:[0,"name"]},null),i.Sb(2048,null,r.r,null,[r.j]),i.yb(33,999424,null,0,p.b,[i.l,d.a,[6,r.r],[2,r.u],[2,r.l],c.b,[8,null],f.a,i.A],null,null),i.yb(34,16384,null,0,r.s,[[4,r.r]],null,null),i.Sb(2048,[[1,4],[2,4]],s.d,null,[p.b]),(e()(),i.jb(16777216,null,5,1,null,C)),i.yb(37,16384,null,0,g.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.jb(16777216,null,5,1,null,w)),i.yb(39,16384,null,0,g.m,[i.R,i.N],{ngIf:[0,"ngIf"]},null),(e()(),i.zb(40,0,null,null,5,"div",[["class","controls"]],null,null,null,null,null)),(e()(),i.zb(41,0,null,null,1,"p",[],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeDialog(!1)&&i),i}),null,null)),(e()(),i.Xb(-1,null,["Cancelar"])),(e()(),i.zb(43,0,null,null,2,"button",[["class","btns"],["type","button"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.setVisibleSection("refuseConfirmation")&&i),i}),null,null)),(e()(),i.zb(44,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Aceptar"]))],(function(e,t){var n=t.component;e(t,2,0,n.form),e(t,6,0),e(t,27,0,"400"),e(t,31,0,"motive"),e(t,33,0),e(t,37,0,n.form.get("motive").hasError("required")),e(t,39,0,n.form.get("motive").hasError("maxlenght"))}),(function(e,t){e(t,0,0,i.Ob(t,4).ngClassUntouched,i.Ob(t,4).ngClassTouched,i.Ob(t,4).ngClassPristine,i.Ob(t,4).ngClassDirty,i.Ob(t,4).ngClassValid,i.Ob(t,4).ngClassInvalid,i.Ob(t,4).ngClassPending),e(t,5,0,i.Ob(t,6).inline,"primary"!==i.Ob(t,6).color&&"accent"!==i.Ob(t,6).color&&"warn"!==i.Ob(t,6).color),e(t,12,1,["standard"==i.Ob(t,13).appearance,"fill"==i.Ob(t,13).appearance,"outline"==i.Ob(t,13).appearance,"legacy"==i.Ob(t,13).appearance,i.Ob(t,13)._control.errorState,i.Ob(t,13)._canLabelFloat,i.Ob(t,13)._shouldLabelFloat(),i.Ob(t,13)._hasFloatingLabel(),i.Ob(t,13)._hideControlPlaceholder(),i.Ob(t,13)._control.disabled,i.Ob(t,13)._control.autofilled,i.Ob(t,13)._control.focused,"accent"==i.Ob(t,13).color,"warn"==i.Ob(t,13).color,i.Ob(t,13)._shouldForward("untouched"),i.Ob(t,13)._shouldForward("touched"),i.Ob(t,13)._shouldForward("pristine"),i.Ob(t,13)._shouldForward("dirty"),i.Ob(t,13)._shouldForward("valid"),i.Ob(t,13)._shouldForward("invalid"),i.Ob(t,13)._shouldForward("pending"),!i.Ob(t,13)._animationsEnabled]),e(t,26,1,[i.Ob(t,27).maxlength?i.Ob(t,27).maxlength:null,i.Ob(t,33)._isServer,i.Ob(t,33).id,i.Ob(t,33).placeholder,i.Ob(t,33).disabled,i.Ob(t,33).required,i.Ob(t,33).readonly&&!i.Ob(t,33)._isNativeSelect||null,i.Ob(t,33)._ariaDescribedby||null,i.Ob(t,33).errorState,i.Ob(t,33).required.toString(),i.Ob(t,34).ngClassUntouched,i.Ob(t,34).ngClassTouched,i.Ob(t,34).ngClassPristine,i.Ob(t,34).ngClassDirty,i.Ob(t,34).ngClassValid,i.Ob(t,34).ngClassInvalid,i.Ob(t,34).ngClassPending])}))}function x(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,15,"div",[["class","container"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,2,"mat-icon",[["aria-hidden","false"],["aria-label","Cerrar modal"],["class","clr-yellow close mat-icon notranslate"],["role","img"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,o.b,o.a)),i.yb(2,9158656,null,0,a.b,[i.l,a.d,[8,"false"],[2,a.a],[2,i.n]],null,null),(e()(),i.Xb(-1,0,["close"])),(e()(),i.zb(4,0,null,null,1,"p",[["class","title"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,["RECHAZAR RESERVACI\xd3N"])),(e()(),i.zb(6,0,null,null,3,"p",[["class","motive"]],null,null,null,null,null)),(e()(),i.Xb(-1,null,[" Si cancelas una reservaci\xf3n, afectar\xe1 tu calificaci\xf3n general "])),(e()(),i.zb(8,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,[" \xbfEst\xe1s seguro? "])),(e()(),i.zb(10,0,null,null,5,"div",[["class","controls"]],null,null,null,null,null)),(e()(),i.zb(11,0,null,null,1,"p",[],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeDialog(!1)&&i),i}),null,null)),(e()(),i.Xb(-1,null,["Cancelar"])),(e()(),i.zb(13,0,null,null,2,"button",[["class","btns"],["type","button"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.requestCancellation()&&i),i}),null,null)),(e()(),i.zb(14,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),i.Xb(-1,null,["Aceptar"]))],(function(e,t){e(t,2,0)}),(function(e,t){e(t,1,0,i.Ob(t,2).inline,"primary"!==i.Ob(t,2).color&&"accent"!==i.Ob(t,2).color&&"warn"!==i.Ob(t,2).color)}))}function O(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,5,"div",[],null,null,null,null,null)),i.yb(1,16384,null,0,g.q,[],{ngSwitch:[0,"ngSwitch"]},null),(e()(),i.jb(16777216,null,null,1,null,k)),i.yb(3,278528,null,0,g.r,[i.R,i.N,g.q],{ngSwitchCase:[0,"ngSwitchCase"]},null),(e()(),i.jb(16777216,null,null,1,null,x)),i.yb(5,278528,null,0,g.r,[i.R,i.N,g.q],{ngSwitchCase:[0,"ngSwitchCase"]},null)],(function(e,t){e(t,1,0,t.component.visibleContent),e(t,3,0,"motiveForm"),e(t,5,0,"refuseConfirmation")}),null)}function S(e){return i.ac(0,[(e()(),i.zb(0,0,null,null,1,"app-refuse-reservation-motive",[],null,null,null,O,_)),i.yb(1,180224,null,0,m.a,[v.a,v.j,r.g,b.a,y.b],null,null)],null,null)}var M=i.vb("app-refuse-reservation-motive",m.a,S,{},{},[])},cEKI:function(e,t,n){"use strict";var i=d(n("14Xm")),s=d(n("D3Ub")),r=d(n("ODRq")),o=d(n("Yz+Y")),a=d(n("iCc5")),l=d(n("V7oC")),c=d(n("FYw3")),u=d(n("mRg0"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Users=void 0;var h=n("+qE3"),p=n("uaGA"),f=n("Wxaq"),g=function(e){function t(e){(0,a.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return n.services=e,n.fifoStack=[],n.fifoStackMaxLength=100,n.myself=new p.User(null,null,n.services),n.myself.on("updated",(function(e){return n.emit("userUpdated",e)})),n.myself.on("userSubscribed",(function(){return n.emit("userSubscribed",n.myself)})),n.myself.on("userUnsubscribed",(function(){n.emit("userUnsubscribed",n.myself),n.myself._ensureFetched()})),n.services=e,n.subscribedUsers=new r.default,n.userDescriptorsPromise=n.services.session.getSessionLinks().then((function(e){return n.userDescriptors=new f.UserDescriptors({users:n,network:n.services.network},e.usersUrl),n.userDescriptors})),n.services.session.getMaxUserInfosToSubscribe().then((function(e){n.fifoStackMaxLength=e})),n.services.session.getUsersData().then((function(e){return n.myself.identity=e.identity,n.myself.entityName=e.user,n.myself._ensureFetched()})),n}var n,d,h,g;return(0,u.default)(t,e),(0,l.default)(t,[{key:"handleUnsubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)&&this.subscribedUsers.delete(e.identity);var t=-1;this.fifoStack.find((function(n,i){return n==e.identity&&(t=i,!0)}))&&this.fifoStack.splice(t,1),this.emit("userUnsubscribed",e)}},{key:"handleSubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)||(this.fifoStack.length>=this.fifoStackMaxLength&&this.subscribedUsers.get(this.fifoStack.shift()).unsubscribe(),this.fifoStack.push(e.identity),this.subscribedUsers.set(e.identity,e),this.emit("userSubscribed",e))}},{key:"getUser",value:(g=(0,s.default)(i.default.mark((function e(t){var n,s=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getUsersData();case 2:return e.next=4,this.myself._ensureFetched();case 4:if(t!=this.myself.identity){e.next=6;break}return e.abrupt("return",this.myself);case 6:if(n=this.subscribedUsers.get(t)){e.next=19;break}if(r){e.next=13;break}return e.next=11,this.getUserDescriptor(t);case 11:r=e.sent._getDescriptor().sync_unique_name;case 13:return(n=new p.User(t,r,this.services)).on("updated",(function(e){return s.emit("userUpdated",e)})),n.on("userSubscribed",(function(){return s.handleSubscribeUser(n)})),n.on("userUnsubscribed",(function(){return s.handleUnsubscribeUser(n)})),e.next=19,n._ensureFetched();case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getUserDescriptor",value:(h=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userDescriptorsPromise;case 2:return e.abrupt("return",this.userDescriptors.getUserDescriptor(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getChannelUserDescriptors",value:(d=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userDescriptorsPromise;case 2:return e.abrupt("return",this.userDescriptors.getChannelUserDescriptors(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=(0,s.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getUsersData();case 2:return e.next=4,this.myself._ensureFetched();case 4:return t=[this.myself],this.subscribedUsers.forEach((function(e){return t.push(e)})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),t}(h.EventEmitter);t.Users=g},cRVY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffRetrier=void 0;const i=n("+qE3"),s=n("vSOj");t.BackoffRetrier=class extends i.EventEmitter{constructor(e){super(),this.options=e?Object.assign({},e):{}}get inProgress(){return!!this.retrier}start(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}stop(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}modifyBackoff(e){this.newBackoff=e}attemptFailed(){if(!this.inProgress)throw new Error("No attempt is in progress");this.newBackoff&&(!this.usedBackoff||this.usedBackoff<this.newBackoff)?this.createRetrier():this.retrier.failed(new Error)}cancel(){this.retrier&&this.retrier.cancel()}cleanRetrier(){this.retrier&&(this.retrier.removeAllListeners(),this.retrier.cancel(),this.retrier=null)}getRetryPolicy(){const e=Object.assign({},this.options);return this.newBackoff&&(e.min=this.newBackoff,e.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),e.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,e}createRetrier(){this.cleanRetrier();const e=this.getRetryPolicy();this.retrier=new s.Retrier(e),this.retrier.once("attempt",()=>{this.retrier.on("attempt",()=>this.emit("attempt")),this.retrier.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",e=>this.emit("failed",e)),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start().catch(e=>{})}}},cSMa:function(e,t,n){var i=function(){return this}()||Function("return this")(),s=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,r=s&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,e.exports=n("u4eC"),s)i.regeneratorRuntime=r;else try{delete i.regeneratorRuntime}catch(o){i.regeneratorRuntime=void 0}},czaS:function(e,t,n){var i=n("USwo"),s=n("VSTI"),r=n("S4vA");e.exports=function(e,t){var n=(s.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*r((function(){n(1)})),"Object",o)}},"d+lc":function(e,t,n){var i=n("ekG2");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},dDpT:function(e,t,n){"use strict";var i,s=(i=n("iCc5"))&&i.__esModule?i:{default:i};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationTypes=void 0;var r=function e(){(0,s.default)(this,e)};t.NotificationTypes=r,r.TYPING_INDICATOR="twilio.ipmsg.typing_indicator",r.NEW_MESSAGE="twilio.channel.new_message",r.ADDED_TO_CHANNEL="twilio.channel.added_to_channel",r.INVITED_TO_CHANNEL="twilio.channel.invited_to_channel",r.REMOVED_FROM_CHANNEL="twilio.channel.removed_from_channel",r.CONSUMPTION_UPDATE="twilio.channel.consumption_update"},"du/1":function(e,t,n){var i=n("USwo");i(i.S,"Object",{create:n("b08l")})},e56k:function(e,t,n){n("ZY/g"),n("C5kU"),e.exports=n("iqsF")},ekG2:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},f9CJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("XH0y");function s(e,t){return[`${(new Date).toISOString()} MCS Client ${e}:`].concat(Array.from(t))}class r{constructor(e){this.prefix="",this.prefix=null!=e&&e.length>0?e+" ":""}static scope(e){return new r(e)}setLevel(e){i.setLevel(e)}static setLevel(e){i.setLevel(e)}trace(...e){i.trace.apply(null,s(this.prefix+"T",e))}debug(...e){i.debug.apply(null,s(this.prefix+"D",e))}info(...e){i.info.apply(null,s(this.prefix+"I",e))}warn(...e){i.warn.apply(null,s(this.prefix+"W",e))}error(...e){i.error.apply(null,s(this.prefix+"E",e))}static trace(...e){i.trace.apply(null,s("T",e))}static debug(...e){i.debug.apply(null,s("D",e))}static info(...e){i.info.apply(null,s("I",e))}static warn(...e){i.warn.apply(null,s("W",e))}static error(...e){i.error.apply(null,s("E",e))}}t.Logger=r},fJKg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransportUnavailableError=t.TwilsockError=t.Twilsock=t.TwilsockClient=void 0;const i=n("6efB");Object.defineProperty(t,"TwilsockClient",{enumerable:!0,get:function(){return i.TwilsockClient}}),Object.defineProperty(t,"Twilsock",{enumerable:!0,get:function(){return i.TwilsockClient}});const s=n("7FP+");Object.defineProperty(t,"TwilsockError",{enumerable:!0,get:function(){return s.TwilsockError}});const r=n("o+/m");Object.defineProperty(t,"TransportUnavailableError",{enumerable:!0,get:function(){return r.TransportUnavailableError}})},fUKC:function(e,t,n){n("ZY/g"),n("C5kU"),e.exports=n("sbOA")},fx7b:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AytR"),s=n("IheW"),r=n("8Y7J");let o=(()=>{class e{constructor(e){this.http=e}getRestaurantReservations(e,t){const n=i.a.RESTAURANT_RESERVATIONS.replace("{restaurantId}",e.toString());let r=new s.h;return Object.keys(t).forEach(e=>{const n=t[e];n&&(r=r.set(e,n))}),this.http.get(n,{params:r})}getReservationDetails(e){const t=i.a.RESERVATION_DETAIL.replace("{reservationId}",e.toString());return this.http.get(t)}confirmReservation(e){const t=i.a.CONFIRM_RESERVATION.replace("{reservationId}",e.toString());return this.http.post(t,{})}confirmOrder(e){const t=i.a.CONFIRM_ORDER.replace("{reservationId}",e.toString());return this.http.post(t,{})}cancelReservation(e,t){const n={headers:new s.g,body:{reason:t}},r=i.a.CANCEL_RESERVATION.replace("{reservationId}",e.toString());return this.http.delete(r,n)}}return e.\u0275prov=r.bc({factory:function(){return new e(r.cc(s.c))},token:e,providedIn:"root"}),e})()},"gDS+":function(e,t,n){e.exports={default:n("t/pG"),__esModule:!0}},gRli:function(e,t,n){n("aT0f"),n("3+Ww"),n("MBy0"),n("TnF5"),e.exports=n("VSTI").Symbol},grBd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryEvent=t.Telemetry=void 0;const i=n("PmLG");t.TelemetryEvent=class{constructor(e,t,n,i,s,r){this.start=e,this.end=t,this.title=n,this.details=i,this.id=s,this.type=r}},t.Telemetry=class extends i.AbstractMessage{constructor(e){super(),this.method="telemetry.v1",this.events=e}}},gy0F:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenStorage=void 0;class i{static get sessionStorage(){try{return global.sessionStorage}catch(e){return null}}static get window(){try{return global.window}catch(e){return null}}static storeToken(e,t){i.canStore&&i.sessionStorage.setItem(i.getKeyName(t),e)}static getStoredToken(e){return i.canStore?i.sessionStorage.getItem(i.getKeyName(e)):null}static initialize(){i.canStore&&(i.sessionStorage.getItem(i.initializedFlag)&&this.clear(),i.sessionStorage.setItem(i.initializedFlag,"true"),i.window.addEventListener("unload",()=>{i.sessionStorage.removeItem(i.initializedFlag)}))}static clear(){if(i.canStore){let e=[];for(let t=0;t<i.sessionStorage.length;t++){const n=i.sessionStorage.key(t);0===n.indexOf(i.tokenStoragePrefix)&&e.push(n)}e.forEach(e=>i.sessionStorage.removeItem(e)),i.sessionStorage.removeItem(i.initializedFlag)}}static getKeyName(e){return`${i.tokenStoragePrefix}${e}`}static get canStore(){return i.sessionStorage&&i.window}}t.TokenStorage=i,i.initializedFlag="twilio_twilsock_token_storage",i.tokenStoragePrefix="twilio_continuation_token_",i.initialize()},h3Hq:function(e,t,n){var i=n("zBWt")("iterator"),s=!1;try{var r=[7][i]();r.return=function(){s=!0},Array.from(r,(function(){throw 2}))}catch(o){}e.exports=function(e,t){if(!t&&!s)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},e(r)}catch(o){}return n}},hLxu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=class{constructor(){this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}get promise(){return this._promise}update(e){this._resolve(e)}set(e){this.current=e,this._resolve(e)}fail(e){this._reject(e)}}},hNz0:function(e,t,n){"use strict";var i=c(n("14Xm")),s=c(n("D3Ub")),r=c(n("4d7F")),o=c(n("ODRq")),a=c(n("V7oC")),l=c(n("iCc5"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var u=n("EcEN"),d=n("+qwt"),h=n("72j5"),p=n("yC9A"),f=n("FxMp"),g=n("qc9/"),m=n("5m62"),v=n("0s00").version,b=p.Logger.scope("Session"),y=function e(){(0,l.default)(this,e)},_=function(){function e(t,n){(0,l.default)(this,e);var i="undefined"!=typeof navigator?d.parse(navigator.userAgent):d;this.services=t,this.config=n,this.sessionInfo=new g.Deferred,this.currentContext={},this.pendingCommands=new o.default,this.sessionStreamPromise=null,this.endpointPlatform=["JS",v,i.os,i.name,i.version].join("|")}var t,n,c,p,_,C;return(0,a.default)(e,[{key:"handleContextUpdate",value:function(e){var t;b.info("Session context updated"),b.debug("new session context:",e),this.currentContext=e,t=e,["identity","userInfo","links","myChannels","channels"].some((function(e){return!t.hasOwnProperty(e)}))||(b.info("new session context accepted"),this.sessionInfo.set(e))}},{key:"initialize",value:function(){var e=this;return this.sessionStreamPromise=this.services.syncClient.list({purpose:"com.twilio.rtd.ipmsg",context:{type:"IpMsgSession",apiVersion:"3",endpointPlatform:this.endpointPlatform}}).then((function(t){return b.info("Session created",t.sid),t.on("itemAdded",(function(t){return e.processCommandResponse(t.item)})),t.on("itemUpdated",(function(t){return e.processCommandResponse(t.item)})),t.on("contextUpdated",(function(t){return e.handleContextUpdate(t.context)})),t})).catch((function(e){throw b.error("Failed to create session",e),e})),this.sessionStreamPromise}},{key:"addCommand",value:function(e,t){return this.processCommand(e,t)}},{key:"processCommand",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=new y;return s.request=t,s.request.action=e,s.commandId=u.v4(),b.info("Adding command: ",e,s.commandId),b.debug("command arguments:",t,i),new r.default((function(r,o){n.sessionStreamPromise.then((function(e){return n.pendingCommands.set(s.commandId,{resolve:r,reject:o,commandId:s.commandId,request:s.request}),e.push(s)})).then((function(){return b.debug("Command accepted by server",s.commandId)})).catch((function(a){n.pendingCommands.delete(s.commandId),b.error("Failed to add a command to the session",a),a.code!=h.ResponseCodes.ACCESS_FORBIDDEN_FOR_IDENTITY&&a.code!==h.ResponseCodes.LIST_NOT_FOUND||!i?o(new Error("Can't add command: "+a.message)):(b.info("recreating session..."),n.initialize(),r(n.processCommand(e,t,!1)))}))}))}},{key:"processCommandResponse",value:function(e){if(e.value.hasOwnProperty("response")&&e.value.hasOwnProperty("commandId")&&this.pendingCommands.has(e.value.commandId)){var t=e.value,n=e.value.commandId;if(t.response.status===h.ResponseCodes.HTTP_200_OK){b.debug("Command succeeded: ",t);var i=this.pendingCommands.get(n).resolve;this.pendingCommands.delete(n),i(t.response)}else{b.error("Command failed: ",t);var s=this.pendingCommands.get(n).reject;this.pendingCommands.delete(n),s(new f.SessionError(t.response.statusText,t.response.status))}}}},{key:"getSessionContext",value:function(){return this.sessionStreamPromise.then((function(e){return e.getContext()}))}},{key:"getSessionLinks",value:(C=(0,s.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",{publicChannelsUrl:this.config.baseUrl+(t=e.sent).links.publicChannelsUrl,myChannelsUrl:this.config.baseUrl+t.links.myChannelsUrl,typingUrl:this.config.baseUrl+t.links.typingUrl,syncListUrl:this.config.baseUrl+t.links.syncListUrl,usersUrl:this.config.baseUrl+t.links.usersUrl,mediaServiceUrl:t.links.mediaServiceUrl});case 4:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"getChannelsId",value:(_=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",e.sent.channels);case 4:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"getMyChannelsId",value:(p=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",e.sent.myChannels);case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getMaxUserInfosToSubscribe",value:(c=(0,s.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return t=e.sent,e.abrupt("return",this.config.userInfosToSubscribeOverride||t.userInfosToSubscribe||this.config.userInfosToSubscribeDefault);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getUsersData",value:function(){return this.sessionInfo.promise.then((function(e){return{user:e.userInfo,identity:e.identity}}))}},{key:"getConsumptionReportInterval",value:(n=(0,s.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSessionContext();case 2:return t=e.sent,n=this.config.consumptionReportIntervalOverride||t.consumptionReportInterval||this.config.consumptionReportIntervalDefault,e.prev=4,e.abrupt("return",m.toSeconds(m.parse(n)));case 8:return e.prev=8,e.t0=e.catch(4),b.error("Failed to parse consumption report interval",n,"using default value",this.config.consumptionReportIntervalDefault),e.abrupt("return",m.toSeconds(m.parse(this.config.consumptionReportIntervalDefault)));case 12:case"end":return e.stop()}}),e,this,[[4,8]])}))),function(){return n.apply(this,arguments)})},{key:"getHttpCacheInterval",value:(t=(0,s.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSessionContext();case 2:return t=e.sent,n=this.config.httpCacheIntervalOverride||t.httpCacheInterval||this.config.httpCacheIntervalDefault,e.prev=4,e.abrupt("return",m.toSeconds(m.parse(n)));case 8:return e.prev=8,e.t0=e.catch(4),b.error("Failed to parse cache interval",n,"using default value",this.config.httpCacheIntervalDefault),e.abrupt("return",m.toSeconds(m.parse(this.config.httpCacheIntervalDefault)));case 12:case"end":return e.stop()}}),e,this,[[4,8]])}))),function(){return t.apply(this,arguments)})},{key:"identity",get:function(){return this.sessionInfo.current.identity}},{key:"reachabilityEnabled",get:function(){return this.currentContext.reachabilityEnabled}}]),e}();t.Session=_},hRWM:function(e){e.exports=JSON.parse('{"_args":[["twilio-sync@0.13.0","D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin"]],"_from":"twilio-sync@0.13.0","_id":"twilio-sync@0.13.0","_inBundle":false,"_integrity":"sha512-3SfV2zQh6B2g+Tl7McYvcLH4/2IEZShXN7Lm/7GDkNnBSCtmX8cJLd5uOE1Vrj2pCXVXD9Ty2dxJlE4cDwBwlg==","_location":"/twilio-sync","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"twilio-sync@0.13.0","name":"twilio-sync","escapedName":"twilio-sync","rawSpec":"0.13.0","saveSpec":null,"fetchSpec":"0.13.0"},"_requiredBy":["/twilio-chat"],"_resolved":"https://registry.npmjs.org/twilio-sync/-/twilio-sync-0.13.0.tgz","_spec":"0.13.0","_where":"D:\\\\Software\\\\Blue\\\\a-plato-puesto-admin","author":{"name":"Twilio"},"browserify":{"transform":["babelify"]},"dependencies":{"loglevel":"^1.6.3","operation-retrier":"^3.0.0","platform":"^1.3.6","twilio-notifications":"^0.5.11","twilsock":"^0.6.1","uuid":"^3.3.2"},"description":"Twilio Sync client library","devDependencies":{"@types/chai":"^4.1.7","@types/chai-as-promised":"7.1.0","@types/chai-string":"^1.4.1","@types/mocha":"^5.2.7","@types/node":"^12.0.4","@types/sinon":"^7.0.12","@types/sinon-chai":"^3.2.2","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-runtime":"^6.26.0","babelify":"^8.0.0","browserify":"^16.2.3","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.0","del":"^4.1.1","fancy-log":"^1.3.3","fs":"0.0.2","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^2.0.2","gulp-insert":"^0.5.0","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^1.0.1","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.4","ink-docstrap":"^1.3.2","jsdoc":"~3.5.5","jsonwebtoken":"^8.5.1","karma":"^4.1.0","karma-browserify":"^6.0.0","karma-browserstack-launcher":"^1.5.1","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","mocha":"^6.1.4","nyc":"^14.1.1","path":"^0.12.7","sinon":"^7.3.2","sinon-chai":"^3.3.0","source-map-explorer":"^1.8.0","ts-node":"^8.2.0","tslint":"^5.17.0","twilio":"^3.31.1","typescript":"^3.5.1","uglify-es":"^3.3.10","uglify-save-license":"^0.4.1","underscore":"^1.9.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0","watchify":"^3.11.1"},"engines":{"node":">=8"},"license":"MIT","main":"lib/index.js","name":"twilio-sync","types":"./lib/index.d.ts","version":"0.13.0"}')},heda:function(e,t,n){var i=n("GhSp"),s=n("d+lc"),r=n("mHY4");e.exports=n("C61u")?Object.defineProperties:function(e,t){s(e);for(var n,o=r(t),a=o.length,l=0;a>l;)i.f(e,n=o[l++],t[n]);return e}},iCc5:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},iL38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0,t.Configuration=class{constructor(e,t,n={}){this.confirmedCapabilities=new Set,this.activeGrant=t,this._token=e,this.url=(n.twilsock||n.Twilsock||{}).uri||`wss://tsock.${n.region||"us1"}.twilio.com/v3/wsconnect`,this._continuationToken=n.continuationToken?n.continuationToken:null,this.logLevel=n.logLevel?n.logLevel:"error",this.retryPolicy=n.retryPolicy?n.retryPolicy:{min:1e3,max:12e4,randomness:.2},this.clientMetadata=n.clientMetadata?n.clientMetadata:{},this.clientMetadata.ver="0.6.1",this.initRegistrations=n.initRegistrations?n.initRegistrations:null,this.tweaks=n.tweaks?n.tweaks:null}get token(){return this._token}get continuationToken(){return this._continuationToken}updateToken(e){this._token=e}updateContinuationToken(e){this._continuationToken=e}}},iWbE:function(e,t,n){"use strict";var i=h(n("14Xm")),s=h(n("D3Ub")),r=h(n("4d7F")),o=h(n("FyfS")),a=h(n("sk9p")),l=h(n("P2sY")),c=h(n("ODRq")),u=h(n("iCc5")),d=h(n("V7oC"));function h(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Network=void 0;var p=n("vSOj"),f=function(){function e(t,n){var i=this;(0,u.default)(this,e),this.config=t,this.services=n,this.cache=new c.default,this.cacheLifetime=0,this.services.session.getHttpCacheInterval().then((function(e){i.cacheLifetime=1e3*e,i.cleanupCache()}))}var t;return(0,d.default)(e,[{key:"backoffConfig",value:function(){return(0,l.default)(this.config.backoffConfigDefault,this.config.backoffConfigOverride)}},{key:"retryWhenThrottled",value:function(){return void 0!==this.config.retryWhenThrottledOverride?this.config.retryWhenThrottledOverride:void 0!==this.config.retryWhenThrottledDefault&&this.config.retryWhenThrottledDefault}},{key:"isExpired",value:function(e){return!this.cacheLifetime||Date.now()-e>this.cacheLifetime}},{key:"cleanupCache",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,s=(0,o.default)(this.cache);!(e=(i=s.next()).done);e=!0){var r=(0,a.default)(i.value,2),l=r[0];this.isExpired(r[1].timestamp)&&this.cache.delete(l)}}catch(c){t=!0,n=c}finally{try{!e&&s.return&&s.return()}finally{if(t)throw n}}0===this.cache.size&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var e=this;this.timer=this.timer||setInterval((function(){return e.cleanupCache()}),2*this.cacheLifetime)}},{key:"executeWithRetry",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new r.default((function(i,s){var r=[502,503,504];n&&r.push(429);var o=new p.Retrier(t.backoffConfig());o.on("attempt",(function(){e().then((function(e){return o.succeeded(e)})).catch((function(e){r.indexOf(e.status)>-1?o.failed(e):"Twilsock disconnected"===e.message?o.failed(e):(o.removeAllListeners(),o.cancel(),s(e))}))})),o.on("succeeded",(function(e){i(e)})),o.on("cancelled",(function(e){return s(e)})),o.on("failed",(function(e){return s(e)})),o.start()}))}},{key:"get",value:(t=(0,s.default)(i.default.mark((function e(t){var n,s,r,o=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))||this.isExpired(n.timestamp)){e.next=3;break}return e.abrupt("return",n.response);case 3:return s={},e.next=6,this.executeWithRetry((function(){return o.services.transport.get(t,s,o.config.productId)}),this.retryWhenThrottled());case 6:return this.cache.set(t,{response:r=e.sent,timestamp:Date.now()}),this.pokeTimer(),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.Network=f},"iZ5/":function(e,t,n){var i=n("BRsN");e.exports=function(e,t,n){for(var s in t)n&&e[s]?e[s]=t[s]:i(e,s,t[s]);return e}},ig3W:function(e,t){e.exports={}},ioUz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;const i=n("MZ0W");function s(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)).length}function r(e){let t=Array.prototype.map.call(e,e=>String.fromCharCode(e)).join("").replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(t)}function o(e){return JSON.parse(r(e))}t.Parser=class{constructor(){}static parse(e){const t=new Uint8Array(e),n=function(e){let t="",n=0;for(;n<e.length;++n){const i=String.fromCharCode(e[n]);if(t+=i,"\r"===i){n+=2;break}}const i=t.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}(t);if("TWILSOCK"!==n.protocol||"V3.0"!==n.version)return void i.log.error(`unsupported protocol: ${n.protocol} ver ${n.version}`);let s=null;try{s=o(t.subarray(n.size,n.size+n.headerSize))}catch(l){return void i.log.error("failed to parse message header",l,e)}i.log.debug("message received: ",s.method),i.log.trace("message received: ",s);let a=null;if(s.payload_size>0){const c=2+n.size+n.headerSize,u=s.payload_size;if(s.hasOwnProperty("payload_type")&&0!==s.payload_type.indexOf("application/json"))0===s.payload_type.indexOf("text/plain")&&(a=r(t.subarray(c,c+u)));else try{a=o(t.subarray(c,c+u))}catch(l){return void i.log.error("failed to parse message body",l,e)}}return{method:s.method,header:s,payload:a}}static createPacket(e,t=""){e.payload_size=s(t);let n=JSON.stringify(e)+"\r\n",r="TWILSOCK V3.0 "+(s(n)-2)+"\r\n";return i.log.debug("send request:",r+n+t),function(e){let t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)),n=new Uint8Array(t.length);return Array.prototype.forEach.call(t,(e,t)=>{n[t]=e.charCodeAt(0)}),n}(r+n+t).buffer}}},iocF:function(e,t,n){var i=n("USwo");i(i.P+i.R,"Set",{toJSON:n("KtlF")("Set")})},iqZd:function(e,t,n){"use strict";var i=o(n("iCc5")),s=o(n("V7oC")),r=o(n("gDS+"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAttributes=t.parseTime=t.parseToNumber=t.UriBuilder=t.deepClone=t.isDeepEqual=void 0;var a=n("L5Xn");t.isDeepEqual=function(e,t){return 0===a.createPatch(e,t).length},t.deepClone=function(e){return JSON.parse((0,r.default)(e))},t.parseToNumber=function(e){return void 0===e||isNaN(Number(e))?null:Number(e)},t.parseTime=function(e){try{return new Date(e)}catch(t){return null}},t.parseAttributes=function(e,t,n){var i={};if(e)try{i=JSON.parse(e)}catch(s){n.warn(t,s)}return i};var l=function(){function e(t){(0,i.default)(this,e),this.base=t.replace(/\/$/,""),this.args=[],this.paths=[]}return(0,s.default)(e,[{key:"arg",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"path",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}();t.UriBuilder=l},iqsF:function(e,t,n){var i=n("aqg2"),s=n("zBWt")("iterator"),r=n("ig3W");e.exports=n("VSTI").isIterable=function(e){var t=Object(e);return void 0!==t[s]||"@@iterator"in t||r.hasOwnProperty(i(t))}},ixoo:function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},j3KZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("+qE3");function s(e){return null!=e}class r extends i.EventEmitter{constructor(e){if(super(),s((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(s(e.maxDelay)&&e.maxDelay<=1)throw new Error("The maximal timeout must be greater than 1.");if(s(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");if(s(e.factor)&&e.factor<=1)throw new Error("Exponential factor should be greater than 1.");if(this.initialDelay=e.initialDelay||100,this.maxDelay=e.maxDelay||1e4,this.maxDelay<=this.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");this.randomisationFactor=e.randomisationFactor||0,this.factor=e.factor||2,this.maxNumberOfRetry=-1,this.reset()}static exponential(e){return new r(e)}backoff(e){null==this.timeoutID&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",e),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,e)))}reset(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,clearTimeout(this.timeoutID),this.timeoutID=null}failAfter(e){if(e<=0)throw new Error(`Expected a maximum number of retry greater than 0 but got ${e}`);this.maxNumberOfRetry=e}next(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;let e=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*e))}onBackoff(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}t.Backoff=r,t.default=r},jWXv:function(e,t,n){e.exports={default:n("r6fa"),__esModule:!0}},je5X:function(e,t,n){"use strict";var i=a(n("4d7F")),s=a(n("ODRq")),r=a(n("iCc5")),o=a(n("V7oC"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TypingIndicator=void 0;var l=n("yC9A"),c=n("dDpT"),u=l.Logger.scope("TypingIndicator"),d=function(){function e(t,n,i){(0,r.default)(this,e),this.config=t,this.services=n,this.getChannel=i,this.serviceTypingTimeout=null,this.sentUpdates=new s.default}return(0,o.default)(e,[{key:"initialize",value:function(){var e=this;this.services.notificationClient.subscribe(c.NotificationTypes.TYPING_INDICATOR,"twilsock"),this.services.notificationClient.on("message",(function(t,n){t===c.NotificationTypes.TYPING_INDICATOR&&e.handleRemoteTyping(n)}))}},{key:"handleRemoteTyping",value:function(e){var t=this;u.trace("Got new typing indicator ",e),this.getChannel(e.channel_sid).then((function(n){n&&n.members.forEach((function(n){n.identity===e.identity&&n._startTyping(t.config.typingIndicatorTimeoutOverride+1e3||1e3*e.typing_timeout)}))})).catch((function(e){throw u.error(e),e}))}},{key:"send",value:function(e){var t=this.sentUpdates.get(e);return t&&t>Date.now()-this.typingTimeout?i.default.resolve():(this.sentUpdates.set(e,Date.now()),this._send(e))}},{key:"_send",value:function(e){var t=this;return u.trace("Sending typing indicator"),this.services.transport.post(this.config.typingIndicatorUri,{"Content-Type":"application/x-www-form-urlencoded"},"ChannelSid="+e,this.config.productId).then((function(e){e.body.hasOwnProperty("typing_timeout")&&(t.serviceTypingTimeout=1e3*e.body.typing_timeout)})).catch((function(e){throw u.error("Failed to send typing indicator:",e),e}))}},{key:"typingTimeout",get:function(){return this.config.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.config.typingIndicatorTimeoutDefault}}]),e}();t.TypingIndicator=d},jlxs:function(e,t,n){var i=n("7whZ").navigator;e.exports=i&&i.userAgent||""},jssz:function(e,t,n){var i=n("7whZ"),s=n("vOBO").set,r=i.MutationObserver||i.WebKitMutationObserver,o=i.process,a=i.Promise,l="process"==n("TYje")(o);e.exports=function(){var e,t,n,c=function(){var i,s;for(l&&(i=o.domain)&&i.exit();e;){s=e.fn,e=e.next;try{s()}catch(r){throw e?n():t=void 0,r}}t=void 0,i&&i.enter()};if(l)n=function(){o.nextTick(c)};else if(!r||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);n=function(){u.then(c)}}else n=function(){s.call(i,c)};else{var d=!0,h=document.createTextNode("");new r(c).observe(h,{characterData:!0}),n=function(){h.data=d=!d}}return function(i){var s={fn:i,next:void 0};t&&(t.next=s),e||(e=s,n()),t=s}}},"k/8l":function(e,t,n){e.exports={default:n("e56k"),__esModule:!0}},"k1+U":function(e,t,n){"use strict";var i=r(n("iCc5")),s=r(n("V7oC"));function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelDescriptor=void 0;var o=n("yC9A"),a=n("iqZd"),l=o.Logger.scope("ChannelDescriptor"),c=function(){function e(t,n){(0,i.default)(this,e),this.client=t,this.descriptor=n,n.sid?(this.sid=n.sid,this.channel=n.sid+".channel"):(this.sid=n.channel_sid,this.channel=n.channel_sid+".channel"),this.uniqueName=n.unique_name,this.friendlyName=n.friendly_name,this.attributes=a.parseAttributes(n.attributes,"Failed to parse channel attributes",l),this.createdBy=n.created_by,this.dateCreated=a.parseTime(n.date_created),this.dateUpdated=a.parseTime(n.date_updated),this.messagesCount=n.messages_count,this.membersCount=n.members_count,this.type=n.type,this.isPrivate="private"==n.type,this.lastConsumedMessageIndex=n.last_consumed_message_index,n.notification_level&&(this.notificationLevel=n.notification_level),this.status=n.status?n.status:"unknown"}return(0,s.default)(e,[{key:"getChannel",value:function(){return this.client.getChannelBySid(this.sid)}}]),e}();t.ChannelDescriptor=c},kMt3:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("Kj3r"),s=n("/uUt"),r=n("eIep"),o=n("s7LF"),a=n("quSY");class l{constructor(e,t,n,i,s,r){this.data=e,this.dialogRef=t,this.reservationsService=n,this.restaurantService=i,this.fb=s,this.snackBar=r,this.currentRestaurantSubscription=a.a.EMPTY,this.amountValidators=[o.x.required,o.x.min(1)],this.commentsValidators=[o.x.maxLength(500)],this.form=this.fb.group({search:new o.h(""),amount:new o.h(1,this.amountValidators),comments:new o.h("",this.commentsValidators)}),this.submitted=!1,this.dishes=[],this.selectedDishId=null,this.groupModifiers=[]}ngOnInit(){this.getRestaurantInfo(),this.initSearchListener()}getRestaurantInfo(){this.currentRestaurantSubscription=this.restaurantService.currentRestaurant.subscribe(e=>{e&&(this.currentRestaurantSubscription.unsubscribe(),this.restaurantSelected=e)})}initSearchListener(){this.form.get("search").valueChanges.pipe(Object(i.a)(200),Object(s.a)(),Object(r.a)(e=>this.reservationsService.searchDishes(this.restaurantSelected.id,e))).subscribe(e=>{this.selectedDishId=void 0,this.groupModifiers=[],this.submitted=!1,this.dishes=e.results.sort((e,t)=>e.name>t.name?1:e.name<t.name?-1:0),this.toFormGroup()})}toFormGroup(){const e={search:new o.h(this.form.get("search").value),amount:new o.h(this.form.get("amount").value,this.amountValidators),comments:new o.h(this.form.get("comments").value,this.commentsValidators)};for(const t of this.groupModifiers)if(t.multiple_option)for(const n of t.modifiers)e["check-"+n.id]=new o.h(!1);else e["radio-"+t.id]=new o.h(null);this.form=new o.k(e),this.initSearchListener()}getDishDetails(e){this.selectedDishId=e,this.groupModifiers=[],this.reservationsService.getDishDetails(e).subscribe(e=>{this.groupModifiers=e.dish.group_modifiers,this.toFormGroup()})}submit(){if(this.submitted=!0,this.form.valid&&this.areDishesCorrect){const e=this.getProductToAdd();this.reservationsService.addProductToOrder(this.data.orderId,e).subscribe(()=>{this.closeDialog(!0)})}else this.snackBar.open("Favor de revisar la selecci\xf3n de elementos","Entendido",{duration:15e3})}getProductToAdd(){const e=[];for(const t of this.groupModifiers)if(t.multiple_option){const n=[];for(const e of t.modifiers)this.form.get("check-"+e.id).value&&n.push({id:e.id});n.length>0&&e.push({id:t.id,modifiers:n})}else{const n=this.form.get("radio-"+t.id);null!==n.value&&e.push({id:t.id,modifiers:[{id:n.value}]})}return{id:this.selectedDishId,amount:this.form.get("amount").value,modifier_group:e,comments:this.form.get("comments").value?this.form.get("comments").value:void 0}}get areDishesCorrect(){for(const e of this.groupModifiers)if(!this.isGroupCorrect(e))return!1;return!0}isGroupCorrect(e){if(e.multiple_option){const t=[];for(const i of e.modifiers){const e=this.form.get("check-"+i.id);t.push(e)}let n=0;for(const e of t)e.value&&(n+=1);if(0===n&&e.optional_ask)return!0;if(e.min_options_per_user<=n&&e.max_options_per_user>=n)return!0}else if(this.form.get("radio-"+e.id).value||e.optional_ask)return!0;return!1}changeAmountByOne(e){const t=this.form.get("amount");"add"===e?t.setValue(t.value+1):"subtract"===e&&t.value>1&&t.setValue(t.value-1)}closeDialog(e){this.dialogRef.close(e)}}},kUGv:function(e,t,n){var i=n("7whZ").document;e.exports=i&&i.documentElement},kUwj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransportUnavailableError=t.TwilsockError=t.Twilsock=t.TwilsockClient=void 0;const i=n("+fG6");Object.defineProperty(t,"TwilsockClient",{enumerable:!0,get:function(){return i.TwilsockClient}}),Object.defineProperty(t,"Twilsock",{enumerable:!0,get:function(){return i.TwilsockClient}});const s=n("arZA");Object.defineProperty(t,"TwilsockError",{enumerable:!0,get:function(){return s.TwilsockError}});const r=n("ovLx");Object.defineProperty(t,"TransportUnavailableError",{enumerable:!0,get:function(){return r.TransportUnavailableError}})},kcqV:function(e,t,n){var i=n("bKEA"),s=n("TSC6").f;n("czaS")("getOwnPropertyDescriptor",(function(){return function(e,t){return s(i(e),t)}}))},kfVJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("+qE3");class s extends i.EventEmitter{constructor(e){super(),this.minDelay=e.min,this.maxDelay=e.max,this.initialDelay=e.initial||0,this.maxAttemptsCount=e.maxAttemptsCount||0,this.maxAttemptsTime=e.maxAttemptsTime||0,this.randomness=e.randomness||0,this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}attempt(){clearTimeout(this.timeout),this.attemptNum++,this.timeout=null,this.emit("attempt",this)}nextDelay(e){if("number"==typeof e)return this.prevDelay=0,this.currDelay=e,e;if(0==this.attemptNum)return this.initialDelay;if(1==this.attemptNum)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;let t=this.currDelay+this.prevDelay;return this.maxDelay&&t>this.maxDelay&&(this.currDelay=this.maxDelay,t=this.maxDelay),this.currDelay=t,t}randomize(e){let t=e*this.randomness,n=Math.round(Math.random()*t*2-t);return Math.max(0,e+n)}scheduleAttempt(e){if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount)return this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached")),void this.reject(new Error("Maximum attempt count reached"));let t=this.nextDelay(e);if(t=this.randomize(t),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+t)return this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached")),void this.reject(new Error("Maximum attempt time limit reached"));this.timeout=setTimeout(()=>this.attempt(),t)}cleanup(){clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}start(){if(this.inProgress)throw new Error("Retrier is already in progress");return this.inProgress=!0,new Promise((e,t)=>{this.resolve=e,this.reject=t,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)})}cancel(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"),this.reject(new Error("Cancelled")))}succeeded(e){this.emit("succeeded",e),this.resolve(e)}failed(e,t){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(t)}run(e){return this.on("attempt",()=>{e().then(e=>this.succeeded(e)).catch(e=>this.failed(e))}),this.start()}}t.Retrier=s,t.default=s},kvAF:function(e,t,n){var i=n("GhSp").f,s=n("nA4W"),r=n("zBWt")("toStringTag");e.exports=function(e,t,n){e&&!s(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},kyWA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncStreamImpl=t.SyncStream=void 0;const i=n("BUbV"),s=n("IMmU"),r=n("PEWQ");class o extends i.SyncEntity{constructor(e,t,n){super(e,n),this.descriptor=t}get uri(){return this.descriptor.url}get links(){return this.descriptor.links}static get type(){return"stream"}get dateExpires(){return this.descriptor.date_expires}get type(){return"stream"}get lastEventId(){return null}get indexName(){}get queryString(){}get sid(){return this.descriptor.sid}get uniqueName(){return this.descriptor.unique_name||null}async publishMessage(e){const t={data:e},n=await this.services.network.post(this.links.messages,t);return this._handleMessagePublished(n.body.sid,e,!1)}async setTtl(e){s.validateMandatoryTtl(e);try{const t={ttl:e},n=await this.services.network.post(this.uri,t);this.descriptor.date_expires=n.body.date_expires}catch(t){throw 404===t.status&&this.onRemoved(!1),t}}async removeStream(){await this.services.network.delete(this.uri),this.onRemoved(!0)}_update(e){switch(e.type){case"stream_message_published":this._handleMessagePublished(e.message_sid,e.message_data,!0);break;case"stream_removed":this.onRemoved(!1)}}_handleMessagePublished(e,t,n){const i={sid:e,value:t};return this.broadcastEventToListeners("messagePublished",{message:i,isLocal:!n}),i}onRemoved(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}}t.SyncStreamImpl=o;class a extends r.default{constructor(e){super(),this.syncStreamImpl=e,this.syncStreamImpl.attach(this)}get uri(){return this.syncStreamImpl.uri}get links(){return this.syncStreamImpl.links}static get type(){return o.type}get dateExpires(){return this.syncStreamImpl.dateExpires}get type(){return o.type}get lastEventId(){return null}get sid(){return this.syncStreamImpl.sid}get uniqueName(){return this.syncStreamImpl.uniqueName}async publishMessage(e){return this.ensureNotClosed(),this.syncStreamImpl.publishMessage(e)}async setTtl(e){return this.ensureNotClosed(),this.syncStreamImpl.setTtl(e)}async removeStream(){return this.ensureNotClosed(),this.syncStreamImpl.removeStream()}close(){super.close(),this.syncStreamImpl.detach(this.listenerUuid)}}t.SyncStream=a,t.default=a},"l+6R":function(e,t,n){n("1i29")("Map")},l0Kd:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},m1cH:function(e,t,n){"use strict";t.__esModule=!0;var i,s=(i=n("rfXi"))&&i.__esModule?i:{default:i};t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,s.default)(e)}},mB9D:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const i=n("+qE3"),s=n("fJKg"),r=n("D0ik"),o=n("pjvd"),a=n("Q3x1");t.Client=class extends i.EventEmitter{constructor(e,t={}){if(super(),!e||0===e.length)throw new Error("Token is required for Notifications client");t.logLevel=t.logLevel||"error",a.log.setLevel(t.logLevel);const n=t.productId||"notifications";t.twilsockClient=t.twilsockClient||new s.TwilsockClient(e,n,t),t.transport=t.transport||t.twilsockClient,this.services={twilsock:t.twilsockClient,transport:t.transport,config:new r.Configuration(null,t)},this.registrar=new o.Registrar(n,this.services.transport,this.services.twilsock,this.services.config),this.reliableTransportState={overall:!1,transport:!1,registration:!1,lastEmitted:null},this._onTransportStateChange(this.services.twilsock.isConnected),this.registrar.on("transportReady",e=>{this._onRegistrationStateChange(e?"registered":"")}),this.registrar.on("stateChanged",e=>{this._onRegistrationStateChange(e)}),this.registrar.on("needReliableTransport",this._onNeedReliableTransport.bind(this)),this.services.twilsock.on("message",(e,t)=>this._routeMessage(e,t)),this.services.twilsock.on("connected",e=>{this._onTransportStateChange(!0),this.registrar.setNotificationId("twilsock",e)}),this.services.twilsock.on("disconnected",()=>{this._onTransportStateChange(!1)}),this.services.config.updateToken(e),this.registrar.updateToken(e)}get connectionState(){return"disconnected"===this.services.twilsock.state?"disconnected":"disconnecting"===this.services.twilsock.state?"disconnecting":"connected"===this.services.twilsock.state&&this.reliableTransportState.registration?"connected":"rejected"===this.services.twilsock.state?"denied":"connecting"}_routeMessage(e,t){a.log.trace("Message arrived: ",e,t),this.emit("message",e,t)}_onNeedReliableTransport(e){e?this.services.twilsock.connect():this.services.twilsock.disconnect()}_onRegistrationStateChange(e){this.reliableTransportState.registration="registered"===e,this._updateTransportState()}_onTransportStateChange(e){this.reliableTransportState.transport=e,this._updateTransportState()}_updateTransportState(){const e=this.reliableTransportState.transport&&this.reliableTransportState.registration;this.reliableTransportState.overall!==e&&(this.reliableTransportState.overall=e,a.log.info("Transport ready:",e),this.emit("transportReady",e)),this.reliableTransportState.lastEmitted!==this.connectionState&&(this.reliableTransportState.lastEmitted=this.connectionState,this.emit("connectionStateChanged",this.connectionState))}subscribe(e,t="twilsock"){return a.log.trace("Add subscriptions for message type: ",e,t),this.registrar.subscribe(e,t)}unsubscribe(e,t="twilsock"){return a.log.trace("Remove subscriptions for message type: ",e,t),this.registrar.unsubscribe(e,t)}handlePushNotification(e){return{messageType:e.twi_message_type,payload:e.payload}}setPushRegistrationId(e,t){a.log.trace("Set push registration id",e,t),this.registrar.setNotificationId(t,e)}async updateToken(e){a.log.info("authTokenUpdated"),this.services.config.token!==e&&(await this.services.twilsock.updateToken(e),this.services.config.updateToken(e),this.registrar.updateToken(e))}}},mHY4:function(e,t,n){var i=n("A9a0"),s=n("l0Kd");e.exports=Object.keys||function(e){return i(e,s)}},mK5Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapItem=void 0,t.MapItem=class{constructor(e){this.descriptor=e}get uri(){return this.descriptor.url}get revision(){return this.descriptor.revision}get lastEventId(){return this.descriptor.last_event_id}get dateExpires(){return this.descriptor.date_expires}get key(){return this.descriptor.key}get value(){return this.descriptor.data}get dateUpdated(){return this.descriptor.date_updated}update(e,t,n,i){return this.descriptor.last_event_id=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.date_updated=i,this}updateDateExpires(e){this.descriptor.date_expires=e}}},mRg0:function(e,t,n){"use strict";t.__esModule=!0;var i=o(n("s3Ml")),s=o(n("AyUB")),r=o(n("EJiy"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}},miUa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Reply=void 0;const i=n("PmLG");t.Reply=class extends i.AbstractMessage{constructor(e){super(e),this.method="reply",this.payload_type="application/json",this.status={code:200,status:"OK"}}}},myGB:function(e,t,n){n("C5kU"),n("CE4/"),e.exports=n("VSTI").Array.from},n7vu:function(e,t,n){var i=n("TYje");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},nA4W:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},nA69:function(e,t,n){"use strict";const i=n("43rs");e.exports=i},nAx8:function(e,t,n){var i=n("FgkJ");e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,s){return e.call(t,n,i,s)}}return function(){return e.apply(t,arguments)}}},nRFE:function(e,t,n){var i=n("/F7N"),s=Math.max,r=Math.min;e.exports=function(e,t){return(e=i(e))<0?s(e+t,0):r(e,t)}},nhJU:function(e,t,n){n("PJ8w")("Map")},nwU8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Reply=void 0;const i=n("NDb0");t.Reply=class extends i.AbstractMessage{constructor(e){super(e),this.method="reply",this.payload_type="application/json",this.status={code:200,status:"OK"}}}},"o+/m":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransportUnavailableError=void 0;const i=n("7FP+");t.TransportUnavailableError=class extends i.TwilsockError{constructor(e){super(e)}}},oUms:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDocumentImpl=t.SyncDocument=void 0;const i=n("PyJ+"),s=n("IMmU"),r=n("PalJ"),o=n("BUbV"),a=n("oaU9"),l=n("PEWQ");class c extends o.SyncEntity{constructor(e,t,n){super(e,n),this.isDeleted=!1,this.updateMergingQueue=new a.MergingQueue((e,t)=>"number"==typeof t.ttl?{ttl:t.ttl}:e),this.descriptor=t,this.descriptor.data=this.descriptor.data||{},this.descriptor.date_updated=new Date(this.descriptor.date_updated)}get uri(){return this.descriptor.url}get revision(){return this.descriptor.revision}get lastEventId(){return this.descriptor.last_event_id}get dateExpires(){return this.descriptor.date_expires}static get type(){return"document"}get type(){return"document"}get indexName(){}get queryString(){}get sid(){return this.descriptor.sid}get value(){return this.descriptor.data}get dateUpdated(){return this.descriptor.date_updated}get uniqueName(){return this.descriptor.unique_name||null}_update(e){switch(e.date_created=new Date(e.date_created),e.type){case"document_updated":e.id>this.lastEventId?(this.descriptor.last_event_id=e.id,this.descriptor.revision=e.document_revision,this.descriptor.date_updated=e.date_created,this.descriptor.data=e.document_data,this.broadcastEventToListeners("updated",{value:e.document_data,isLocal:!1}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.id,revision:e.document_revision,date_updated:e.date_created,data:e.document_data})):r.default.trace("Document update skipped, current:",this.lastEventId,", remote:",e.id);break;case"document_removed":this.onRemoved(!1)}}async set(e,t){const n=t||{};return s.validateOptionalTtl(n.ttl),this.updateMergingQueue.squashAndAdd(n,t=>this._setUnconditionally(e,t.ttl))}async mutate(e,t){const n=t||{};return s.validateOptionalTtl(n.ttl),this.updateMergingQueue.add(n,t=>this._setWithIfMatch(e,t.ttl))}async update(e,t){return this.mutate(t=>Object.assign(t,e),t)}async setTtl(e){s.validateMandatoryTtl(e);const t=await this._postUpdateToServer({ttl:e});this.descriptor.date_expires=t.date_expires}async _setUnconditionally(e,t){let n=await this._postUpdateToServer({data:e,revision:void 0,ttl:t});return this._handleSuccessfulUpdateResult(n),this.value}async _setWithIfMatch(e,t){let n=e(s.deepClone(this.value));if(!n)return this.value;{let s=this.revision;try{let e=await this._postUpdateToServer({data:n,revision:s,ttl:t});return this._handleSuccessfulUpdateResult(e),this.value}catch(i){if(412===i.status)return await this._softSync(),this._setWithIfMatch(e);throw i}}}_handleSuccessfulUpdateResult(e){e.last_event_id>this.descriptor.last_event_id&&(this.descriptor.revision=e.revision,this.descriptor.data=e.data,this.descriptor.last_event_id=e.last_event_id,this.descriptor.date_expires=e.date_expires,this.descriptor.date_updated=new Date(e.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.last_event_id,revision:e.revision,date_updated:e.date_updated,data:e.data}),this.broadcastEventToListeners("updated",{value:this.value,isLocal:!0}))}async _postUpdateToServer(e){if(this.isDeleted)return Promise.reject(new i.SyncError("The Document has been removed",404,54100));{const n={data:e.data};void 0!==e.ttl&&(n.ttl=e.ttl);const i=e.revision;try{const t=await this.services.network.post(this.uri,n,i);return{revision:t.body.revision,data:e.data,last_event_id:t.body.last_event_id,date_updated:t.body.date_updated,date_expires:t.body.date_expires}}catch(t){throw 404===t.status&&this.onRemoved(!1),t}}}async _softSync(){return this.services.network.get(this.uri).then(e=>(this._update({type:"document_updated",id:e.body.last_event_id,document_revision:e.body.revision,document_data:e.body.data,date_created:e.body.date_updated}),this)).catch(e=>{404===e.status?this.onRemoved(!1):r.default.error(`Can't get updates for ${this.sid}:`,e)})}onRemoved(e){this.isDeleted||(this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e}))}async removeDocument(){if(this.isDeleted)return Promise.reject(new i.SyncError("The Document has been removed",404,54100));await this.services.network.delete(this.uri),this.onRemoved(!0)}}t.SyncDocumentImpl=c;class u extends l.default{constructor(e){super(),this.syncDocumentImpl=e,this.syncDocumentImpl.attach(this)}get uri(){return this.syncDocumentImpl.uri}get revision(){return this.syncDocumentImpl.revision}get lastEventId(){return this.syncDocumentImpl.lastEventId}get dateExpires(){return this.syncDocumentImpl.dateExpires}static get type(){return c.type}get type(){return c.type}get sid(){return this.syncDocumentImpl.sid}get value(){return this.syncDocumentImpl.value}get dateUpdated(){return this.syncDocumentImpl.dateUpdated}get uniqueName(){return this.syncDocumentImpl.uniqueName}async set(e,t){return this.ensureNotClosed(),this.syncDocumentImpl.set(e,t)}async mutate(e,t){return this.ensureNotClosed(),this.syncDocumentImpl.mutate(e,t)}async update(e,t){return this.ensureNotClosed(),this.syncDocumentImpl.update(e,t)}async setTtl(e){return this.ensureNotClosed(),this.syncDocumentImpl.setTtl(e)}async removeDocument(){return this.ensureNotClosed(),this.syncDocumentImpl.removeDocument()}close(){super.close(),this.syncDocumentImpl.detach(this.listenerUuid)}}t.SyncDocument=u,t.default=u},oaU9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NamespacedMergingQueue=t.MergingQueue=void 0;class i{constructor(e){this.queuedRequests=[],this.isRequestInFlight=!1,this.inputMergingFunction=e}add(e,t){let n=new Promise((n,i)=>this.queuedRequests.push({input:e,requestFunction:t,resolve:n,reject:i}));return this.wakeupQueue(),n}squashAndAdd(e,t){let n,i=this.queuedRequests;this.queuedRequests=[],i.length>0?(n=i.map(e=>e.input).reduce(this.inputMergingFunction),n=this.inputMergingFunction(n,e)):n=e;let s=this.add(n,t);return i.forEach(e=>s.then(e.resolve,e.reject)),s}isEmpty(){return 0===this.queuedRequests.length&&!this.isRequestInFlight}wakeupQueue(){if(0!==this.queuedRequests.length&&!this.isRequestInFlight){let e=this.queuedRequests.shift();this.isRequestInFlight=!0,e.requestFunction(e.input).then(e.resolve,e.reject).then(e=>{this.isRequestInFlight=!1,this.wakeupQueue()})}}}t.MergingQueue=i,t.NamespacedMergingQueue=class{constructor(e){this.queueByNamespaceKey=new Map,this.inputReducer=e}async add(e,t,n){return this.invokeQueueMethod(e,e=>e.add(t,n))}async squashAndAdd(e,t,n){return this.invokeQueueMethod(e,e=>e.squashAndAdd(t,n))}async invokeQueueMethod(e,t){this.queueByNamespaceKey.has(e)||this.queueByNamespaceKey.set(e,new i(this.inputReducer));const n=t(this.queueByNamespaceKey.get(e));return this.queueByNamespaceKey.get(e).isEmpty()&&this.queueByNamespaceKey.delete(e),n}}},ovLx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransportUnavailableError=void 0;const i=n("arZA");t.TransportUnavailableError=class extends i.TwilsockError{constructor(e){super(e)}}},pjvd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registrar=void 0;const i=n("+qE3"),s=n("vFc6"),r=n("AqBG");t.Registrar=class extends i.EventEmitter{constructor(e,t,n,i){super(),this.config=i,this.connectors=new Map;const o=this.detectPlatform();this.connectors.set("gcm",new s.RegistrarConnector("gcm",{protocolVersion:3,productId:e,platform:o},t,i)),this.connectors.set("fcm",new s.RegistrarConnector("fcm",{protocolVersion:3,productId:e,platform:o},t,i)),this.connectors.set("apn",new s.RegistrarConnector("apn",{protocolVersion:4,productId:e,platform:o},t,i)),this.connectors.set("twilsock",new r.TwilsockConnector({productId:e,platform:o},n,i)),this.connectors.get("twilsock").on("transportReady",e=>this.emit("transportReady",e))}setNotificationId(e,t){this.connector(e).setNotificationId(t)}subscribe(e,t){return this.connector(t).subscribe(e)}unsubscribe(e,t){return this.connector(t).unsubscribe(e)}updateToken(e){this.connectors.forEach(t=>t.updateToken(e))}connector(e){let t=this.connectors.get(e);if(!t)throw new Error(`Unknown channel type: ${e}`);return t}detectPlatform(){let e="";return"undefined"!=typeof navigator?(e="unknown",void 0!==navigator.product&&(e=navigator.product),void 0!==navigator.userAgent&&(e=navigator.userAgent)):e="web",e.substring(0,128)}}},qFAj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Upstream=void 0;const i=n("MZ0W"),s=n("arZA"),r=n("vDCP"),o=n("bldR"),a=n("ovLx");function l(e,t){const n=function(e){const t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){let e={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],params:null};if(e.search.length>0){let t=e.search.substring(1);e.params=t.split("&").map(e=>e.split("=")).reduce((e,t)=>(e.hasOwnProperty(t[0])?Array.isArray(e[t[0]])?e[t[0]].push(t[1]):e[t[0]]=[e[t[0]],t[1]]:e[t[0]]=t[1],e),{})}return e}throw new s.TwilsockError("Incorrect URI: "+e)}(t);let i={method:e,host:n.host,path:n.pathname};return n.params&&(i.params=n.params),i}t.Upstream=class{constructor(e,t,n){this.config=n,this.transport=e,this.pendingMessages=[],this.twilsock=t}saveMessage(e){return new Promise((t,n)=>{let r={message:e,resolve:t,reject:n,alreadyRejected:!1,timeout:setTimeout(()=>{i.log.debug("request is timed out"),n(new s.TwilsockError("Twilsock: request timeout")),r.alreadyRejected=!0},2e4)};this.pendingMessages.push(r)})}sendPendingMessages(){for(;this.pendingMessages.length;){let t=this.pendingMessages[0];if(!t.alreadyRejected)try{this.actualSend(t.message).then(e=>t.resolve(e)).catch(e=>t.reject(e)),clearTimeout(t.timeout)}catch(e){i.log.debug("Failed to send pending message",e);break}this.pendingMessages.splice(0,1)}}rejectPendingMessages(){this.pendingMessages.forEach(e=>{e.reject(new a.TransportUnavailableError("Unable to connect: "+this.twilsock.getTerminationReason)),clearTimeout(e.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}async actualSend(e){let t=e.to,n=e.headers,i=e.body,s=new o.Message(e.grant?e.grant:this.config.activeGrant,n["Content-Type"]||"application/json",{host:t.host,path:t.path,method:t.method,params:t.params,headers:n}),a=await this.transport.sendWithReply(s,i);if((c=a)&&c.header&&c.header.http_status&&!((l=a.header.http_status.code)>=200&&l<300))throw new r.TwilsockUpstreamError(a.header.http_status.code,a.header.http_status.status,a.body);var l,c;return{status:a.header.http_status,headers:a.header.http_headers,body:a.body}}send(e,t,n={},i,s){if(this.twilsock.isTerminalState)return Promise.reject(new a.TransportUnavailableError("Unable to connect: "+this.twilsock.getTerminationReason));let r=function(e,t,n,i,s){return{to:l(e,t),headers:n,body:i,grant:s}}(e,t,n,i,s);return this.twilsock.isConnected?this.actualSend(r):this.saveMessage(r)}}},"qc9/":function(e,t,n){"use strict";var i=o(n("4d7F")),s=o(n("iCc5")),r=o(n("V7oC"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;var a=function(){function e(){var t=this;(0,s.default)(this,e),this._promise=new i.default((function(e,n){t._resolve=e,t._reject=n}))}return(0,r.default)(e,[{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this.current=e,this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}},{key:"promise",get:function(){return this._promise}}]),e}();t.Deferred=a},ql3t:function(e,t,n){e.exports={default:n("C/FO"),__esModule:!0}},qwtH:function(e,t,n){"use strict";var i=n("iZ5/"),s=n("40oJ").getWeak,r=n("d+lc"),o=n("ekG2"),a=n("ukM9"),l=n("wlNh"),c=n("rNHk"),u=n("nA4W"),d=n("JAUQ"),h=c(5),p=c(6),f=0,g=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},v=function(e,t){return h(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var c=e((function(e,i){a(e,c,t,"_i"),e._t=t,e._i=f++,e._l=void 0,null!=i&&l(i,n,e[r],e)}));return i(c.prototype,{delete:function(e){if(!o(e))return!1;var n=s(e);return!0===n?g(d(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!o(e))return!1;var n=s(e);return!0===n?g(d(this,t)).has(e):n&&u(n,this._i)}}),c},def:function(e,t,n){var i=s(r(t),!0);return!0===i?g(e).set(t,n):i[e._i]=n,e},ufstore:g}},qzTf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=class{constructor(e,t,n){let i=n.MCS||n||{};this.region=i.region||n.region,this.baseUrl=(void 0===this.region?"https://mcs.us1.twilio.com":`https://mcs.${this.region}.twilio.com`)+t,this.token=e,this.retryWhenThrottledOverride=i.retryWhenThrottledOverride,this.backoffConfigOverride=i.backoffConfigOverride}static get backoffConfigDefault(){return{min:1e3,max:4e3,maxAttemptsCount:3}}static get retryWhenThrottledDefault(){return!0}updateToken(e){this.token=e}}},"r+Qc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriptions=void 0;const i=n("vSOj"),s=n("PyJ+"),r=n("PalJ"),o=n("kUwj");class a{constructor(e){this.localObject=e,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}get sid(){return this.localObject.sid}get type(){return this.localObject.type}get lastEventId(){return this.localObject.lastEventId}get indexName(){return this.localObject.indexName}get queryString(){return this.localObject.queryString}get isEstablished(){return this.established}update(e,t){this.localObject._update(e,t)}updatePending(e,t){this.pendingAction=e,this.pendingCorrelationId=t}reset(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}markAsFailed(e){this.rejectedWithError=e.error,this.updatePending(null,null),this.localObject.reportFailure(new s.SyncError(`Failed to subscribe on service events: ${e.error.message}`,e.error.status,e.error.code))}complete(e){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(e)}setSubscriptionState(e){this.localObject._setSubscriptionState(e)}}t.Subscriptions=class{constructor(e){this.isConnected=!1,this.maxBatchSize=100,this.subscriptionTtlTimer=null,this.pendingPokeReason=null,this.services=e,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map,this.backoff=i.Backoff.exponential(Object.assign({randomisationFactor:.2,initialDelay:100,maxDelay:12e4},this.services.config.backoffConfig)),this.backoff.on("ready",()=>{let{action:e,subscriptions:t}=this.getSubscriptionUpdateBatch();e?this.applyNewSubscriptionUpdateBatch(e,t):(this.backoff.reset(),r.default.debug("All subscriptions resolved."))})}getSubscriptionUpdateBatch(){function e(e,t,n,i){let s=[];for(let[r,o]of e)if(!t.get(r)&&n!==o.pendingAction&&!o.rejectedWithError&&(s.push(o),i&&s.length>=i))break;return s}let t=e(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(t.length>0)return{action:"establish",subscriptions:t};let n=e(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return n.length>0?{action:"cancel",subscriptions:n}:{action:null,subscriptions:null}}persist(){this.backoff.backoff()}async applyNewSubscriptionUpdateBatch(e,t){if(!this.isConnected)return r.default.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),void this.backoff.reset();t=this.processLocalActions(e,t);const n=(new Date).getTime();for(const r of t)this.recordActionAttemptOn(r,e,n);let i=this.pendingPokeReason;this.pendingPokeReason=null;try{let s=await this.request(e,n,i,t),o=s.body.max_batch_size;if(!isNaN(parseInt(o))&&isFinite(o)&&o>0&&(this.maxBatchSize=o),!this.subscriptionTtlTimer){let e=s.body.ttl_in_s;!isNaN(parseFloat(e))&&isFinite(e)&&e>0&&(this.subscriptionTtlTimer=setTimeout(()=>this.onSubscriptionTtlElapsed(),1e3*e))}if("establish"===e){const e=s.body.estimated_delivery_in_ms;!isNaN(parseFloat(e))&&isFinite(e)&&e>0?setTimeout(()=>this.verifyPokeDelivery(n,e,t),e):r.default.error(`Invalid timeout: ${e}`),t.filter(e=>e.pendingCorrelationId===n).forEach(e=>e.setSubscriptionState("response_in_flight"))}this.backoff.reset()}catch(s){for(const n of t)this.recordActionFailureOn(n,e);s instanceof o.TransportUnavailableError?(r.default.debug(`Twilsock connection (required for subscription) not ready (c:${n}); waiting\u2026`),this.backoff.reset()):(r.default.debug(`Failed an attempt to ${e} subscriptions (c:${n}); retrying`,s),this.persist())}}verifyPokeDelivery(e,t,n){const i=this.latestPokeResponseArrivalTimestampByCorrelationId.get(e),s=i?(new Date).getTime()-i:t;s>=t?(n.filter(t=>t.pendingCorrelationId===e).forEach(e=>{e.updatePending(null,null),e.retryCount++,this.persisted.delete(e.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(e)):setTimeout(()=>this.verifyPokeDelivery(e,t,n),t-s)}processLocalActions(e,t){return"cancel"===e?t.filter(e=>!e.rejectedWithError):t}recordActionAttemptOn(e,t,n){if(e.setSubscriptionState("request_in_flight"),"establish"===t)this.persisted.set(e.sid,e),e.updatePending(t,n);else{let i=this.persisted.get(e.sid);i&&i.updatePending(t,n)}}recordActionFailureOn(e,t){e.setSubscriptionState("none"),e.updatePending(null,null),"establish"===t&&this.persisted.delete(e.sid)}request(e,t,n,i){let s=i.map(t=>({object_sid:t.sid,object_type:t.type,last_event_id:"establish"===e?t.lastEventId:void 0,index_name:"establish"===e?t.indexName:void 0,query_string:"establish"===e?t.queryString:void 0})),o=i.filter(e=>e.retryCount>0).length;r.default.debug(`Attempting '${e}' request (c:${t}):`,s);const a={event_protocol_version:3,action:e,correlation_id:t,retried_requests:o,ttl_in_s:-1,requests:s};return"ttl"===n&&(a.reason=n),this.services.network.post(this.services.config.subscriptionsUri,a)}add(e,t){r.default.debug(`Establishing intent to subscribe to ${e}`);const n=this.subscriptions.get(e);n&&t&&n.lastEventId===t.lastEventId||(this.persisted.delete(e),this.subscriptions.set(e,new a(t)),this.persist())}remove(e){r.default.debug(`Establishing intent to unsubscribe from ${e}`),this.subscriptions.delete(e)&&this.persist()}acceptMessage(e,t){let n;switch(r.default.trace("Subscriptions received",e),e.correlation_id&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(e.correlation_id,(new Date).getTime()),e.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(e.event,e.correlation_id);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(e.event,e.correlation_id);break;case"subscription_failed":this.applySubscriptionFailedMessage(e.event,e.correlation_id);break;case(n=e.event_type.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{let i;switch(n[0]){case"map_":i=e.event.map_sid;break;case"list_":i=e.event.list_sid;break;case"document_":i=e.event.document_sid;break;case"stream_":i=e.event.stream_sid;break;case"live_query_":i=e.event.query_id,t=!1,!0===e.strictly_ordered&&(t=!0);break;default:i=void 0}this.applyEventToSubscribedEntity(i,e,t)}break;default:r.default.debug(`Dropping unknown message type ${e.event_type}`)}}applySubscriptionEstablishedMessage(e,t){const n=e.object_sid;let i=this.persisted.get(e.object_sid);i&&i.pendingCorrelationId===t?"interrupted"===e.replay_status?(r.default.debug(`Event Replay for subscription to ${n} (c:${t}) interrupted; continuing eagerly.`),i.updatePending(null,null),this.persisted.delete(i.sid),this.backoff.reset()):"completed"===e.replay_status&&(r.default.debug(`Event Replay for subscription to ${n} (c:${t}) completed. Subscription is ready.`),i.complete(e.last_event_id),this.persisted.set(e.object_sid,i),i.setSubscriptionState("established"),this.backoff.reset()):r.default.debug(`Late message for ${e.object_sid} (c:${t}) dropped.`),this.persist()}applySubscriptionCancelledMessage(e,t){let n=this.persisted.get(e.object_sid);n&&n.pendingCorrelationId===t?(n.updatePending(null,null),n.setSubscriptionState("none"),this.persisted.delete(e.object_sid)):r.default.debug(`Late message for ${e.object_sid} (c:${t}) dropped.`),this.persist()}applySubscriptionFailedMessage(e,t){const n=e.object_sid;let i=this.subscriptions.get(n),s=this.persisted.get(n);i&&s?s.pendingCorrelationId===t&&(r.default.error(`Failed to subscribe on ${s.sid}`,e.error),s.markAsFailed(e),s.setSubscriptionState("none")):!i&&s&&(this.persisted.delete(n),s.setSubscriptionState("none")),this.persist()}applyEventToSubscribedEntity(e,t,n){if(!e)return;n=n||(()=>{let t=this.persisted.get(e);return t&&t.isEstablished})();let i=this.subscriptions.get(e);i?(t.event.type=t.event_type,i.update(t.event,n)):r.default.debug(`Message dropped for SID '${e}', for which there is no subscription.`)}onConnectionStateChanged(e){this.isConnected=e,e&&this.poke("reconnect")}onSubscriptionTtlElapsed(){this.isConnected&&this.poke("ttl")}poke(e){r.default.debug(`Triggering event replay for all subscriptions, reason=${e}`),this.pendingPokeReason=e,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);let t=[];for(let n of this.persisted.values())n.reset(),n.rejectedWithError&&t.push(n);this.persisted.clear();for(let n of t)this.persisted.set(n.sid,n);this.persist()}shutdown(){this.backoff.reset(),this.subscriptions.clear()}}},r6fa:function(e,t,n){n("3+Ww"),n("C5kU"),n("ZY/g"),n("PfQu"),n("iocF"),n("Huux"),n("Li4W"),e.exports=n("VSTI").Set},rNHk:function(e,t,n){var i=n("nAx8"),s=n("n7vu"),r=n("CYMq"),o=n("0WpP"),a=n("+WSI");e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,d=6==e,h=5==e||d,p=t||a;return function(t,a,f){for(var g,m,v=r(t),b=s(v),y=i(a,f,3),_=o(b.length),C=0,w=n?p(t,_):l?p(t,0):void 0;_>C;C++)if((h||C in b)&&(m=y(g=b[C],C,v),e))if(n)w[C]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return C;case 2:w.push(g)}else if(u)return!1;return d?-1:c||u?u:w}}},rdj4:function(e,t,n){"use strict";var i=n("GhSp").f,s=n("b08l"),r=n("iZ5/"),o=n("nAx8"),a=n("ukM9"),l=n("wlNh"),c=n("OTpG"),u=n("6jRP"),d=n("va3J"),h=n("C61u"),p=n("40oJ").fastKey,f=n("JAUQ"),g=h?"_s":"size",m=function(e,t){var n,i=p(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,i){a(e,u,t,"_i"),e._t=t,e._i=s(null),e._f=void 0,e._l=void 0,e[g]=0,null!=i&&l(i,n,e[c],e)}));return r(u.prototype,{clear:function(){for(var e=f(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var n=f(this,t),i=m(n,e);if(i){var s=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=s),s&&(s.p=r),n._f==i&&(n._f=s),n._l==i&&(n._l=r),n[g]--}return!!i},forEach:function(e){f(this,t);for(var n,i=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(f(this,t),e)}}),h&&i(u.prototype,"size",{get:function(){return f(this,t)[g]}}),u},def:function(e,t,n){var i,s,r=m(e,t);return r?r.v=n:(e._l=r={i:s=p(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=r),i&&(i.n=r),e[g]++,"F"!==s&&(e._i[s]=r)),e},getEntry:m,setStrong:function(e,t,n){c(e,t,(function(e,n){this._t=f(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),d(t)}}},rfXi:function(e,t,n){e.exports={default:n("myGB"),__esModule:!0}},rifi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockUpstreamError=void 0;const i=n("7FP+");t.TwilsockUpstreamError=class extends i.TwilsockError{constructor(e,t,n){super(t),this.status=e,this.description=t,this.body=n}}},s2er:function(e,t,n){var i=n("VSTI"),s=n("7whZ"),r=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n("5ETA")?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})},s3Ml:function(e,t,n){e.exports={default:n("QRdY"),__esModule:!0}},sbOA:function(e,t,n){var i=n("d+lc"),s=n("I90/");e.exports=n("VSTI").getIterator=function(e){var t=s(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},sk9p:function(e,t,n){"use strict";t.__esModule=!0;var i=r(n("k/8l")),s=r(n("FyfS"));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(Array.isArray(e))return e;if((0,i.default)(Object(e)))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,l=(0,s.default)(e);!(i=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(c){r=!0,o=c}finally{try{!i&&l.return&&l.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},srAY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Close=void 0;const i=n("NDb0");t.Close=class extends i.AbstractMessage{constructor(){super(),this.method="close"}}},"t/pG":function(e,t,n){var i=n("VSTI"),s=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}},u4eC:function(e,t){!function(t){"use strict";var n=Object.prototype,i=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag",l="object"==typeof e,c=t.regeneratorRuntime;if(c)l&&(e.exports=c);else{(c=t.regeneratorRuntime=l?e.exports:{}).wrap=g;var u={},d={};d[r]=function(){return this};var h=Object.getPrototypeOf,p=h&&h(h(S([])));p&&p!==n&&i.call(p,r)&&(d=p);var f=y.prototype=v.prototype=Object.create(d);b.prototype=f.constructor=y,y.constructor=b,y[a]=b.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(f),e},c.awrap=function(e){return{__await:e}},_(C.prototype),C.prototype[o]=function(){return this},c.AsyncIterator=C,c.async=function(e,t,n,i){var s=new C(g(e,t,n,i));return c.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(f),f[a]="Generator",f[r]=function(){return this},f.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},c.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],o=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=i.call(r,"catchLoc"),l=i.call(r,"finallyLoc");if(a&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var s=i.arg;x(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function g(e,t,n,i){var s=Object.create((t&&t.prototype instanceof v?t:v).prototype),r=new O(i||[]);return s._invoke=function(e,t,n){var i="suspendedStart";return function(s,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===s)throw r;return{value:void 0,done:!0}}for(n.method=s,n.arg=r;;){var o=n.delegate;if(o){var a=w(o,n);if(a){if(a===u)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=m(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,r),s}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}function v(){}function b(){}function y(){}function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){var t;this._invoke=function(n,s){function r(){return new Promise((function(t,r){!function t(n,s,r,o){var a=m(e[n],e,s);if("throw"!==a.type){var l=a.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,r,o)}),(function(e){t("throw",e,r,o)})):Promise.resolve(c).then((function(e){l.value=e,r(l)}),o)}o(a.arg)}(n,s,t,r)}))}return t=t?t.then(r,r):r()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=m(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:M}}function M(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},u8T8:function(e,t,n){e.exports={default:n("32R9"),__esModule:!0}},uShU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.Logger=void 0;const i=n("XH0y").getLogger("twilsock");function s(e,t){return[`${(new Date).toISOString()} Twilsock ${e}:`].concat(Array.from(t))}class r{constructor(e){this.prefix="",this.prefix=null!=e&&e.length>0?" "+e+":":""}setLevel(e){i.setLevel(e)}static setLevel(e){i.setLevel(e)}trace(...e){i.debug.apply(null,s("T",e))}debug(...e){i.debug.apply(null,s("D",e))}info(...e){i.info.apply(null,s("I",e))}warn(...e){i.warn.apply(null,s("W",e))}error(...e){i.error.apply(null,s("E",e))}static trace(...e){i.trace.apply(null,s("T",e))}static debug(...e){i.debug.apply(null,s("D",e))}static info(...e){i.info.apply(null,s("I",e))}static warn(...e){i.warn.apply(null,s("W",e))}static error(...e){i.error.apply(null,s("E",e))}}t.Logger=r;let o=new r("");t.log=o},uaGA:function(e,t,n){"use strict";var i=m(n("gDS+")),s=m(n("14Xm")),r=m(n("D3Ub")),o=m(n("4d7F")),a=m(n("Yz+Y")),l=m(n("iCc5")),c=m(n("V7oC")),u=m(n("FYw3")),d=m(n("mRg0")),h=m(n("u8T8")),p=m(n("SEkw")),f=m(n("EJiy")),g=m(n("JO7F"));function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=(0,g.default)(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&(0,p.default)(t,n,o),o},b=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"==typeof h.default)return(0,h.default)(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var y=n("+qE3"),_=n("yC9A"),C=n("iqZd"),w=n("C9Jq"),k=_.Logger.scope("User"),x=function(e){function t(e,n,i){(0,l.default)(this,t);var s=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return s.subscribed="initializing",s.setMaxListeners(0),s.services=i,s.state={identity:e,entityName:n,friendlyName:null,attributes:{},online:null,notifiable:null},s}var n,h,p,f;return(0,d.default)(t,e),(0,c.default)(t,[{key:"_update",value:function(e,t){var n=[];switch(k.debug("User for",this.state.identity,"updated:",e,t),e){case"friendlyName":this.state.friendlyName!==t.value&&(n.push("friendlyName"),this.state.friendlyName=t.value);break;case"attributes":var i=C.parseAttributes(t.value,"Retrieved malformed attributes from the server for user: "+this.state.identity,k);C.isDeepEqual(this.state.attributes,i)||(this.state.attributes=i,n.push("attributes"));break;case"reachability":this.state.online!==t.online&&(this.state.online=t.online,n.push("online")),this.state.notifiable!==t.notifiable&&(this.state.notifiable=t.notifiable,n.push("notifiable"));break;default:return}n.length>0&&this.emit("updated",{user:this,updateReasons:n})}},{key:"_updateReachabilityInfo",value:function(e,t){var n=this;return this.services.session.reachabilityEnabled?e.get("reachability").then(t).catch((function(e){k.warn("Failed to get reachability info for ",n.state.identity,e)})):o.default.resolve()}},{key:"_fetch",value:(f=(0,r.default)(s.default.mark((function e(){var t=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.entityName){e.next=2;break}return e.abrupt("return",this);case 2:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then((function(e){return t.entity=e,e.on("itemUpdated",(function(e){return k.debug(t.state.entityName+" ("+t.state.identity+") itemUpdated: "+e.item.key),t._update(e.item.key,e.item.value)})),o.default.all([e.get("friendlyName").then((function(e){return t._update(e.key,e.value)})),e.get("attributes").then((function(e){return t._update(e.key,e.value)})),t._updateReachabilityInfo(e,(function(e){return t._update(e.key,e.value)}))])})).then((function(){return k.debug("Fetched for",t.identity),t.subscribed="subscribed",t.emit("userSubscribed",t),t})).catch((function(e){throw t.promiseToFetch=null,e})),e.abrupt("return",this.promiseToFetch);case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"_ensureFetched",value:function(){return this.promiseToFetch||this._fetch()}},{key:"updateAttributes",value:(p=(0,r.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("unsubscribed"!=this.subscribed){e.next=2;break}throw new Error("Can't modify unsubscribed object");case 2:return e.next=4,this.services.session.addCommand("editUserAttributes",{username:this.state.identity,attributes:(0,i.default)(t)});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"updateFriendlyName",value:(h=(0,r.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("unsubscribed"!=this.subscribed){e.next=2;break}throw new Error("Can't modify unsubscribed object");case 2:return e.next=4,this.services.session.addCommand("editUserFriendlyName",{username:this.state.identity,friendlyName:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"unsubscribe",value:(n=(0,r.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.promiseToFetch){e.next=7;break}return e.next=3,this.promiseToFetch;case 3:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"identity",get:function(){return this.state.identity},set:function(e){this.state.identity=e}},{key:"entityName",set:function(e){this.state.entityName=e}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"online",get:function(){return this.state.online}},{key:"notifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return"subscribed"==this.subscribed}}]),t}(y.EventEmitter);v([w.asyncTypeCheck(["string","number","boolean","object",w.literal(null)]),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",o.default)],x.prototype,"updateAttributes",null),v([w.asyncTypeCheck(["string",w.literal(null)]),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",o.default)],x.prototype,"updateFriendlyName",null),t.User=x},uccp:function(e,t,n){n("5Qd4"),e.exports=n("VSTI").Object.assign},ugGH:function(e,t,n){e.exports=n("BRsN")},ukM9:function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},v2fs:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UriBuilder=void 0,t.UriBuilder=class{constructor(e){this.base=e,this.args=new Array,this.paths=new Array}pathSegment(e){return this.paths.push(encodeURIComponent(e)),this}queryParam(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}build(){let e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}},vDCP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwilsockUpstreamError=void 0;const i=n("arZA");t.TwilsockUpstreamError=class extends i.TwilsockError{constructor(e,t,n){super(t),this.status=e,this.description=t,this.body=n}}},vFc6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegistrarConnector=t.Connector=void 0;const i=n("vSOj"),s=n("Q3x1"),r=n("3Lba");Object.defineProperty(t,"Connector",{enumerable:!0,get:function(){return r.Connector}});let o={min:2e3,max:12e4,randomness:.2};t.RegistrarConnector=class extends r.Connector{constructor(e,t,n,i){super(i),this.channelType=e,this.context=t,this.transport=n}async updateRegistration(e,t){return t.has("notificationId")&&await this.removeRegistration(),e.notificationId&&e.notificationId.length?(await this.register(e),e):e}async removeRegistration(){if(!this.registrationId)return;const e=`${this.config.registrarUrl}/${this.registrationId}?productId=${this.context.productId}`,t={"Content-Type":"application/json","X-Twilio-Token":this.config.token};try{s.log.trace("Removing registration for ",this.channelType),await new i.Retrier(Object.assign(o,{maxAttemptsCount:3})).run(()=>this.transport.delete(e,t)),s.log.debug("Registration removed for",this.channelType)}catch(n){throw s.log.error("Failed to remove of registration ",this.channelType,n),n}}async register(e){s.log.trace("Registering",this.channelType,e);let t={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(e.messageTypes),data:{registration_id:e.notificationId},ttl:"PT24H"};const n=`${this.config.registrarUrl}?productId=${this.context.productId}`,r={"Content-Type":"application/json","X-Twilio-Token":e.token};s.log.trace("Creating registration for channel ",this.channelType);try{let e=await new i.Retrier(o).run(()=>this.transport.post(n,r,t));this.registrationId=e.body.id,s.log.debug("Registration created: ",e)}catch(a){throw s.log.error("Registration failed: ",a),a}}}},vNbC:function(e,t,n){n("du/1");var i=n("VSTI").Object;e.exports=function(e,t){return i.create(e,t)}},vOBO:function(e,t,n){var i,s,r,o=n("nAx8"),a=n("Temt"),l=n("kUGv"),c=n("BfU5"),u=n("7whZ"),d=u.process,h=u.setImmediate,p=u.clearImmediate,f=u.MessageChannel,g=u.Dispatch,m=0,v={},b=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},y=function(e){b.call(e.data)};h&&p||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++m]=function(){a("function"==typeof e?e:Function(e),t)},i(m),m},p=function(e){delete v[e]},"process"==n("TYje")(d)?i=function(e){d.nextTick(o(b,e,1))}:g&&g.now?i=function(e){g.now(o(b,e,1))}:f?(r=(s=new f).port2,s.port1.onmessage=y,i=o(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(o(b,e,1),0)}),e.exports={set:h,clear:p}},vSOj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("kfVJ");t.Retrier=i.Retrier;const s=n("j3KZ");t.Backoff=s.Backoff,t.default=i.Retrier},va3J:function(e,t,n){"use strict";var i=n("7whZ"),s=n("VSTI"),r=n("GhSp"),o=n("C61u"),a=n("zBWt")("species");e.exports=function(e){var t="function"==typeof s[e]?s[e]:i[e];o&&t&&!t[a]&&r.f(t,a,{configurable:!0,get:function(){return this}})}},vywL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketChannel=void 0;const i=n("+qE3"),s=n("MZ0W");t.WebSocketChannel=class extends i.EventEmitter{constructor(e){super(),this.url=e,this.WebSocket=global.WebSocket||global.MozWebSocket||n(5)}get isConnected(){return this.socket&&1===this.socket.readyState}connect(){s.log.trace("connecting to socket");let e=new this.WebSocket(this.url);e.binaryType="arraybuffer",e.onopen=()=>{s.log.debug(`socket opened ${this.url}`),this.emit("connected")},e.onclose=e=>{s.log.debug("socket closed",e),this.emit("disconnected",e)},e.onerror=e=>{s.log.debug("error:",e),this.emit("socketError",e)},e.onmessage=e=>{this.emit("message",e.data)},this.socket=e}send(e){this.socket.send(e)}close(){if(s.log.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}},w7D8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Telemetry=t.Close=t.Reply=t.Message=t.Update=t.InitReply=t.Init=void 0;const i=n("5DEo");Object.defineProperty(t,"Init",{enumerable:!0,get:function(){return i.Init}});const s=n("NRBv");Object.defineProperty(t,"InitReply",{enumerable:!0,get:function(){return s.InitReply}});const r=n("x3nw");Object.defineProperty(t,"Update",{enumerable:!0,get:function(){return r.Update}});const o=n("axwj");Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return o.Message}});const a=n("nwU8");Object.defineProperty(t,"Reply",{enumerable:!0,get:function(){return a.Reply}});const l=n("srAY");Object.defineProperty(t,"Close",{enumerable:!0,get:function(){return l.Close}});const c=n("KnDq");Object.defineProperty(t,"Telemetry",{enumerable:!0,get:function(){return c.Telemetry}})},wYM1:function(e,t,n){var i=n("USwo");i(i.S+i.F*!n("C61u"),"Object",{defineProperty:n("GhSp").f})},wlNh:function(e,t,n){var i=n("nAx8"),s=n("xMGN"),r=n("bS86"),o=n("d+lc"),a=n("0WpP"),l=n("I90/"),c={},u={};(t=e.exports=function(e,t,n,d,h){var p,f,g,m,v=h?function(){return e}:l(e),b=i(n,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(p=a(e.length);p>y;y++)if((m=t?b(o(f=e[y])[0],f[1]):b(e[y]))===c||m===u)return m}else for(g=v.call(e);!(f=g.next()).done;)if((m=s(g,b,f.value,t))===c||m===u)return m}).BREAK=c,t.RETURN=u},wqPz:function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},wv9B:function(e,t,n){"use strict";var i=m(n("4d7F")),s=m(n("gDS+")),r=m(n("14Xm")),o=m(n("D3Ub")),a=m(n("Yz+Y")),l=m(n("iCc5")),c=m(n("V7oC")),u=m(n("FYw3")),d=m(n("mRg0")),h=m(n("u8T8")),p=m(n("SEkw")),f=m(n("EJiy")),g=m(n("JO7F"));function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=(0,g.default)(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&(0,p.default)(t,n,o),o},b=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"==typeof h.default)return(0,h.default)(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;var y=n("+qE3"),_=n("iqZd"),C=n("yC9A"),w=n("WjQu"),k=n("C9Jq"),x=C.Logger.scope("Message"),O=function(e){function t(e,n,i,s){(0,l.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return r.channel=e,r.services=n,r.state={sid:s.sid,index:i,author:null==s.author?null:s.author,body:s.text,timestamp:s.timestamp?new Date(s.timestamp):null,dateUpdated:s.dateUpdated?new Date(s.dateUpdated):null,lastUpdatedBy:s.lastUpdatedBy?s.lastUpdatedBy:null,attributes:_.parseAttributes(s.attributes,"Got malformed attributes for the message "+s.sid,x),type:s.type?s.type:"text",media:s.type&&"media"===s.type&&s.media?new w.Media(s.media,r.services):null,memberSid:null==s.memberSid?null:s.memberSid},r}var n,i,h,p;return(0,d.default)(t,e),(0,c.default)(t,[{key:"_update",value:function(e){var t=[];!e.text&&"string"!=typeof e.text||e.text===this.state.body||(this.state.body=e.text,t.push("body")),e.lastUpdatedBy&&e.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=e.lastUpdatedBy,t.push("lastUpdatedBy")),e.author&&e.author!==this.state.author&&(this.state.author=e.author,t.push("author")),e.dateUpdated&&new Date(e.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(e.dateUpdated),t.push("dateUpdated")),e.timestamp&&new Date(e.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(e.timestamp),t.push("dateCreated"));var n=_.parseAttributes(e.attributes,"Got malformed attributes for the message "+this.sid,x);_.isDeepEqual(this.state.attributes,n)||(this.state.attributes=n,t.push("attributes")),t.length>0&&this.emit("updated",{message:this,updateReasons:t})}},{key:"getMember",value:(p=(0,o.default)(r.default.mark((function e(){var t,n,i=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!this.state.memberSid){e.next=5;break}return e.next=4,this.channel.getMemberBySid(this.memberSid).catch((function(){return x.debug('Member with sid "'+i.memberSid+'" not found for message '+i.sid),null}));case 4:t=e.sent;case 5:if(t||!this.state.author){e.next=9;break}return e.next=8,this.channel.getMemberByIdentity(this.state.author).catch((function(){return x.debug('Member with identity "'+i.author+'" not found for message '+i.sid),null}));case 8:t=e.sent;case 9:if(!t){e.next=11;break}return e.abrupt("return",t);case 11:throw n="Member with ",this.state.memberSid&&(n+="SID '"+this.state.memberSid+"' "),this.state.author&&(this.state.memberSid&&(n+="or "),n+="identity '"+this.state.author+"' "),"Member with "===n&&(n="Member "),n+="was not found",new Error(n);case 17:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"remove",value:(h=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("deleteMessage",{channelSid:this.channel.sid,messageIdx:this.index.toString()});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"updateBody",value:(i=(0,o.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("editMessage",{channelSid:this.channel.sid,messageIdx:this.index.toString(),text:t});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateAttributes",value:(n=(0,o.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("editMessageAttributes",{channelSid:this.channel.sid,messageIdx:this.index,attributes:(0,s.default)(t)});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"body",get:function(){return"media"===this.type?null:this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"memberSid",get:function(){return this.state.memberSid}}]),t}(y.EventEmitter);v([k.asyncTypeCheck("string"),b("design:type",Function),b("design:paramtypes",[String]),b("design:returntype",i.default)],O.prototype,"updateBody",null),v([k.asyncTypeCheck(["string","number","boolean","object",k.literal(null)]),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",i.default)],O.prototype,"updateAttributes",null),t.Message=O},x3nw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Update=void 0;const i=n("NDb0");t.Update=class extends i.AbstractMessage{constructor(e){super(),this.method="update",this.token=e}}},xDTo:function(e,t,n){var i;i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,i,s;for(n=1;n<arguments.length;n++)for(s in i=arguments[n])i.hasOwnProperty(s)&&(e[s]=i[s]);return e}},function(e,t,n){"use strict";var i=n(0);e.exports={build:function(e,t){var n,s,r,o=t.plugins;for(n=0,s=o.length;n<s;n++)(r=o[n]).methods&&i(e,r.methods),r.properties&&Object.defineProperties(e,r.properties)},hook:function(e,t,n){var i,s,r,o=e.config.plugins,a=[e.context];for(n&&(a=a.concat(n)),i=0,s=o.length;i<s;i++)(r=o[i][t])&&r.apply(o[i],a)}}},function(e,t,n){"use strict";function i(e){if(0===e.length)return e;var t,n,i=e.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return e;for(n=i[0].toLowerCase(),t=1;t<i.length;t++)n=n+i[t].charAt(0).toUpperCase()+i[t].substring(1).toLowerCase();return n}i.prepended=function(e,t){return e+(t=i(t))[0].toUpperCase()+t.substring(1)},e.exports=i},function(e,t,n){"use strict";var i=n(0),s=n(2);function r(e,t){this.options=e=e||{},this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}i(r.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=s.prepended("onEnter",e),this.lifecycle.onLeave[e]=s.prepended("onLeave",e),this.lifecycle.on[e]=s.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=s.prepended("onBefore",e),this.lifecycle.onAfter[e]=s.prepended("onAfter",e),this.lifecycle.on[e]=s.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,i=e.to;return this.addState(n),"function"!=typeof i&&this.addState(i),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(i({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(i({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,i,s;for(n=0,i=(e=e||[]).length;n<i;n++)"function"==typeof(s=e[n])&&(e[n]=s=s()),s.configure&&s.configure(this);return e},configureTransitions:function(e){var t,n,i,s,r,o=this.defaults.wildcard;for(n=0;n<e.length;n++)for(i=e[n],s=Array.isArray(i.from)?i.from:[i.from||o],r=i.to||o,t=0;t<s.length;t++)this.mapTransition({name:i.name,from:s[t],to:r})},transitionFor:function(e,t){return this.map[e][t]||this.map[this.defaults.wildcard][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=r},function(e,t,n){var i=n(0),s=n(6),r=n(1),o=[null,[]];function a(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}i(a.prototype,{init:function(e){if(i(this.context,this.config.data.apply(this.context,e)),r.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,e),s=i&&i.to;return"function"==typeof s?s.apply(this.context,t):s===n?this.state:s},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,i){var s=this.config.lifecycle,r=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),i.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(s.onBefore.transition),this.observersForEvent(s.onBefore[e]),r?this.observersForEvent(s.onLeave.state):o,r?this.observersForEvent(s.onLeave[t]):o,this.observersForEvent(s.on.transition),r?["doTransit",[this]]:o,r?this.observersForEvent(s.onEnter.state):o,r?this.observersForEvent(s.onEnter[n]):o,r?this.observersForEvent(s.on[n]):o,this.observersForEvent(s.onAfter.transition),this.observersForEvent(s.onAfter[e]),this.observersForEvent(s.on[e])],i)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,i=this.observers.length,s=[];n<i;n++)(t=this.observers[n])[e]&&s.push(t);return[e,s,!0]},observeEvents:function(e,t,n,i){if(0===e.length)return this.endTransit(void 0===i||i);var s=e[0][0],o=e[0][1],a=e[0][2];if(t[0].event=s,s&&a&&s!==n&&r.hook(this,"lifecycle",t),0===o.length)return e.shift(),this.observeEvents(e,t,s,i);var l=o.shift(),c=l[s].apply(l,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,s)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,s,c)},onInvalidTransition:function(e,t,n){throw new s("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new s("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=a},function(e,t,n){"use strict";var i=n(0),s=n(2),r=n(1),o=n(3),a=n(4),l={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function u(e){return d(this||{},e)}function d(e,t){return h(e,new o(t,u)),e._fsm(),e}function h(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");r.build(e,t),Object.defineProperties(e,c),i(e,l),i(e,t.methods),t.allTransitions().forEach((function(t){e[s(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new a(this,t),this._fsm.init(arguments)}}u.version="3.0.1",u.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new o(t,u);return h(e.prototype,n),e.prototype._fsm.config=n,e},u.apply=d,u.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=u},function(e,t,n){"use strict";e.exports=function(e,t,n,i,s){this.message=e,this.transition=t,this.from=n,this.to=i,this.current=s}}])},e.exports=i()},xDdU:function(e,t,n){var i,s,r=n("4fRq"),o=n("I2ZF"),a=0,l=0;e.exports=function(e,t,n){var c=t&&n||0,u=t||[],d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==h){var p=r();null==d&&(d=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==h&&(h=s=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:l+1,m=f-a+(g-l)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||f>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,l=g,s=h;var v=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;u[c++]=v>>>24&255,u[c++]=v>>>16&255,u[c++]=v>>>8&255,u[c++]=255&v;var b=f/4294967296*1e4&268435455;u[c++]=b>>>8&255,u[c++]=255&b,u[c++]=b>>>24&15|16,u[c++]=b>>>16&255,u[c++]=h>>>8|128,u[c++]=255&h;for(var y=0;y<6;++y)u[c+y]=d[y];return t||o(u)}},xKiQ:function(e,t,n){var i=n("RpkJ"),s=n("d+lc"),r=n("FgkJ"),o=i.key,a=i.set;i.exp({metadata:function(e,t){return function(n,i){a(e,t,(void 0!==i?s:r)(n),o(i))}}})},xMGN:function(e,t,n){var i=n("d+lc");e.exports=function(e,t,n,s){try{return s?t(i(n)[0],n[1]):t(n)}catch(o){var r=e.return;throw void 0!==r&&i(r.call(e)),o}}},xXl2:function(e,t,n){"use strict";var i,s,r,o,a=n("5ETA"),l=n("7whZ"),c=n("nAx8"),u=n("aqg2"),d=n("USwo"),h=n("ekG2"),p=n("FgkJ"),f=n("ukM9"),g=n("wlNh"),m=n("2zfi"),v=n("vOBO").set,b=n("jssz")(),y=n("8sL3"),_=n("wqPz"),C=n("jlxs"),w=n("JKKi"),k=l.TypeError,x=l.process,O=x&&x.versions,S=O&&O.v8||"",M=l.Promise,P="process"==u(x),T=function(){},E=s=y.f,I=!!function(){try{var e=M.resolve(1),t=(e.constructor={})[n("zBWt")("species")]=function(e){e(T,T)};return(P||"function"==typeof PromiseRejectionEvent)&&e.then(T)instanceof t&&0!==S.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(i){}}(),R=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},j=function(e,t){if(!e._n){e._n=!0;var n=e._c;b((function(){for(var i=e._v,s=1==e._s,r=0,o=function(t){var n,r,o,a=s?t.ok:t.fail,l=t.resolve,c=t.reject,u=t.domain;try{a?(s||(2==e._h&&A(e),e._h=1),!0===a?n=i:(u&&u.enter(),n=a(i),u&&(u.exit(),o=!0)),n===t.promise?c(k("Promise-chain cycle")):(r=R(n))?r.call(n,l,c):l(n)):c(i)}catch(d){u&&!o&&u.exit(),c(d)}};n.length>r;)o(n[r++]);e._c=[],e._n=!1,t&&!e._h&&N(e)}))}},N=function(e){v.call(l,(function(){var t,n,i,s=e._v,r=U(e);if(r&&(t=_((function(){P?x.emit("unhandledRejection",s,e):(n=l.onunhandledrejection)?n({promise:e,reason:s}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",s)})),e._h=P||U(e)?2:1),e._a=void 0,r&&t.e)throw t.v}))},U=function(e){return 1!==e._h&&0===(e._a||e._c).length},A=function(e){v.call(l,(function(){var t;P?x.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),j(t,!0))},L=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw k("Promise can't be resolved itself");(t=R(e))?b((function(){var i={_w:n,_d:!1};try{t.call(e,c(L,i,1),c(D,i,1))}catch(s){D.call(i,s)}})):(n._v=e,n._s=1,j(n,!1))}catch(i){D.call({_w:n,_d:!1},i)}}};I||(M=function(e){f(this,M,"Promise","_h"),p(e),i.call(this);try{e(c(L,this,1),c(D,this,1))}catch(t){D.call(this,t)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n("iZ5/")(M.prototype,{then:function(e,t){var n=E(m(this,M));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=P?x.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&j(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),r=function(){var e=new i;this.promise=e,this.resolve=c(L,e,1),this.reject=c(D,e,1)},y.f=E=function(e){return e===M||e===o?new r(e):s(e)}),d(d.G+d.W+d.F*!I,{Promise:M}),n("kvAF")(M,"Promise"),n("va3J")("Promise"),o=n("VSTI").Promise,d(d.S+d.F*!I,"Promise",{reject:function(e){var t=E(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!I),"Promise",{resolve:function(e){return w(a&&this===o?M:this,e)}}),d(d.S+d.F*!(I&&n("h3Hq")((function(e){M.all(e).catch(T)}))),"Promise",{all:function(e){var t=this,n=E(t),i=n.resolve,s=n.reject,r=_((function(){var n=[],r=0,o=1;g(e,!1,(function(e){var a=r++,l=!1;n.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,n[a]=e,--o||i(n))}),s)})),--o||i(n)}));return r.e&&s(r.v),n.promise},race:function(e){var t=this,n=E(t),i=n.reject,s=_((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,i)}))}));return s.e&&i(s.v),n.promise}})},xfML:function(e,t,n){var i=n("USwo");i(i.S,"Object",{setPrototypeOf:n("DrT7").set})},xk4V:function(e,t,n){var i=n("4fRq"),s=n("I2ZF");e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}},"y/1M":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventSendingLimitation=t.TelemetryPoint=t.TelemetryEventDescription=t.TelemetryTracker=void 0;const i=n("grBd"),s=n("MZ0W");class r{constructor(e,t,n,i,s,r){this.title=e,this.details=t,this.start=n,this.type=s,this.id=r,this.end=i}toTelemetryEvent(){const e=new Date;let t=this.start,n=this.end?this.end:e;if(n<t){let e=n;n=t,t=e}const s=t.getTime()-e.getTime(),r=n.getTime()-e.getTime();return new i.TelemetryEvent(s,r,this.title,this.details,this.id,this.type)}}var o,a;t.TelemetryEventDescription=r,function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(o||(o={})),t.TelemetryPoint=o,function(e){e[e.MinEventsPortion=0]="MinEventsPortion",e[e.AnyEvents=1]="AnyEvents",e[e.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(a||(a={})),t.EventSendingLimitation=a,t.TelemetryTracker=class{constructor(e,t){this.minEventsPortionToSend=50,this.maxEventsPortionToSend=100,this.pendingEvents=new Map,this.readyEvents=[],this.hasInitializationFinished=!1,this._canSendTelemetry=!1,this.config=e,this.packetInterface=t}get isTelemetryEnabled(){return this.config.confirmedCapabilities.has("telemetry.v1")}get canSendTelemetry(){return this._canSendTelemetry&&this.isTelemetryEnabled}set canSendTelemetry(e){s.log.debug(`TelemetryTracker.canSendTelemetry: ${e} TelemetryTracker.isTelemetryEnabled: ${this.isTelemetryEnabled}`),this._canSendTelemetry&&!e&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=e,e&&this.sendTelemetry(a.AnyEvents),e&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}addTelemetryEvent(e){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(e)}addPartialEvent(e,t,n){s.log.debug(`Adding ${n===o.Start?"starting":"ending"} timepoint for '${t}' event`);let i=this.pendingEvents.has(t);if(n===o.Start)i&&s.log.debug(`Overwriting starting point for '${t}' event`),this.pendingEvents.set(t,e);else{if(!i)return void s.log.error(`Could not find started event for '${t}' event`);this.addTelemetryEvent(this.merge(this.pendingEvents.get(t),e)),this.pendingEvents.delete(t)}}getTelemetryToSend(e){return this.canSendTelemetry&&0!=this.readyEvents.length?e==a.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(e==a.AnyEventsIncludingUnfinished):[]}getTelemetryPortion(e){const t=Math.min(this.readyEvents.length,this.maxEventsPortionToSend);let n=this.readyEvents.splice(0,t);return e&&n.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach((e,t)=>{if(n.length>=this.maxEventsPortionToSend)return;let i=this.pendingEvents.get(t);this.pendingEvents.delete(t),n.push(new r(`[UNFINISHED] ${i.title}`,i.details,i.start,null,i.type,i.id))}),n}merge(e,t){return new r(t.title?t.title:e.title,t.details?t.details:e.details,e.start,t.end,t.type?t.type:e.type,t.id?t.id:e.id)}sendTelemetryIfMinimalPortionCollected(){this.sendTelemetry(a.MinEventsPortion)}sendTelemetry(e){const t=this.getTelemetryToSend(e);if(0!==t.length)try{this.packetInterface.send(new i.Telemetry(t.map(e=>e.toTelemetryEvent())))}catch(n){s.log.debug(`Error while sending ${t.length} telemetry events due to ${n}; they will be resubmitted`),this.readyEvents=this.readyEvents.concat(t)}}}},yC9A:function(e,t,n){"use strict";var i=o(n("iCc5")),s=o(n("V7oC")),r=o(n("rfXi"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return[(new Date).toISOString()+" Chat "+e+":"].concat((0,r.default)(t))}Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var l=n("XH0y").getLogger("twilio-chat"),c=function(){function e(t){(0,i.default)(this,e),this.prefix="",this.prefix=null!=t&&t.length>0?t+" ":""}return(0,s.default)(e,[{key:"setLevel",value:function(e){l.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.trace.apply(null,a(this.prefix+"T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.debug.apply(null,a(this.prefix+"D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.info.apply(null,a(this.prefix+"I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.warn.apply(null,a(this.prefix+"W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.error.apply(null,a(this.prefix+"E",t))}}],[{key:"scope",value:function(t){return new e(t)}},{key:"setLevel",value:function(e){l.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.trace.apply(null,a("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.debug.apply(null,a("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.info.apply(null,a("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.warn.apply(null,a("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.error.apply(null,a("E",t))}}]),e}();t.Logger=c},yQFZ:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},ygN2:function(e,t,n){"use strict";var i=f(n("4d7F")),s=f(n("14Xm")),r=f(n("gDS+")),o=f(n("D3Ub")),a=f(n("jWXv")),l=f(n("ODRq")),c=f(n("Yz+Y")),u=f(n("iCc5")),d=f(n("V7oC")),h=f(n("FYw3")),p=f(n("mRg0"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Channels=t.Channel=void 0;var g=n("+qE3"),m=n("yC9A"),v=n("37Ge");Object.defineProperty(t,"Channel",{enumerable:!0,get:function(){return v.Channel}});var b=n("qc9/"),y=n("iqZd"),_=m.Logger.scope("Channels"),C=function(e){function t(e){(0,u.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return n.services=e,n.channels=new l.default,n.thumbstones=new a.default,n.syncListFetched=!1,n.syncListRead=new b.Deferred,n}var n;return(0,p.default)(t,e),(0,d.default)(t,[{key:"getMap",value:function(){var e=this;return this.services.session.getMyChannelsId().then((function(t){return e.services.syncClient.map({id:t,mode:"open_existing"})}))}},{key:"addChannel",value:(n=(0,o.default)(s.default.mark((function e(t){var n,i,o,a,l,c;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===t.attributes?{}:t.attributes,e.next=4,this.services.session.addCommand("createChannel",{friendlyName:t.friendlyName,uniqueName:t.uniqueName,type:t.isPrivate?"private":"public",attributes:(0,r.default)(n)});case 4:if(a="channel"in(i=e.sent)?i.channel:null,!(l=this.channels.get(o="channelSid"in i?i.channelSid:null))){e.next=12;break}return e.next=11,l._subscribe();case 11:return e.abrupt("return",l);case 12:return c=new v.Channel(this.services,{channel:a,entityName:null,uniqueName:null,attributes:null,createdBy:null,friendlyName:null,lastConsumedMessageIndex:null,type:t.isPrivate?"private":"public",dateCreated:null,dateUpdated:null},o),this.channels.set(c.sid,c),this.registerForEvents(c),e.next=17,c._subscribe();case 17:return this.emit("channelAdded",c),e.abrupt("return",c);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchChannels",value:function(){var e,t=this;this.getMap().then((e=(0,o.default)(s.default.mark((function e(n){var r,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.on("itemAdded",(function(e){_.debug("itemAdded: "+e.item.key),t.upsertChannel("sync",e.item.key,e.item.value)})),n.on("itemRemoved",(function(e){_.debug("itemRemoved: "+e.key);var n=e.key;t.syncListFetched||t.thumbstones.add(n);var i=t.channels.get(n);i&&("joined"!==i.status&&"invited"!==i.status||(i._setStatus("notParticipating","sync"),t.emit("channelLeft",i)),i.isPrivate&&(t.channels.delete(n),t.emit("channelRemoved",i),i.emit("removed",i)))})),n.on("itemUpdated",(function(e){_.debug("itemUpdated: "+e.item.key),t.upsertChannel("sync",e.item.key,e.item.value)})),r=[],e.next=6,t.services.syncList.getPage();case 6:(o=e.sent).items.forEach((function(e){r.push(t.upsertChannel("synclist",e.channel_sid,e))}));case 9:if(!o.hasNextPage){e.next=16;break}return e.next=12,o.nextPage();case 12:(o=e.sent).items.forEach((function(e){r.push(t.upsertChannel("synclist",e.channel_sid,e))})),e.next=9;break;case 16:return t.syncListRead.set(!0),e.abrupt("return",i.default.all(r));case 18:case"end":return e.stop()}}),e,t)}))),function(t){return e.apply(this,arguments)})).then((function(){t.syncListFetched=!0,t.thumbstones.clear(),_.debug("Channels list fetched")})).then((function(){return t})).catch((function(e){throw"disconnected"!=t.services.syncClient.connectionState&&_.error("Failed to get channels list",e),_.debug("ERROR: Failed to get channels list",e),e}))}},{key:"_wrapPaginator",value:function(e,t){var n=this;return t(e.items).then((function(i){return{items:i,hasNextPage:e.hasNextPage,hasPrevPage:e.hasPrevPage,nextPage:function(){return e.nextPage().then((function(e){return n._wrapPaginator(e,t)}))},prevPage:function(){return e.prevPage().then((function(e){return n._wrapPaginator(e,t)}))}}}))}},{key:"getChannels",value:function(e){var t=this;return this.getMap().then((function(t){return t.getItems(e)})).then((function(e){return t._wrapPaginator(e,(function(e){return i.default.all(e.map((function(e){return t.upsertChannel("sync",e.key,e.value)})))}))}))}},{key:"getChannel",value:function(e){var t=this;return this.getMap().then((function(t){return t.getItems({key:e})})).then((function(e){return e.items.map((function(e){return t.upsertChannel("sync",e.key,e.value)}))})).then((function(e){return e.length>0?e[0]:null}))}},{key:"pushChannel",value:function(e){var t=e.sid;return this.upsertChannel("chat",t,{entityName:null,lastConsumedMessageIndex:e.lastConsumedMessageIndex,type:e.type,status:e.status,friendlyName:e.friendlyName,dateUpdated:e.dateUpdated,dateCreated:e.dateCreated,uniqueName:e.uniqueName,createdBy:e.createdBy,attributes:e.attributes,channel:e.channel,notificationLevel:e.notificationLevel,sid:t})}},{key:"upsertChannel",value:function(e,t,n){var i=this;_.trace("upsertChannel(sid="+t+", data=",n);var s=this.channels.get(t);if(s){if(_.trace("upsertChannel: channel "+t+" is known and it's status is known from source "+s._statusSource()+" and update came from source "+e,s),void 0===s._statusSource()||e===s._statusSource()||"synclist"===e&&"sync"!==s._statusSource()||"sync"===e)if("joined"===n.status&&"joined"!==s.status){s._setStatus("joined",e);var r={};void 0!==n.notificationLevel&&(r.notificationLevel=n.notificationLevel),void 0!==n.lastConsumedMessageIndex&&(r.lastConsumedMessageIndex=n.lastConsumedMessageIndex),y.isDeepEqual(r,{})||s._update(r),s._subscribe().then((function(){i.emit("channelJoined",s)}))}else if("invited"===n.status&&"invited"!==s.status){s._setStatus("invited",e);var o={};void 0!==n.notificationLevel&&(o.notificationLevel=n.notificationLevel),void 0!==n.lastConsumedMessageIndex&&(o.lastConsumedMessageIndex=n.lastConsumedMessageIndex),y.isDeepEqual(o,{})||s._update(o),s._subscribe().then((function(){i.emit("channelInvited",s)}))}else"notParticipating"!==n.status||"invited"!==s.status&&"joined"!==s.status?"notParticipating"===n.status&&"private"===n.type?s._subscribe():s._update(n):(s._setStatus("notParticipating",e),s._update(n),s._subscribe().then((function(){i.emit("channelLeft",s)})));else _.trace("upsertChannel: channel is known from sync and came from chat, ignoring",{sid:t,data:n.status,channel:s.status});return s._subscribe().then((function(){return s}))}if("chat"!==e&&"synclist"!==e||!this.thumbstones.has(t))return _.trace("upsertChannel: creating local channel object with sid "+t,n),s=new v.Channel(this.services,n,t),this.channels.set(t,s),s._subscribe().then((function(){return i.registerForEvents(s),i.emit("channelAdded",s),"joined"===n.status?(s._setStatus("joined",e),i.emit("channelJoined",s)):"invited"===n.status&&(s._setStatus("invited",e),i.emit("channelInvited",s)),s}));_.trace("upsertChannel: channel is deleted and came again from chat, ignoring",t)}},{key:"onChannelRemoved",value:function(e){var t=this.channels.get(e);t&&(this.channels.delete(e),this.emit("channelRemoved",t))}},{key:"registerForEvents",value:function(e){var t=this;e.on("removed",(function(){return t.onChannelRemoved(e.sid)})),e.on("updated",(function(e){return t.emit("channelUpdated",e)})),e.on("memberJoined",this.emit.bind(this,"memberJoined")),e.on("memberLeft",this.emit.bind(this,"memberLeft")),e.on("memberUpdated",(function(e){return t.emit("memberUpdated",e)})),e.on("messageAdded",this.emit.bind(this,"messageAdded")),e.on("messageUpdated",(function(e){return t.emit("messageUpdated",e)})),e.on("messageRemoved",this.emit.bind(this,"messageRemoved")),e.on("typingStarted",this.emit.bind(this,"typingStarted")),e.on("typingEnded",this.emit.bind(this,"typingEnded"))}}]),t}(g.EventEmitter);t.Channels=C},zBWt:function(e,t,n){var i=n("s2er")("wks"),s=n("ixoo"),r=n("7whZ").Symbol,o="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=o&&r[e]||(o?r:s)("Symbol."+e))}).store=i},znrX:function(e,t,n){var i=n("nA4W"),s=n("CYMq"),r=n("WpRT")("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=s(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},zs2D:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncClient=t.Client=void 0;const i=n("+qE3"),s=n("kUwj"),r=n("/LtL"),o=n("v2fs"),a=n("PyJ+"),l=n("IMmU"),c=n("PalJ"),u=n("6r7x"),d=n("r+Qc"),h=n("QQLf"),p=n("+RHZ"),f=n("oUms"),g=n("H86R"),m=n("KgOX"),v=n("SzqN"),b=n("PWsN"),y=n("L+wn"),_=n("kyWA"),C=n("ASGO"),w=n("ASGO"),k=n("hRWM").version;function x(e){if(e){if("string"==typeof e)return{id:e,mode:"open_or_create"};{l.validateOptionalTtl(e.ttl),l.validateId(e.id);let t=e.mode||(e.id?"open_or_create":"create_new");return Object.assign(Object.assign({},e),{mode:t})}}return{mode:"create_new"}}class O extends i.EventEmitter{constructor(e,t={}){if(super(),!e)throw new Error("Sync library needs a valid Twilio token to be passed");t.hasOwnProperty("logLevel")?c.default.setLevel(t.logLevel):c.default.setLevel("silent");const n=t.productId=t.productId||"data_sync";t.clientMetadata=t.clientMetadata||{},t.clientMetadata.hasOwnProperty("type")||(t.clientMetadata.type="sync"),t.clientMetadata.hasOwnProperty("sdk")||(t.clientMetadata.sdk="JS",t.clientMetadata.sdkv=k);let i=t.twilsockClient=t.twilsockClient||new s.Twilsock(e,n,t);i.on("tokenAboutToExpire",e=>this.emit("tokenAboutToExpire",e)),i.on("tokenExpired",()=>this.emit("tokenExpired")),i.on("connectionError",e=>this.emit("connectionError",e));let o=t.notificationsClient=t.notificationsClient||new r.Notifications(e,t),a=new u.Configuration(t),l=new p.NetworkService(new v.ClientInfo(k),a,i),f=new y.SessionStorage(a);this.localStorageId=null,i.connect(),this.services={config:a,twilsock:i,notifications:o,network:l,storage:f,router:null,subscriptions:null};let g=new d.Subscriptions(this.services),m=new h.Router({config:a,subscriptions:g,notifications:o});this.services.router=m,this.services.subscriptions=g,this.entities=new b.EntitiesCache,o.on("connectionStateChanged",()=>{this.emit("connectionStateChanged",this.services.notifications.connectionState)})}static get version(){return k}get connectionState(){return this.services.notifications.connectionState}async ensureReady(){if(this.services.config.sessionStorageEnabled)try{let e=await this.services.twilsock.storageId();this.services.storage.updateStorageId(e.id)}catch(e){c.default.warn("Failed to initialize storage",e)}}storeRootInSessionCache(e,t,n){if(!this.services.config.sessionStorageEnabled||!t)return;let i=l.deepClone(n);e!==g.SyncList.type&&e!==m.SyncMap.type||(i.last_event_id=null,delete i.items),this.services.storage.store(e,t,i)}readRootFromSessionCache(e,t){return this.services.config.sessionStorageEnabled&&t?this.services.storage.read(e,t):null}async _get(e,t,n=!1){if(!t)throw new a.SyncError("Cannot get entity without id",404);const i=new o.UriBuilder(e).pathSegment(t).queryParam("Include",n?"items":void 0).build();return(await this.services.network.get(i)).body}_createDocument(e,t,n){const i={unique_name:e,data:t||{}};return void 0!==n&&(i.ttl=n),this.services.network.post(this.services.config.documentsUri,i).then(e=>(e.body.data=i.data,e.body))}async _getDocument(e){return this.readRootFromSessionCache(f.SyncDocument.type,e)||this._get(this.services.config.documentsUri,e)}_createList(e,t,n,i){const s={unique_name:e,purpose:t,context:n};return void 0!==i&&(s.ttl=i),this.services.network.post(this.services.config.listsUri,s).then(e=>e.body)}async _getList(e){return this.readRootFromSessionCache(g.SyncList.type,e)||this._get(this.services.config.listsUri,e)}_createMap(e,t){const n={unique_name:e};return void 0!==t&&(n.ttl=t),this.services.network.post(this.services.config.mapsUri,n).then(e=>e.body)}async _getMap(e,t=!1){return this.readRootFromSessionCache(m.SyncMap.type,e)||this._get(this.services.config.mapsUri,e,t)}async _getStream(e){return this.readRootFromSessionCache(_.SyncStream.type,e)||this._get(this.services.config.streamsUri,e,!1)}async _createStream(e,t){const n={unique_name:e};return void 0!==t&&(n.ttl=t),(await this.services.network.post(this.services.config.streamsUri,n)).body}_getLiveQuery(e){return this.readRootFromSessionCache(C.LiveQuery.type,e)}getCached(e,t){return e&&this.entities.get(e,t)||null}removeFromCacheAndSession(e,t,n){this.entities.remove(t),this.services.config.sessionStorageEnabled&&this.services.storage.remove(e,t,n)}async document(e){await this.ensureReady();let t,n=x(e);if("create_new"===n.mode)t=await this._createDocument(n.id,n.value,n.ttl);else{let i=this.getCached(n.id,f.SyncDocument.type);if(i)return new f.SyncDocument(i);try{t=await this._getDocument(n.id)}catch(s){if(404!==s.status||"open_existing"===n.mode)throw s;try{t=await this._createDocument(n.id,n.value,n.ttl)}catch(s){if(409===s.status)return this.document(e);throw s}}}this.storeRootInSessionCache(f.SyncDocument.type,n.id,t);let i=new f.SyncDocumentImpl(this.services,t,(e,t,n)=>this.removeFromCacheAndSession(e,t,n));return i=this.entities.store(i),new f.SyncDocument(i)}async map(e){await this.ensureReady();let t,n=x(e);if("create_new"===n.mode)t=await this._createMap(n.id,n.ttl);else{let i=this.getCached(n.id,m.SyncMap.type);if(i)return new m.SyncMap(i);try{t=await this._getMap(n.id,n.includeItems)}catch(s){if(404!==s.status||"open_existing"===n.mode)throw s;try{t=await this._createMap(n.id,n.ttl)}catch(s){if(409===s.status)return this.map(e);throw s}}}this.storeRootInSessionCache(m.SyncMap.type,n.id,t);let i=new m.SyncMapImpl(this.services,t,(e,t,n)=>this.removeFromCacheAndSession(e,t,n));return i=this.entities.store(i),new m.SyncMap(i)}async list(e){await this.ensureReady();let t,n=x(e);if("create_new"===n.mode)t=await this._createList(n.id,n.purpose,n.context,n.ttl);else{let i=this.getCached(n.id,g.SyncList.type);if(i)return new g.SyncList(i);try{t=await this._getList(n.id)}catch(s){if(404!==s.status||"open_existing"===n.mode)throw s;try{t=await this._createList(n.id,n.purpose,n.context,n.ttl)}catch(s){if(409===s.status)return this.list(e);throw s}}}this.storeRootInSessionCache(g.SyncList.type,n.id,t);let i=new g.SyncListImpl(this.services,t,(e,t,n)=>this.removeFromCacheAndSession(e,t,n));return i=this.entities.store(i),new g.SyncList(i)}async stream(e){await this.ensureReady();let t,n=x(e);if("create_new"===n.mode)t=await this._createStream(n.id,n.ttl);else{let i=this.getCached(n.id,_.SyncStream.type);if(i)return new _.SyncStream(i);try{t=await this._getStream(n.id)}catch(s){if(404!==s.status||"open_existing"===n.mode)throw s;try{t=await this._createStream(n.id,n.ttl)}catch(s){if(409===s.status)return this.stream(e);throw s}}}this.storeRootInSessionCache(_.SyncStream.type,n.id,t);let i=new _.SyncStreamImpl(this.services,t,(e,t,n)=>this.removeFromCacheAndSession(e,t,n));return i=this.entities.store(i),new _.SyncStream(i)}async shutdown(){await this.services.subscriptions.shutdown(),await this.services.twilsock.disconnect()}async updateToken(e){return e?this.services.twilsock.updateToken(e):Promise.reject(new Error("A valid Twilio token should be provided"))}async liveQuery(e,t){if(await this.ensureReady(),!e||"string"!=typeof e)throw new Error("Index name must contain a non-empty string value");let n=new o.UriBuilder(this.services.config.insightsUri).pathSegment(e).pathSegment("Items").build(),i=await w.queryItems({network:this.services.network,uri:n,queryString:t,type:C.LiveQuery.type}),s=this.getCached(i.query_id,C.LiveQuery.type);if(!s){let r=this._getLiveQuery(i.query_id);r||(r={indexName:e,queryExpression:t,sid:i.query_id,queryUri:n,last_event_id:i.last_event_id}),s=new C.LiveQueryImpl(r,this.services,(e,t,n)=>this.removeFromCacheAndSession(e,t,n),i.items)}return this.storeRootInSessionCache(C.LiveQuery.type,i.query_id,s.liveQueryDescriptor),s=this.entities.store(s),new C.LiveQuery(s)}async instantQuery(e){return await this.ensureReady(),new C.InstantQuery({indexName:e,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:(e,t)=>this.liveQuery(e,t)})}}t.Client=O,t.SyncClient=O,t.default=O}}]);
//# sourceMappingURL=8-es2015.a13301a3f45c1350ef77.js.map